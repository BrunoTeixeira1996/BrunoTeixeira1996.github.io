<!DOCTYPE html>
<html lang="en"
  x-data
  :class="$store.darkMode.class()"
  :data-theme="$store.darkMode.theme()">
  <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>0xOPOSEC 24/02/2022 Challenge | Bruno Blog</title>

    
  
    <link href="/favicon.ico" rel="icon" type="image/x-icon" />
  


<link rel="canonical" href="http://localhost:1313/posts/2022-02-24-0xoposec/" />



<meta name="author" content="" />
<meta name="description" content="Description &ldquo;I just got this new keyboard from Vodaphone Portugal, but it looks like something fishy is going on. Could you help me?&rdquo;
Solving Opening the pcap file It turns out to be a USB communication capture The file was small and had USB_INTERRUPT events that encode key presses
After a little bit of google fu, I found that the Leftover Capture Data field has a series of 8 bytes strung together (the third byte is the Usage ID for the key pressed)
" />


<meta name="keywords" content="CTF">



<meta name="generator" content="Hugo 0.147.0">


<meta property="og:url" content="http://localhost:1313/posts/2022-02-24-0xoposec/">
  <meta property="og:site_name" content="Bruno Blog">
  <meta property="og:title" content="0xOPOSEC 24/02/2022 Challenge">
  <meta property="og:description" content="Description “I just got this new keyboard from Vodaphone Portugal, but it looks like something fishy is going on. Could you help me?”
Solving Opening the pcap file It turns out to be a USB communication capture The file was small and had USB_INTERRUPT events that encode key presses
After a little bit of google fu, I found that the Leftover Capture Data field has a series of 8 bytes strung together (the third byte is the Usage ID for the key pressed)">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2022-02-24T00:00:00+00:00">
    <meta property="article:modified_time" content="2022-02-24T00:00:00+00:00">
    <meta property="article:tag" content="CTF">




  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="0xOPOSEC 24/02/2022 Challenge">
  <meta name="twitter:description" content="Description “I just got this new keyboard from Vodaphone Portugal, but it looks like something fishy is going on. Could you help me?”
Solving Opening the pcap file It turns out to be a USB communication capture The file was small and had USB_INTERRUPT events that encode key presses
After a little bit of google fu, I found that the Leftover Capture Data field has a series of 8 bytes strung together (the third byte is the Usage ID for the key pressed)">




<link rel="stylesheet" href="/css/output.css" />




    


<style>
  pre {
    padding: 1em;
    overflow: auto;
  }
</style>









    

    <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3/dist/cdn.min.js" integrity="sha256-PtHu0lJIiSHfZeNj1nFd6wTX+Squ255SGZ/fc8seCtM=" crossorigin="anonymous"></script>
  </head>

  <body x-data="{
    flip: false,
  }">
    
    <div id="dream-global-bg"></div>

    
<nav x-data="{ isSticky: false }"
  x-init="window.addEventListener('scroll', () => { isSticky = window.scrollY > 30 })"
  class="sticky top-0 z-30 mt-4 lg:mt-8 py-4"
  :class="{ 'bg-base-100 shadow-lg dark:border-b dark:border-base-content/30': isSticky }">

  
  <div class="container flex justify-between max-w-[65ch] mx-auto px-4 md:px-0">
  
    <section class="flex items-center gap-4">
      <div class="avatar cursor-pointer hover:avatar-online" @click="flip = !flip" title="Flip it!">
        <div class="h-10 rounded-full">
          <img src="/favicon.ico" alt="Bruno Blog" />
        </div>
      </div>

      
      <div>
        
        <a href="http://localhost:1313/" class="text-lg font-semibold cursor-pointer">
          Bruno Blog
        </a>
        
        
      </div>
      
    </section>

    
    

    <div class="dropdown dropdown-end sm:hidden">
      <div tabindex="0" role="button" class="btn btn-ghost btn-square" aria-label="Select an option">
        <ion-icon name="menu" class="text-2xl"></ion-icon>
      </div>
      <ul tabindex="0" class="dropdown-content menu w-36 bg-base-100 rounded-box z-1 shadow-md">
        







<li>
  <div role="link" tabindex="0" class="inline-flex items-center p-2 cursor-pointer" @click="flip = !flip" title="About">
    <ion-icon name="information-circle"></ion-icon>About</div>
</li>







<li>
  <a class="group inline-flex items-center p-2 cursor-pointer" href="/search" title="Search">
    <ion-icon name="search"></ion-icon>
    Search
  </a>
</li>











<li>
  <a class="inline-flex items-center p-2 cursor-pointer" href="/posts" title="Archives">
    <ion-icon name="archive"></ion-icon>
    Archives
  </a>
</li>











<li>
  <a class="inline-flex items-center p-2 cursor-pointer" href="/tags" title="All Tags">
    <ion-icon name="pricetags"></ion-icon>
    All Tags
  </a>
</li>






      </ul>
    </div>
    <section class="hidden sm:flex sm:items-center sm:gap-2 md:gap-4">
      

      
      




<div role="link" tabindex="0" class="text-sm font-semibold cursor-pointer hover:underline" @click="flip = !flip" title="About">About</div>





      
      
<a class="group inline-flex items-center p-2 rounded-full cursor-pointer hover:bg-primary" href="/search" title="Search">
  <ion-icon class="group-hover:text-primary-content" name="search"></ion-icon>
</a>


      
      





      
      
<a class="group inline-flex items-center p-2 rounded-full cursor-pointer hover:bg-primary" href="/posts" title="Archives">
  <ion-icon class="group-hover:text-primary-content" name="archive"></ion-icon>
</a>


      
      





      
      
<a class="group inline-flex items-center p-2 rounded-full cursor-pointer hover:bg-primary" href="/tags" title="All Tags">
  <ion-icon class="group-hover:text-primary-content" name="pricetags"></ion-icon>
</a>


      

      

      
    </section>
  </div>
</nav>


    <div class="flip-container" :class="{ 'flip-it': flip }">
      <div class="flipper">
        <div class="front">
          <div class="container">
            
<div class="lg:grid lg:grid-cols-4 gap-4 mt-4 px-4">
  <div class="hidden lg:block">
    
  </div>

  <div class="lg:col-span-2">
    <article class="mx-auto prose prose-quoteless dark:prose-invert" id="dream-single-post-main" itemscope itemtype="http://schema.org/Article">
      
  <meta itemprop="name" content="0xOPOSEC 24/02/2022 Challenge">
  <meta itemprop="description" content="Description “I just got this new keyboard from Vodaphone Portugal, but it looks like something fishy is going on. Could you help me?”
Solving Opening the pcap file It turns out to be a USB communication capture The file was small and had USB_INTERRUPT events that encode key presses
After a little bit of google fu, I found that the Leftover Capture Data field has a series of 8 bytes strung together (the third byte is the Usage ID for the key pressed)">
  <meta itemprop="datePublished" content="2022-02-24T00:00:00+00:00">
  <meta itemprop="dateModified" content="2022-02-24T00:00:00+00:00">
  <meta itemprop="wordCount" content="408">
  <meta itemprop="keywords" content="CTF">

      <header>
        <h1 itemprop="headline">0xOPOSEC 24/02/2022 Challenge</h1>
        <p class="text-sm">
          
            Thursday, Feb 24, 2022
          

          | <span>2 minute read</span>

          
          | <span>Updated at
            
              Thursday, Feb 24, 2022
            </span>
          
        </p>

        
        <div class="flex justify-between">
          

          <div class="flex items-center gap-2">
  
  

  
  
  
  
  
    <a class="group inline-flex items-center p-2 rounded-full cursor-pointer hover:bg-primary"
      href="https://x.com/intent/post?text=0xOPOSEC%2024/02/2022%20Challenge&amp;url=http://localhost:1313/posts/2022-02-24-0xoposec/" target="_blank" rel="noopener noreferrer"
      title="Share on X">
      <ion-icon class="group-hover:text-primary-content" name="logo-x"></ion-icon>
    </a>
  
    <a class="group inline-flex items-center p-2 rounded-full cursor-pointer hover:bg-primary"
      href="https://facebook.com/sharer/sharer.php?u=http://localhost:1313/posts/2022-02-24-0xoposec/" target="_blank" rel="noopener noreferrer"
      title="Share on Facebook">
      <ion-icon class="group-hover:text-primary-content" name="logo-facebook"></ion-icon>
    </a>
  
    <a class="group inline-flex items-center p-2 rounded-full cursor-pointer hover:bg-primary"
      href="https://wa.me/?text=0xOPOSEC%2024/02/2022%20Challenge%20http://localhost:1313/posts/2022-02-24-0xoposec/" target="_blank" rel="noopener noreferrer"
      title="Share on WhatsApp">
      <ion-icon class="group-hover:text-primary-content" name="logo-whatsapp"></ion-icon>
    </a>
  

  
  
</div>

        </div>
      </header>

      <section id="dream-single-post-content" itemprop="articleBody">
        

        <h2 id="description">Description</h2>
<p><em>&ldquo;I just got this new keyboard from Vodaphone Portugal, but it looks like something fishy is going on. Could you help me?&rdquo;</em></p>
<h2 id="solving">Solving</h2>
<ul>
<li>Opening the pcap file It turns out to be a USB communication capture</li>
</ul>
<p><img src="https://user-images.githubusercontent.com/12052283/154855128-2786e0c5-58ee-4db9-8d0f-c5d780989a0e.png" alt="image"></p>
<ul>
<li>
<p>The file was small and had USB_INTERRUPT events that encode key presses</p>
</li>
<li>
<p>After a little bit of google fu, I found that the <code>Leftover Capture Data</code> field has a series of 8 bytes strung together (the third byte is the <code>Usage ID for the key pressed</code>)</p>
</li>
<li>
<p>So one way to decode this was to look at <code>Leftover Capture Data</code> and convert the key presses to human readable output</p>
</li>
<li>
<p>Knowing this I extracted all <code>Leftover Capture Data</code> from the pcap file (<code>tshark -r dump.pcapng -T fields -e usb.capdata | grep .</code>) and created a python script to help me decode the dumped data</p>
</li>
<li>
<p>Output from the <code>tshark</code> command</p>
</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ae81ff">01000900</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">01000000</span>
</span></span><span style="display:flex;"><span>01000f00
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">01000000</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">01000400</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">01000000</span>
</span></span><span style="display:flex;"><span>01000a00
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">01000000</span>
</span></span><span style="display:flex;"><span>01202f00
</span></span><span style="display:flex;"><span>...
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">01000000</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">01203000</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">01200000</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">01002800</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">01000000</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e">#!/usr/bin/python3</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> sys
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>lower_case_key <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">1</span>:<span style="color:#66d9ef">None</span>,	<span style="color:#ae81ff">2</span>:<span style="color:#66d9ef">None</span>,	<span style="color:#ae81ff">3</span>:<span style="color:#66d9ef">None</span>,	<span style="color:#ae81ff">4</span>:<span style="color:#e6db74">&#34;a&#34;</span>,	<span style="color:#ae81ff">5</span>:<span style="color:#e6db74">&#34;b&#34;</span>,	<span style="color:#ae81ff">6</span>:<span style="color:#e6db74">&#34;c&#34;</span>, 
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">7</span>:<span style="color:#e6db74">&#34;d&#34;</span>, 	<span style="color:#ae81ff">8</span>:<span style="color:#e6db74">&#34;e&#34;</span>,	<span style="color:#ae81ff">9</span>:<span style="color:#e6db74">&#34;f&#34;</span>, 	<span style="color:#ae81ff">10</span>:<span style="color:#e6db74">&#34;g&#34;</span>,	<span style="color:#ae81ff">11</span>:<span style="color:#e6db74">&#34;h&#34;</span>,	<span style="color:#ae81ff">12</span>:<span style="color:#e6db74">&#34;i&#34;</span>, 
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">13</span>:<span style="color:#e6db74">&#34;j&#34;</span>,	<span style="color:#ae81ff">14</span>:<span style="color:#e6db74">&#34;k&#34;</span>,	<span style="color:#ae81ff">15</span>:<span style="color:#e6db74">&#34;l&#34;</span>,	<span style="color:#ae81ff">16</span>:<span style="color:#e6db74">&#34;m&#34;</span>,	<span style="color:#ae81ff">17</span>:<span style="color:#e6db74">&#34;n&#34;</span>,	<span style="color:#ae81ff">18</span>:<span style="color:#e6db74">&#34;o&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">19</span>:<span style="color:#e6db74">&#34;p&#34;</span>,	<span style="color:#ae81ff">20</span>:<span style="color:#e6db74">&#34;q&#34;</span>,	<span style="color:#ae81ff">21</span>:<span style="color:#e6db74">&#34;r&#34;</span>,	<span style="color:#ae81ff">22</span>:<span style="color:#e6db74">&#34;s&#34;</span>,	<span style="color:#ae81ff">23</span>:<span style="color:#e6db74">&#34;t&#34;</span>,	<span style="color:#ae81ff">24</span>:<span style="color:#e6db74">&#34;u&#34;</span>, 
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">25</span>:<span style="color:#e6db74">&#34;v&#34;</span>,	<span style="color:#ae81ff">26</span>:<span style="color:#e6db74">&#34;w&#34;</span>,	<span style="color:#ae81ff">27</span>:<span style="color:#e6db74">&#34;x&#34;</span>,	<span style="color:#ae81ff">28</span>:<span style="color:#e6db74">&#34;y&#34;</span>,	<span style="color:#ae81ff">29</span>:<span style="color:#e6db74">&#34;z&#34;</span>,	<span style="color:#ae81ff">30</span>:<span style="color:#e6db74">&#34;1&#34;</span>, 
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">31</span>:<span style="color:#e6db74">&#34;2&#34;</span>,	<span style="color:#ae81ff">32</span>:<span style="color:#e6db74">&#34;3&#34;</span>,	<span style="color:#ae81ff">33</span>:<span style="color:#e6db74">&#34;4&#34;</span>,	<span style="color:#ae81ff">34</span>:<span style="color:#e6db74">&#34;5&#34;</span>,	<span style="color:#ae81ff">35</span>:<span style="color:#e6db74">&#34;6&#34;</span>,	<span style="color:#ae81ff">36</span>:<span style="color:#e6db74">&#34;7&#34;</span>, 
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">37</span>:<span style="color:#e6db74">&#34;8&#34;</span>,	<span style="color:#ae81ff">38</span>:<span style="color:#e6db74">&#34;9&#34;</span>,	<span style="color:#ae81ff">39</span>:<span style="color:#e6db74">&#34;0&#34;</span>,	<span style="color:#ae81ff">40</span>:<span style="color:#e6db74">&#34;Enter&#34;</span>,	<span style="color:#ae81ff">41</span>:<span style="color:#e6db74">&#34;esc&#34;</span>,<span style="color:#ae81ff">42</span>:<span style="color:#e6db74">&#34;del&#34;</span>, 
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">43</span>:<span style="color:#e6db74">&#34;tab&#34;</span>, <span style="color:#ae81ff">44</span>:<span style="color:#e6db74">&#34;space&#34;</span>,	<span style="color:#ae81ff">45</span>:<span style="color:#e6db74">&#34;-&#34;</span>, 
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">46</span>:<span style="color:#e6db74">&#34;:&#34;</span>, <span style="color:#ae81ff">47</span>:<span style="color:#e6db74">&#34;[&#34;</span>, <span style="color:#ae81ff">48</span>:<span style="color:#e6db74">&#34;]&#34;</span>, <span style="color:#ae81ff">49</span>:<span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">&#34;</span>,<span style="color:#ae81ff">50</span>:<span style="color:#e6db74">&#34; &#34;</span>, <span style="color:#ae81ff">51</span>:<span style="color:#e6db74">&#34;,&#34;</span>, 
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">52</span>:<span style="color:#e6db74">&#34;&#39;&#34;</span>, <span style="color:#ae81ff">53</span>:<span style="color:#e6db74">&#34;`&#34;</span>, <span style="color:#ae81ff">54</span>:<span style="color:#e6db74">&#34;,&#34;</span>, <span style="color:#ae81ff">55</span>:<span style="color:#e6db74">&#34;.&#34;</span>, <span style="color:#ae81ff">56</span>:<span style="color:#e6db74">&#34;/&#34;</span>, <span style="color:#ae81ff">57</span>:<span style="color:#e6db74">&#34;CapsLock&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">79</span>:<span style="color:#e6db74">&#34;RightArrow&#34;</span>,<span style="color:#ae81ff">80</span>:<span style="color:#e6db74">&#34;LeftArrow&#34;</span>, <span style="color:#ae81ff">84</span>:<span style="color:#e6db74">&#34;/&#34;</span>, <span style="color:#ae81ff">85</span>:<span style="color:#e6db74">&#34;*&#34;</span>, <span style="color:#ae81ff">86</span>:<span style="color:#e6db74">&#34;-&#34;</span>,	
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">87</span>:<span style="color:#e6db74">&#34;+&#34;</span>, <span style="color:#ae81ff">88</span>:<span style="color:#e6db74">&#34;Enter&#34;</span>, <span style="color:#ae81ff">89</span>:<span style="color:#e6db74">&#34;1&#34;</span>, <span style="color:#ae81ff">90</span>:<span style="color:#e6db74">&#34;2&#34;</span>, <span style="color:#ae81ff">91</span>:<span style="color:#e6db74">&#34;3&#34;</span>, <span style="color:#ae81ff">92</span>:<span style="color:#e6db74">&#34;4&#34;</span>,	<span style="color:#ae81ff">93</span>:<span style="color:#e6db74">&#34;5&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">94</span>:<span style="color:#e6db74">&#34;6&#34;</span>,	<span style="color:#ae81ff">95</span>:<span style="color:#e6db74">&#34;7&#34;</span>, <span style="color:#ae81ff">96</span>:<span style="color:#e6db74">&#34;8&#34;</span>, <span style="color:#ae81ff">97</span>:<span style="color:#e6db74">&#34;9&#34;</span>, <span style="color:#ae81ff">98</span>:<span style="color:#e6db74">&#34;0&#34;</span>, <span style="color:#ae81ff">99</span>:<span style="color:#e6db74">&#34;.&#34;</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>upper_case_key <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">1</span>:<span style="color:#66d9ef">None</span>, <span style="color:#ae81ff">2</span>:<span style="color:#66d9ef">None</span>, <span style="color:#ae81ff">3</span>:<span style="color:#66d9ef">None</span>,<span style="color:#ae81ff">5</span>:<span style="color:#e6db74">&#34;B&#34;</span>, <span style="color:#ae81ff">6</span>:<span style="color:#e6db74">&#34;C&#34;</span>,<span style="color:#ae81ff">7</span>:<span style="color:#e6db74">&#34;D&#34;</span>,<span style="color:#ae81ff">8</span>:<span style="color:#e6db74">&#34;E&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">9</span>:<span style="color:#e6db74">&#34;F&#34;</span>,<span style="color:#ae81ff">10</span>:<span style="color:#e6db74">&#34;G&#34;</span>,<span style="color:#ae81ff">11</span>:<span style="color:#e6db74">&#34;H&#34;</span>,<span style="color:#ae81ff">12</span>:<span style="color:#e6db74">&#34;I&#34;</span>,<span style="color:#ae81ff">13</span>:<span style="color:#e6db74">&#34;J&#34;</span>,<span style="color:#ae81ff">14</span>:<span style="color:#e6db74">&#34;K&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">15</span>:<span style="color:#e6db74">&#34;L&#34;</span>,	<span style="color:#ae81ff">16</span>:<span style="color:#e6db74">&#34;M&#34;</span>,	<span style="color:#ae81ff">17</span>:<span style="color:#e6db74">&#34;N&#34;</span>,	<span style="color:#ae81ff">18</span>:<span style="color:#e6db74">&#34;O&#34;</span>,	<span style="color:#ae81ff">19</span>:<span style="color:#e6db74">&#34;P&#34;</span>,	<span style="color:#ae81ff">20</span>:<span style="color:#e6db74">&#34;Q&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">21</span>:<span style="color:#e6db74">&#34;R&#34;</span>,	<span style="color:#ae81ff">22</span>:<span style="color:#e6db74">&#34;S&#34;</span>,	<span style="color:#ae81ff">23</span>:<span style="color:#e6db74">&#34;T&#34;</span>,	<span style="color:#ae81ff">24</span>:<span style="color:#e6db74">&#34;U&#34;</span>,	<span style="color:#ae81ff">25</span>:<span style="color:#e6db74">&#34;V&#34;</span>,	<span style="color:#ae81ff">26</span>:<span style="color:#e6db74">&#34;W&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">27</span>:<span style="color:#e6db74">&#34;X&#34;</span>,	<span style="color:#ae81ff">28</span>:<span style="color:#e6db74">&#34;Y&#34;</span>,	<span style="color:#ae81ff">29</span>:<span style="color:#e6db74">&#34;Z&#34;</span>,	<span style="color:#ae81ff">30</span>:<span style="color:#e6db74">&#34;!&#34;</span>,	<span style="color:#ae81ff">31</span>:<span style="color:#e6db74">&#34;@&#34;</span>,	<span style="color:#ae81ff">32</span>:<span style="color:#e6db74">&#34;#&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">33</span>:<span style="color:#e6db74">&#34;$&#34;</span>,	<span style="color:#ae81ff">34</span>:<span style="color:#e6db74">&#34;%&#34;</span>,	<span style="color:#ae81ff">35</span>:<span style="color:#e6db74">&#34;^&#34;</span>,	<span style="color:#ae81ff">36</span>:<span style="color:#e6db74">&#34;&amp;&#34;</span>,	<span style="color:#ae81ff">37</span>:<span style="color:#e6db74">&#34;*&#34;</span>,	<span style="color:#ae81ff">38</span>:<span style="color:#e6db74">&#34;(&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">39</span>:<span style="color:#e6db74">&#34;)&#34;</span>,	<span style="color:#ae81ff">40</span>:<span style="color:#e6db74">&#34;Enter&#34;</span>,<span style="color:#ae81ff">41</span>:<span style="color:#e6db74">&#34;esc&#34;</span>,<span style="color:#ae81ff">42</span>:<span style="color:#e6db74">&#34;del&#34;</span>,<span style="color:#ae81ff">43</span>:<span style="color:#e6db74">&#34;tab&#34;</span>,<span style="color:#ae81ff">44</span>:<span style="color:#e6db74">&#34;space&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">45</span>:<span style="color:#e6db74">&#34;_&#34;</span>,	<span style="color:#ae81ff">46</span>:<span style="color:#e6db74">&#34;+&#34;</span>,	<span style="color:#ae81ff">47</span>:<span style="color:#e6db74">&#34;{&#34;</span>,	<span style="color:#ae81ff">48</span>:<span style="color:#e6db74">&#34;}&#34;</span>,	<span style="color:#ae81ff">49</span>:<span style="color:#e6db74">&#34;|&#34;</span>,	<span style="color:#ae81ff">50</span>:<span style="color:#e6db74">&#34; &#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">51</span>:<span style="color:#e6db74">&#34;:&#34;</span>,	<span style="color:#ae81ff">52</span>:<span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\&#34;</span><span style="color:#e6db74">&#34;</span>,<span style="color:#ae81ff">53</span>:<span style="color:#e6db74">&#34;~&#34;</span>,<span style="color:#ae81ff">54</span>:<span style="color:#e6db74">&#34;&lt;&#34;</span>,<span style="color:#ae81ff">55</span>:<span style="color:#e6db74">&#34;&gt;&#34;</span>,	<span style="color:#ae81ff">56</span>:<span style="color:#e6db74">&#34;?&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">57</span>:<span style="color:#e6db74">&#34;CapsLock&#34;</span>,<span style="color:#ae81ff">79</span>:<span style="color:#e6db74">&#34;RightArrow&#34;</span>,<span style="color:#ae81ff">80</span>:<span style="color:#e6db74">&#34;LeftArrow&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">84</span>:<span style="color:#e6db74">&#34;/&#34;</span>,	<span style="color:#ae81ff">85</span>:<span style="color:#e6db74">&#34;*&#34;</span>,	<span style="color:#ae81ff">86</span>:<span style="color:#e6db74">&#34;-&#34;</span>,	<span style="color:#ae81ff">87</span>:<span style="color:#e6db74">&#34;+&#34;</span>,	<span style="color:#ae81ff">88</span>:<span style="color:#e6db74">&#34;Enter&#34;</span>,	<span style="color:#ae81ff">89</span>:<span style="color:#e6db74">&#34;1&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">90</span>:<span style="color:#e6db74">&#34;2&#34;</span>,	<span style="color:#ae81ff">91</span>:<span style="color:#e6db74">&#34;3&#34;</span>,	<span style="color:#ae81ff">92</span>:<span style="color:#e6db74">&#34;4&#34;</span>,	<span style="color:#ae81ff">93</span>:<span style="color:#e6db74">&#34;5&#34;</span>,	<span style="color:#ae81ff">94</span>:<span style="color:#e6db74">&#34;6&#34;</span>,	<span style="color:#ae81ff">95</span>:<span style="color:#e6db74">&#34;7&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">96</span>:<span style="color:#e6db74">&#34;8&#34;</span>,	<span style="color:#ae81ff">97</span>:<span style="color:#e6db74">&#34;9&#34;</span>,	<span style="color:#ae81ff">98</span>:<span style="color:#e6db74">&#34;0&#34;</span>,<span style="color:#ae81ff">99</span>:<span style="color:#e6db74">&#34;.&#34;</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">replace</span>(res : str)<span style="color:#f92672">-&gt;</span> str:
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> res<span style="color:#f92672">.</span>replace(<span style="color:#e6db74">&#34;[&#34;</span>,<span style="color:#e6db74">&#34;{&#34;</span>)<span style="color:#f92672">.</span>replace(<span style="color:#e6db74">&#34;]&#34;</span>,<span style="color:#e6db74">&#34;}&#34;</span>)<span style="color:#f92672">.</span>replace(<span style="color:#e6db74">&#34;-&#34;</span>,<span style="color:#e6db74">&#34;_&#34;</span>)
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">main</span>() <span style="color:#f92672">-&gt;</span> str:
</span></span><span style="display:flex;"><span>    res <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> len(sys<span style="color:#f92672">.</span>argv) <span style="color:#f92672">==</span> <span style="color:#ae81ff">2</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># open file with &#34;Leftover Capture Data&#34; field from pcap</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">with</span> open(sys<span style="color:#f92672">.</span>argv[<span style="color:#ae81ff">1</span>]) <span style="color:#66d9ef">as</span> keycodes:
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span> line <span style="color:#f92672">in</span> keycodes:
</span></span><span style="display:flex;"><span>                <span style="color:#75715e"># convert string to bytearray</span>
</span></span><span style="display:flex;"><span>                bytesArray <span style="color:#f92672">=</span> bytearray<span style="color:#f92672">.</span>fromhex(line<span style="color:#f92672">.</span>strip())
</span></span><span style="display:flex;"><span>                <span style="color:#75715e"># see if a key was pressed(range goes from 4 to 99)</span>
</span></span><span style="display:flex;"><span>                key_press <span style="color:#f92672">=</span> int(bytesArray[<span style="color:#ae81ff">2</span>])
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">if</span> key_press <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">3</span> <span style="color:#f92672">and</span> key_press <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">100</span>:
</span></span><span style="display:flex;"><span>                    <span style="color:#75715e"># see if left shift or right shift was presses</span>
</span></span><span style="display:flex;"><span>                    <span style="color:#66d9ef">if</span> bytesArray[<span style="color:#ae81ff">0</span>] <span style="color:#f92672">==</span> <span style="color:#ae81ff">0x02</span> <span style="color:#f92672">or</span> bytesArray[<span style="color:#ae81ff">0</span>] <span style="color:#f92672">==</span> <span style="color:#ae81ff">0x20</span> :
</span></span><span style="display:flex;"><span>                        res <span style="color:#f92672">+=</span> upper_case_key[key_press]
</span></span><span style="display:flex;"><span>                    <span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>                        res <span style="color:#f92672">+=</span> lower_case_key[key_press]
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>        print(<span style="color:#e6db74">&#34;python3 exploit.py file&#34;</span>)
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> replace(res)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> __name__ <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;__main__&#34;</span>:
</span></span><span style="display:flex;"><span>    print(main())
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>flag<span style="color:#f92672">{</span>usb_sniff_sniff<span style="color:#f92672">}</span>
</span></span></code></pre></div><h2 id="references">References</h2>
<ul>
<li><a href="https://www.usb.org/sites/default/files/documents/hid1_11.pdf" target="_blank">https://www.usb.org/sites/default/files/documents/hid1_11.pdf</a>
</li>
<li><a href="https://source.android.com/devices/input/keyboard-devices.html" target="_blank">https://source.android.com/devices/input/keyboard-devices.html</a>
</li>
</ul>


        
      </section>

      
      <div class="divider"></div>
      <div class="flex flex-col md:flex-row justify-between gap-4 py-4">
        
        <a role="button" class="btn btn-outline h-12" href="/posts/2022-08-21-0xoposec/" title="0xOPOSEC Summer Challenge 2022">
          <ion-icon name="chevron-back"></ion-icon>
          <div class="inline-flex flex-col items-start">
            <span class="text-base-content/60 text-xs font-normal">Previous page</span>
            <span class="max-w-48 truncate">0xOPOSEC Summer Challenge 2022</span>
          </div>
        </a>
        

        
        <a role="button" class="btn btn-outline h-12" href="/posts/2021-07-29-using-ansible-to-deploy-vm-in-esxi/" title="Using Ansible To Deploy a VM In ESXi">
          <div class="inline-flex flex-col items-end">
            <span class="text-base-content/60 text-xs font-normal">Next page</span>
            <span class="max-w-48 truncate">Using Ansible To Deploy a VM In ESXi</span>
          </div>
          <ion-icon name="chevron-forward"></ion-icon>
        </a>
        
      </div>
      

      
    </article>
  </div>

  <div
    x-data="tocHighlighter()"
    @scroll.window="debouncedScroll"
    class="hidden lg:flex lg:flex-col lg:items-end">
    
      <nav id="TableOfContents">
  <ul>
    <li><a href="#description">Description</a></li>
    <li><a href="#solving">Solving</a></li>
    <li><a href="#references">References</a></li>
  </ul>
</nav>
    
  </div>
</div>


            
<footer class="flex justify-between items-center gap-2 max-w-[65ch] mx-auto px-4 md:px-0 py-12">

  <div>
  
  <p>
    © 2018 - 2025 Bruno Blog
  </p>
  

  
  <p class="text-sm">
    🌱
    <span class="text-base-content/60">
      Powered by <a class="hover:underline" href="https://gohugo.io/" target="_blank">Hugo</a> with theme
      <a class="hover:underline" href="https://github.com/g1eny0ung/hugo-theme-dream" target="_blank">Dream</a>.</span
    >
  </p>
  
</div>

  <div
  x-data="{ icons: [
    { name: 'sunny', status: 'n' },
    { name: 'moon', status: 'y' },
    { name: 'desktop', status: 'auto' }
  ] }"
  class="flex items-center gap-2 h-[32px] px-2 bg-base-100 border border-base-content/30 rounded-full"
>
  <template x-for="icon in icons">
    <div
      role="button"
      tabindex="0"
      :aria-label="'Select ' + icon.name + ' mode'"
      class="group inline-flex justify-center items-center p-1 rounded-full cursor-pointer hover:bg-primary"
      :class="$store.darkMode.icon() === icon.name && 'bg-primary'"
      @click="$store.darkMode.toggle(icon.status)"
    >
      <ion-icon
        :name="`${icon.name}-outline`"
        class="group-hover:text-primary-content"
        :class="$store.darkMode.icon() === icon.name && 'text-primary-content'"
      >
      </ion-icon>
    </div>
  </template>
</div>

</footer>

          </div>
        </div>
        <div class="back">
          <div class="container">
            
            <div class="max-w-[65ch] mt-8 mx-auto px-4">
  
  
  
  <div>
    <div class="mb-4 text-lg font-medium"></div>

    <div class="prose dark:prose-invert">
      <h1 id="about-me">About me</h1>
<p><em>My name is Bruno Teixeira and I am an Offensive Cyber Security Analyst. Focused on learning Information Security and Systems Administration. Always doing some side projects to improve my coding skills and learn new technologies on the way.</em></p>
<h2 id="work-experience">Work Experience</h2>
<ul>
<li>Pentester @ <a href="https://www.pt.logicalis.com/pt-pt" target="_blank">Logicalis PT</a>
 (Current)</li>
<li>Pentester @ <a href="https://www.layer8.pt" target="_blank">Layer8</a>
</li>
<li>Offensive Cyber Security Analyst @ <a href="https://artresilia.com/" target="_blank">ArtResilia</a>
</li>
<li>Technical Support / Service Desk @ <a href="https://www.cgi.com/en" target="_blank">CGI</a>
</li>
<li>Military @ <a href="https://www.exercito.pt/pt" target="_blank">Exército Português</a>
</li>
</ul>
<h2 id="education">Education</h2>
<ul>
<li>BsC Computer Engineering @ <a href="https://www.isec.pt" target="_blank">ISEC Coimbra</a>
</li>
<li>CET Network and Systems @ <a href="https://www.cinel.pt" target="_blank">CINEL Porto</a>
</li>
<li>IT &amp; Programming @ <a href="https://eisnt.com/" target="_blank">EISnt, High School</a>
</li>
</ul>
<h2 id="work-experience-as-a-trainee">Work Experience as a Trainee</h2>
<ul>
<li>IT and Network department @ <a href="https://www.islagaia.pt/pt/" target="_blank">ISLA Gaia</a>
</li>
<li>Hardware &amp; Software Maintenance @ <a href="http://assistencia35.com/" target="_blank">Assistência 35 LDA</a>
</li>
<li>Hardware Maintenance @ <a href="https://www.lojasehorarios.com.pt/dotcenter-informatica-soc-unip-lda/porto/c-58637a1332cff589d8187aa3" target="_blank">DOTcenter</a>
</li>
</ul>

    </div>
  </div>
  <div class="divider divider-vertical"></div>
  
  

  
  
  <div class="pb-4">
  
    <div class="mb-4 text-lg font-medium">Social Links</div>

    <ul class="menu menu-horizontal flex-wrap w-full px-0 [&_ion-icon]:text-lg">
  
  <li>
    <a href="mailto:brunoalexandre3@hotmail.com" title="Email">
      <ion-icon name="mail"></ion-icon>
    </a>
  </li>
  

  
  <li>
    <a href="https://github.com/BrunoTeixeira1996" target="_blank" title="GitHub">
      <ion-icon name="logo-github"></ion-icon>
    </a>
  </li>
  
  <li>
    <a href="https://x.com/zebisnaga3" target="_blank" title="X">
      <ion-icon name="logo-x"></ion-icon>
    </a>
  </li>
  
  <li>
    <a href="https://www.linkedin.com/in/bruno-teixeira-1553b4a1/" target="_blank" title="Linkedin">
      <ion-icon name="logo-linkedin"></ion-icon>
    </a>
  </li>
  
</ul>

  </div>
  

  
</div>

            

            
<footer class="flex justify-between items-center gap-2 max-w-[65ch] mx-auto px-4 md:px-0 py-12">

  <div>
  
  <p>
    © 2018 - 2025 Bruno Blog
  </p>
  

  
  <p class="text-sm">
    🌱
    <span class="text-base-content/60">
      Powered by <a class="hover:underline" href="https://gohugo.io/" target="_blank">Hugo</a> with theme
      <a class="hover:underline" href="https://github.com/g1eny0ung/hugo-theme-dream" target="_blank">Dream</a>.</span
    >
  </p>
  
</div>

  <div
  x-data="{ icons: [
    { name: 'sunny', status: 'n' },
    { name: 'moon', status: 'y' },
    { name: 'desktop', status: 'auto' }
  ] }"
  class="flex items-center gap-2 h-[32px] px-2 bg-base-100 border border-base-content/30 rounded-full"
>
  <template x-for="icon in icons">
    <div
      role="button"
      tabindex="0"
      :aria-label="'Select ' + icon.name + ' mode'"
      class="group inline-flex justify-center items-center p-1 rounded-full cursor-pointer hover:bg-primary"
      :class="$store.darkMode.icon() === icon.name && 'bg-primary'"
      @click="$store.darkMode.toggle(icon.status)"
    >
      <ion-icon
        :name="`${icon.name}-outline`"
        class="group-hover:text-primary-content"
        :class="$store.darkMode.icon() === icon.name && 'text-primary-content'"
      >
      </ion-icon>
    </div>
  </template>
</div>

</footer>

          </div>
        </div>
      </div>
    </div>

    <script>
  window.lightTheme = "emerald"
  window.darkTheme = "forest"
</script>





<script src="/js/main.js"></script>

    







<script src="/js/toc.js"></script>


  
    <script type="module">
      import mediumZoom from 'https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/+esm';
      mediumZoom('#dream-single-post-content img', {
        background: 'oklch(var(--b1))',
        margin: 24,
      })
    </script>
  






    

    

    

    

    <script type="module" src="https://cdn.jsdelivr.net/npm/ionicons@7.4.0/dist/ionicons/ionicons.esm.js" integrity="sha256-/IFmi82bIhdYWctu0UddSlJqpnzWm7Vh2C4CM32wF/k=" crossorigin="anonymous"></script>
    <script nomodule src="https://cdn.jsdelivr.net/npm/ionicons@7.4.0/dist/ionicons/ionicons.js" integrity="sha256-mr7eJMX3VC3F7G32mk4oWp1C6a2tlMYxUdptfT7uKI8=" crossorigin="anonymous"></script>
  </body>
</html>
