<!DOCTYPE html>
<html lang="en"
  x-data
  :class="$store.darkMode.class()"
  :data-theme="$store.darkMode.theme()">
  <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hash Cracking in The Cloud | Bruno Blog</title>

    
  
    <link href="/favicon.ico" rel="icon" type="image/x-icon" />
  


<link rel="canonical" href="http://localhost:1313/posts/2025-06-12-hash-cracking-in-the-cloud/" />



<meta name="author" content="" />
<meta name="description" content="Introduction Cracking passwords at scale requires serious GPU power — and serious money. I quickly realized that building a dedicated machine with multiple GPUs wasn&rsquo;t just expensive upfront (thanks to hardware and GPU prices), but also a constant drain due to electricity costs. Worst of all, the rig would sit idle most of the time, wasting its potential. So I started looking for a smarter, more flexible setup. That led me to Hashtopolis , a powerful tool for distributed hash cracking; Vast.ai , a platform offering affordable on-demand GPU instances; and Cloudflare Tunnel , which lets me expose my Hashtopolis server securely to the internet — no public IP or port forwarding needed.
" />


<meta name="keywords" content="Red Teaming">



<meta name="generator" content="Hugo 0.147.0">


<meta property="og:url" content="http://localhost:1313/posts/2025-06-12-hash-cracking-in-the-cloud/">
  <meta property="og:site_name" content="Bruno Blog">
  <meta property="og:title" content="Hash Cracking in The Cloud">
  <meta property="og:description" content="Introduction Cracking passwords at scale requires serious GPU power — and serious money. I quickly realized that building a dedicated machine with multiple GPUs wasn’t just expensive upfront (thanks to hardware and GPU prices), but also a constant drain due to electricity costs. Worst of all, the rig would sit idle most of the time, wasting its potential. So I started looking for a smarter, more flexible setup. That led me to Hashtopolis , a powerful tool for distributed hash cracking; Vast.ai , a platform offering affordable on-demand GPU instances; and Cloudflare Tunnel , which lets me expose my Hashtopolis server securely to the internet — no public IP or port forwarding needed.">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2025-06-12T00:00:00+00:00">
    <meta property="article:modified_time" content="2025-06-12T00:00:00+00:00">
    <meta property="article:tag" content="Red Teaming">




  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Hash Cracking in The Cloud">
  <meta name="twitter:description" content="Introduction Cracking passwords at scale requires serious GPU power — and serious money. I quickly realized that building a dedicated machine with multiple GPUs wasn’t just expensive upfront (thanks to hardware and GPU prices), but also a constant drain due to electricity costs. Worst of all, the rig would sit idle most of the time, wasting its potential. So I started looking for a smarter, more flexible setup. That led me to Hashtopolis , a powerful tool for distributed hash cracking; Vast.ai , a platform offering affordable on-demand GPU instances; and Cloudflare Tunnel , which lets me expose my Hashtopolis server securely to the internet — no public IP or port forwarding needed.">




<link rel="stylesheet" href="/css/output.css" />




    


<style>
  pre {
    padding: 1em;
    overflow: auto;
  }
</style>









    

    <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3/dist/cdn.min.js" integrity="sha256-PtHu0lJIiSHfZeNj1nFd6wTX+Squ255SGZ/fc8seCtM=" crossorigin="anonymous"></script>
  </head>

  <body x-data="{
    flip: false,
  }">
    
    <div id="dream-global-bg"></div>

    
<nav x-data="{ isSticky: false }"
  x-init="window.addEventListener('scroll', () => { isSticky = window.scrollY > 30 })"
  class="sticky top-0 z-30 mt-4 lg:mt-8 py-4"
  :class="{ 'bg-base-100 shadow-lg dark:border-b dark:border-base-content/30': isSticky }">

  
  <div class="container flex justify-between max-w-[65ch] mx-auto px-4 md:px-0">
  
    <section class="flex items-center gap-4">
      <div class="avatar cursor-pointer hover:avatar-online" @click="flip = !flip" title="Flip it!">
        <div class="h-10 rounded-full">
          <img src="/favicon.ico" alt="Bruno Blog" />
        </div>
      </div>

      
      <div>
        
        <a href="http://localhost:1313/" class="text-lg font-semibold cursor-pointer">
          Bruno Blog
        </a>
        
        
      </div>
      
    </section>

    
    

    <div class="dropdown dropdown-end sm:hidden">
      <div tabindex="0" role="button" class="btn btn-ghost btn-square" aria-label="Select an option">
        <ion-icon name="menu" class="text-2xl"></ion-icon>
      </div>
      <ul tabindex="0" class="dropdown-content menu w-36 bg-base-100 rounded-box z-1 shadow-md">
        







<li>
  <div role="link" tabindex="0" class="inline-flex items-center p-2 cursor-pointer" @click="flip = !flip" title="About">
    <ion-icon name="information-circle"></ion-icon>About</div>
</li>







<li>
  <a class="group inline-flex items-center p-2 cursor-pointer" href="/search" title="Search">
    <ion-icon name="search"></ion-icon>
    Search
  </a>
</li>











<li>
  <a class="inline-flex items-center p-2 cursor-pointer" href="/posts" title="Archives">
    <ion-icon name="archive"></ion-icon>
    Archives
  </a>
</li>











<li>
  <a class="inline-flex items-center p-2 cursor-pointer" href="/tags" title="All Tags">
    <ion-icon name="pricetags"></ion-icon>
    All Tags
  </a>
</li>






      </ul>
    </div>
    <section class="hidden sm:flex sm:items-center sm:gap-2 md:gap-4">
      

      
      




<div role="link" tabindex="0" class="text-sm font-semibold cursor-pointer hover:underline" @click="flip = !flip" title="About">About</div>





      
      
<a class="group inline-flex items-center p-2 rounded-full cursor-pointer hover:bg-primary" href="/search" title="Search">
  <ion-icon class="group-hover:text-primary-content" name="search"></ion-icon>
</a>


      
      





      
      
<a class="group inline-flex items-center p-2 rounded-full cursor-pointer hover:bg-primary" href="/posts" title="Archives">
  <ion-icon class="group-hover:text-primary-content" name="archive"></ion-icon>
</a>


      
      





      
      
<a class="group inline-flex items-center p-2 rounded-full cursor-pointer hover:bg-primary" href="/tags" title="All Tags">
  <ion-icon class="group-hover:text-primary-content" name="pricetags"></ion-icon>
</a>


      

      

      
    </section>
  </div>
</nav>


    <div class="flip-container" :class="{ 'flip-it': flip }">
      <div class="flipper">
        <div class="front">
          <div class="container">
            
<div class="lg:grid lg:grid-cols-4 gap-4 mt-4 px-4">
  <div class="hidden lg:block">
    
  </div>

  <div class="lg:col-span-2">
    <article class="mx-auto prose prose-quoteless dark:prose-invert" id="dream-single-post-main" itemscope itemtype="http://schema.org/Article">
      
  <meta itemprop="name" content="Hash Cracking in The Cloud">
  <meta itemprop="description" content="Introduction Cracking passwords at scale requires serious GPU power — and serious money. I quickly realized that building a dedicated machine with multiple GPUs wasn’t just expensive upfront (thanks to hardware and GPU prices), but also a constant drain due to electricity costs. Worst of all, the rig would sit idle most of the time, wasting its potential. So I started looking for a smarter, more flexible setup. That led me to Hashtopolis , a powerful tool for distributed hash cracking; Vast.ai , a platform offering affordable on-demand GPU instances; and Cloudflare Tunnel , which lets me expose my Hashtopolis server securely to the internet — no public IP or port forwarding needed.">
  <meta itemprop="datePublished" content="2025-06-12T00:00:00+00:00">
  <meta itemprop="dateModified" content="2025-06-12T00:00:00+00:00">
  <meta itemprop="wordCount" content="2049">
  <meta itemprop="keywords" content="Red Teaming">

      <header>
        <h1 itemprop="headline">Hash Cracking in The Cloud</h1>
        <p class="text-sm">
          
            Thursday, Jun 12, 2025
          

          | <span>10 minute read</span>

          
          | <span>Updated at
            
              Thursday, Jun 12, 2025
            </span>
          
        </p>

        
        <div class="flex justify-between">
          

          <div class="flex items-center gap-2">
  
  

  
  
  
  
  
    <a class="group inline-flex items-center p-2 rounded-full cursor-pointer hover:bg-primary"
      href="https://x.com/intent/post?text=Hash%20Cracking%20in%20The%20Cloud&amp;url=http://localhost:1313/posts/2025-06-12-hash-cracking-in-the-cloud/" target="_blank" rel="noopener noreferrer"
      title="Share on X">
      <ion-icon class="group-hover:text-primary-content" name="logo-x"></ion-icon>
    </a>
  
    <a class="group inline-flex items-center p-2 rounded-full cursor-pointer hover:bg-primary"
      href="https://facebook.com/sharer/sharer.php?u=http://localhost:1313/posts/2025-06-12-hash-cracking-in-the-cloud/" target="_blank" rel="noopener noreferrer"
      title="Share on Facebook">
      <ion-icon class="group-hover:text-primary-content" name="logo-facebook"></ion-icon>
    </a>
  
    <a class="group inline-flex items-center p-2 rounded-full cursor-pointer hover:bg-primary"
      href="https://wa.me/?text=Hash%20Cracking%20in%20The%20Cloud%20http://localhost:1313/posts/2025-06-12-hash-cracking-in-the-cloud/" target="_blank" rel="noopener noreferrer"
      title="Share on WhatsApp">
      <ion-icon class="group-hover:text-primary-content" name="logo-whatsapp"></ion-icon>
    </a>
  

  
  
</div>

        </div>
      </header>

      <section id="dream-single-post-content" itemprop="articleBody">
        

        <h2 id="introduction">Introduction</h2>
<p>Cracking passwords at scale requires serious GPU power — and serious money. I quickly realized that building a dedicated machine with multiple GPUs wasn&rsquo;t just expensive upfront (thanks to hardware and GPU prices), but also a constant drain due to electricity costs. Worst of all, the rig would sit idle most of the time, wasting its potential. So I started looking for a smarter, more flexible setup. That led me to <a href="https://github.com/hashtopolis" target="_blank">Hashtopolis</a>
, a powerful tool for distributed hash cracking; <a href="https://vast.ai/" target="_blank">Vast.ai</a>
, a platform offering affordable on-demand GPU instances; and <a href="https://developers.cloudflare.com/cloudflare-one/connections/connect-networks/" target="_blank">Cloudflare Tunnel</a>
, which lets me expose my Hashtopolis server securely to the internet — no public IP or port forwarding needed.</p>
<p>In this post, we’ll show you how I integrated all three into a scalable, budget-friendly cracking setup.</p>
<h2 id="the-initial-approach-simple-but-risky">The Initial Approach: Simple, but risky</h2>
<p>The first plan was to have the Hashtopolis server running inside a Docker container on a VPS, and then use Vast.ai to spawn GPU-powered instances that run the Hashtopolis Python agent.</p>
<p>These agents will connect back to the Hashtopolis server to receive tasks and report results. To enable this connection, we had to expose the Hashtopolis server to the internet - but that brings some security concerns.</p>
<h3 id="why-it-fell-short-security-concerns">Why It Fell Short: Security Concerns</h3>
<p><strong>Our initial setup was simple and functional:</strong> we had the Hashtopolis server running inside a Docker container on a VPS, and it was accessible via the VPS’s public IP on port 8080. On the Vast.ai side, we configured it to run Hashtopolis Python agents on demand using <a href="https://github.com/Milz0/hashtopolis-hashcat-vast" target="_blank">this prebuilt Docker image</a>
, which includes both Hashcat and the agent. This setup worked like a charm — we could spin up agents on Vast.ai and have them instantly connect to the Hashtopolis server, ready to start cracking.</p>
<p>However, there was one major downside: <strong>the Hashtopolis web interface was directly exposed to the internet</strong>. Yes, it does have a login form, is password-protected, and even supports multi-factor authentication, but that still left the door partially open. For us, that wasn’t ideal — especially when dealing with a potentially sensitive cracking infrastructure. We wanted an <strong>extra layer of protection</strong> to hide the service completely from public view unless explicitly accessed through a secure channel.</p>
<p>That’s where <strong>Cloudflare Tunnel</strong> came into play.</p>
<h2 id="the-improved-architecture-securing-the-setup">The Improved Architecture: Securing the Setup</h2>
<p><strong>Knowing the risks of exposing the Hashtopolis server directly to the internet, we started looking into more secure alternatives — and that’s where Cloudflare Tunnel came in.</strong> With Cloudflare Tunnel, we can expose our locally running Hashtopolis (inside a Docker container on the VPS) to the internet <strong>without opening any ports or exposing the server’s public IP.</strong> Instead, all traffic is routed through Cloudflare’s secure edge network.</p>
<p>To add an extra layer of protection, we configured the tunnel to require <strong>two custom HTTP headers</strong> for any incoming request. This means that even if someone discovers the tunnel URL, they won’t be able to interact with the Hashtopolis server unless they include the correct headers — effectively acting as an API key-style authentication layer before the app’s own login and MFA even come into play. This setup allows <strong>only authorized agents</strong> to connect to the server securely, giving us the privacy and control we were missing before.</p>
<h2 id="hands-on-building-the-secure-hashtopolis-cloud-setup">Hands-On: Building the Secure Hashtopolis Cloud Setup</h2>



  <blockquote class="dream-alert note">
    <p class="heading">
      <ion-icon name="information-circle-outline"></ion-icon>Note</p>
    <p>This guide does not cover detailed Hashtopolis installation steps. It assumes you already have a running and functional Hashtopolis server ready to go.</p>
  </blockquote>

<p><strong>To put our second - and more secure - plan into action, we needed to go through a few setup steps.</strong></p>
<h3 id="installing-hashtopolis-in-docker">Installing Hashtopolis in Docker</h3>
<p><strong>To install Hashtopolis inside a Docker container,</strong> simply follow the official installation guide here: <a href="https://github.com/hashtopolis/server/wiki/Installation" target="_blank">https://github.com/hashtopolis/server/wiki/Installation</a>
. Once the server is up and running, be sure to <strong>create a voucher</strong> through the Hashtopolis web interface - this voucher will later allow your agents to authenticate and register automatically via the Hashtopolis API.<br>
<strong>Also, don’t forget to keep the Docker container running locally on your VPS</strong>, as this is the instance that will be exposed through the Cloudflare Tunnel and serve as the central coordinator for all agent activity.</p>
<p>The following is a sample <code>docker-compose.yml</code> file to run the Hashtopolis server locally:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yml" data-lang="yml"><span style="display:flex;"><span><span style="color:#f92672">version</span>: <span style="color:#e6db74">&#39;3.7&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">services</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">hashtopolis-backend</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">container_name</span>: <span style="color:#ae81ff">hashtopolis-backend</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">image</span>: <span style="color:#ae81ff">hashtopolis/backend:latest</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">restart</span>: <span style="color:#ae81ff">always</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">volumes</span>:
</span></span><span style="display:flex;"><span>      - <span style="color:#ae81ff">hashtopolis:/usr/local/share/hashtopolis:Z</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">environment</span>:
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">HASHTOPOLIS_DB_USER</span>: <span style="color:#ae81ff">$MYSQL_USER</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">HASHTOPOLIS_DB_PASS</span>: <span style="color:#ae81ff">$MYSQL_PASSWORD</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">HASHTOPOLIS_DB_HOST</span>: <span style="color:#ae81ff">$HASHTOPOLIS_DB_HOST</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">HASHTOPOLIS_DB_DATABASE</span>: <span style="color:#ae81ff">$MYSQL_DATABASE</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">HASHTOPOLIS_ADMIN_USER</span>: <span style="color:#ae81ff">$HASHTOPOLIS_ADMIN_USER</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">HASHTOPOLIS_ADMIN_PASSWORD</span>: <span style="color:#ae81ff">$HASHTOPOLIS_ADMIN_PASSWORD</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">HASHTOPOLIS_APIV2_ENABLE</span>: <span style="color:#ae81ff">$HASHTOPOLIS_APIV2_ENABLE</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">depends_on</span>:
</span></span><span style="display:flex;"><span>      - <span style="color:#ae81ff">db</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">ports</span>:
</span></span><span style="display:flex;"><span>      - <span style="color:#e6db74">&#34;127.0.0.1:8080:80&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">db</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">container_name</span>: <span style="color:#ae81ff">db</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">image</span>: <span style="color:#ae81ff">mysql:8.0</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">restart</span>: <span style="color:#ae81ff">always</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">volumes</span>:
</span></span><span style="display:flex;"><span>      - <span style="color:#ae81ff">db:/var/lib/mysql</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">environment</span>:
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">MYSQL_ROOT_PASSWORD</span>: <span style="color:#ae81ff">$MYSQL_ROOT_PASS</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">MYSQL_DATABASE</span>: <span style="color:#ae81ff">$MYSQL_DATABASE</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">MYSQL_USER</span>: <span style="color:#ae81ff">$MYSQL_USER</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">MYSQL_PASSWORD</span>: <span style="color:#ae81ff">$MYSQL_PASSWORD</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">hashtopolis-frontend</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">container_name</span>: <span style="color:#ae81ff">hashtopolis-frontend</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">image</span>: <span style="color:#ae81ff">hashtopolis/frontend:latest</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">environment</span>:
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">HASHTOPOLIS_BACKEND_URL</span>: <span style="color:#ae81ff">$HASHTOPOLIS_BACKEND_URL</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">restart</span>: <span style="color:#ae81ff">always</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">depends_on</span>:
</span></span><span style="display:flex;"><span>      - <span style="color:#ae81ff">hashtopolis-backend</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">ports</span>:
</span></span><span style="display:flex;"><span>      - <span style="color:#e6db74">&#34;127.0.0.1:4200:80&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">volumes</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">db</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">hashtopolis</span>:
</span></span></code></pre></div><h3 id="configuring-a-secure-cloudflare-tunnel">Configuring a Secure Cloudflare Tunnel</h3>
<p>First, we need to purchase a domain and add it to our Cloudflare account. This is essential because Cloudflare Tunnel works by associating your tunnel with a domain or subdomain, which will serve as the public endpoint for accessing your Hashtopolis server securely.</p>
<p>Simply press the &ldquo;Add domain&rdquo; button in the Cloudflare Account Home menu and follow the setup wizard to configure your new domain.</p>
<figure class="post-image"><img src="/hash_cracking/1.png">
</figure>

<p>Second, we need to configure the Application. To do this, first activate the <strong>free Zero Trust plan</strong> from the Cloudflare dashboard. Then, navigate to <strong>Access &gt; Applications</strong>, and add a new <strong>Self-Hosted Application</strong>.</p>
<p>Next, type a name for your application, enter your domain, and choose a subdomain — this can be anything you like. The full address (subdomain + domain) will be the URL used to access your Hashtopolis server through the tunnel.</p>
<figure class="post-image"><img src="/hash_cracking/2.png">
</figure>

<p>Next, we set up a service token to use in our access policies. To do this, go to <strong>Access &gt; Service Auth</strong> in the Cloudflare dashboard. Generate the token and make sure to securely save the two important HTTP headers: <code>CF-Access-Client-Id</code> and <code>CF-Access-Client-Secret</code>. These headers will be required to authenticate any requests sent through the tunnel, ensuring only authorized agents can communicate with the Hashtopolis server.</p>
<p>After that, move to the Policies tab and create a new policy. Give your policy a descriptive name, and set the <strong>Action</strong> to <strong>Service Auth</strong>. Then, under <strong>Rules</strong>, add an <strong>Include</strong> rule with the selector set to <strong>Any Access Service Token</strong>. Finally, save the policy. This setup ensures that only requests with valid service tokens can access your Hashtopolis server through the tunnel.</p>
<figure class="post-image"><img src="/hash_cracking/3.png">
</figure>

<p>With our application set up and the policy applied, it’s time to create the tunnel. To do this, navigate to <strong>Networks &gt; Tunnel</strong> in the Cloudflare dashboard.</p>
<p>Give your tunnel a name and follow the installation options provided. In our case, we selected the <strong>Debian environment</strong>, since we installed the <code>cloudflared</code> binary directly on the VPS where the Hashtopolis Docker container is running.</p>
<p>Next, go to the Public Hostnames tab and add your subdomain plus domain name. Choose the <strong>HTTP</strong> service type and set it to forward to <strong>localhost on port 8080</strong>, which is where your Hashtopolis Docker container is running.</p>
<figure class="post-image"><img src="/hash_cracking/4.png">
</figure>

<p>With this setup, the Cloudflare Tunnel should be up and running as intended. You can test it by navigating to your subdomain in a browser, where you should see the following:</p>
<figure class="post-image"><img src="/hash_cracking/5.png">
</figure>

<p>Seeing the &ldquo;Forbidden&rdquo; page is exactly what we want - it means our access policy is working. If you modify the request to include the special HTTP headers (<code>CF-Access-Client-Id</code> and <code>CF-Access-Client-Secret</code>), the tunnel authenticates you and lets you reach the Hashtopolis login form. This confirms that only requests with valid service tokens can access the server.</p>
<figure class="post-image"><img src="/hash_cracking/6.png">
</figure>

<h3 id="customizing-the-hashtopolis-agent-for-secure-headers">Customizing the Hashtopolis Agent for Secure Headers</h3>
<p>Now that the Cloudflare Tunnel is configured and verified working, we needed to adapt the Hashtopolis Python agent to support custom HTTP headers. This change allows the Vast.ai agents to include the required <code>CF-Access-Client-Id</code> and <code>CF-Access-Client-Secret</code> headers when communicating with our Hashtopolis server through the Cloudflare Tunnel, ensuring secure and authenticated connections.</p>
<p>To meet this requirement, I forked the <a href="https://github.com/hashtopolis/agent-python" target="_blank">original Hashtopolis Python agent</a>
 and modified it to support custom HTTP headers. I didn’t want to hardcode the Cloudflare-specific headers (<code>CF-Access-Client-Id</code> and <code>CF-Access-Client-Secret</code>), since other users might use different names or services. Instead, I implemented a <strong>command-line argument</strong> that allows users to define multiple custom HTTP headers. These headers are then automatically included in <strong>all outgoing requests</strong> from the agent, ensuring compatibility with secured endpoints like the one behind our Cloudflare Tunnel.</p>
<p>As a result, a <a href="https://github.com/BrunoTeixeira1996/agent-python" target="_blank">new version of the Hashtopolis Python agent was created</a>
</p>
<h3 id="publishing-a-custom-docker-image">Publishing a Custom Docker Image</h3>
<p>In Vast.ai, we can create instances based on Docker containers. In the initial setup, I used <a href="https://github.com/Milz0/hashtopolis-hashcat-vast" target="_blank">this image</a>
, which includes the original Hashtopolis Python agent. However, since I needed support for custom HTTP headers, I decided not to use that version anymore. Instead, I created a <strong>new Docker image</strong> that uses my modified agent. You can find it here on Docker Hub: <a href="https://hub.docker.com/repository/docker/brunoteixeira1996/hashtopolis-hashcat-vast/general" target="_blank">https://hub.docker.com/repository/docker/brunoteixeira1996/hashtopolis-hashcat-vast/general</a>
. This image is ready to run on Vast.ai and fully supports secure communication with the Hashtopolis server via Cloudflare Tunnel.</p>
<h3 id="deploying-scalable-agents-on-vastai">Deploying Scalable Agents on Vast.ai</h3>
<p>To create a Vast.ai instance using our modified Hashtopolis agent, go to the <strong>Templates</strong> section and click <strong>New</strong>. Choose a name for your template, and in the <strong>Image Path</strong>, enter <code>brunoteixeira1996/hashtopolis-hashcat-vast:latest</code>. Set the <strong>Version Tag</strong> to <code>latest</code>.</p>
<p>For the <strong>Launch Mode</strong>, select <strong>Interactive shell server, SSH</strong>, which gives you control over the container once it starts.</p>
<p>Then, in the <strong>On-start script</strong>, enter the following to launch the agent with the required HTTP headers and connect it to your Hashtopolis server securely:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-console" data-lang="console"><span style="display:flex;"><span>cd htpclient
</span></span><span style="display:flex;"><span>python3 hashtopolis.zip --url  https://&lt;YOUR DOMAIN&gt;/api/server.php --voucher &lt;YOUR VOUCHER&gt; --http-headers &#39;CF-Access-Client-Id: REDACTED, CF-Access-Client-Secret: REDACTED&#39;
</span></span></code></pre></div><h3 id="starting-the-crack">Starting the crack</h3>
<p>Now that everything is set up, it’s time to start the cracking process.</p>



  <blockquote class="dream-alert note">
    <p class="heading">
      <ion-icon name="information-circle-outline"></ion-icon>Note</p>
    <p>This blog post won’t cover how to upload wordlists or use Hashtopolis in depth, as it assumes you’re already familiar with those basics.</p>
  </blockquote>

<p>First, access your Hashtopolis server (you can SSH tunnel your VPS to access it locally via <code>localhost</code>). Then, navigate to <strong>Lists &gt; New Hashlist</strong>. Here, enter a name for your hashlist, select the appropriate hash type, and upload your hashes.</p>
<figure class="post-image"><img src="/hash_cracking/7.png">
</figure>

<p>Next, head over to <strong>Tasks &gt; New Task</strong>. Enter a name for your task, select the hashlist you just created, and choose a dictionary (wordlist) of your choice to use for cracking.</p>
<figure class="post-image"><img src="/hash_cracking/8.png">
</figure>

<p>Now, navigate to <strong>Vast.ai &gt; Instances</strong> and select from your available options. For this example, we’ll choose three RTX 4090 instances to maximize cracking power.</p>
<figure class="post-image"><img src="/hash_cracking/9.png">
</figure>

<p>The startup and initialization process may take a few minutes—expect to wait at least 5 minutes. After that, check the <strong>Instances</strong> menu to confirm that all three instances are marked as ready to use.</p>
<figure class="post-image"><img src="/hash_cracking/10.png">
</figure>

<p>Next, go to your Hashtopolis dashboard and navigate to <strong>Agents &gt; Show Agents</strong>. You should see all three agents listed and waiting to be assigned a task.</p>
<figure class="post-image"><img src="/hash_cracking/11.png">
</figure>

<p>Select all agents, enable <strong>Trust agent with secret data</strong>, and assign them to the task you created earlier.</p>
<p>After a few minutes, you should see that the task has successfully completed and all the hashes have been cracked.</p>
<figure class="post-image"><img src="/hash_cracking/12.png">
</figure>

<p>Once the task is complete, you no longer need the Vast.ai instances. Simply go to the Vast.ai console and manually delete the instances to avoid unnecessary charges.</p>
<figure class="post-image"><img src="/hash_cracking/13.png">
</figure>

<p><strong>Also don&rsquo;t forget to remove the agents in the Hashtopolis server.</strong></p>
<h2 id="conclusion">Conclusion</h2>
<p>In this post, we walked through the evolution of a cost-effective and secure distributed cracking setup using Hashtopolis, Vast.ai, and Cloudflare Tunnel.</p>
<p>Starting from a simple but insecure public-facing deployment, we improved the architecture by introducing service token-based authentication and custom HTTP headers to lock down access. By adapting the Hashtopolis Python agent and containerizing it for Vast.ai, we achieved a scalable system where agents can be spun up on demand — all while keeping the Hashtopolis server protected behind a Cloudflare Zero Trust tunnel.</p>
<p>This approach not only reduces cost by avoiding idle GPU hardware but also improves flexibility and security, making it a solid foundation for similar distributed cracking or compute-heavy workloads.</p>
<p>That said, this entire process is currently manual: to start a new cracking job, you need to log into Vast.ai, rent a few instances, then create and assign tasks in Hashtopolis before kicking off the attack. However, this setup can be fully automated. For example, you could build a bot - like a Telegram bot - that receives a hash file, creates the corresponding task in Hashtopolis, provisions Vast.ai instances with predefined parameters, and launches the attack. This is just one example of the powerful automation opportunities enabled by this architecture.</p>


        
      </section>

      
      <div class="divider"></div>
      <div class="flex flex-col md:flex-row justify-between gap-4 py-4">
        
        <div></div>
        

        
        <a role="button" class="btn btn-outline h-12" href="/posts/2024-10-29-automating-my-ups/" title="Automating My UPS">
          <div class="inline-flex flex-col items-end">
            <span class="text-base-content/60 text-xs font-normal">Next page</span>
            <span class="max-w-48 truncate">Automating My UPS</span>
          </div>
          <ion-icon name="chevron-forward"></ion-icon>
        </a>
        
      </div>
      

      
    </article>
  </div>

  <div
    x-data="tocHighlighter()"
    @scroll.window="debouncedScroll"
    class="hidden lg:flex lg:flex-col lg:items-end">
    
      <nav id="TableOfContents">
  <ul>
    <li><a href="#introduction">Introduction</a></li>
    <li><a href="#the-initial-approach-simple-but-risky">The Initial Approach: Simple, but risky</a>
      <ul>
        <li><a href="#why-it-fell-short-security-concerns">Why It Fell Short: Security Concerns</a></li>
      </ul>
    </li>
    <li><a href="#the-improved-architecture-securing-the-setup">The Improved Architecture: Securing the Setup</a></li>
    <li><a href="#hands-on-building-the-secure-hashtopolis-cloud-setup">Hands-On: Building the Secure Hashtopolis Cloud Setup</a>
      <ul>
        <li><a href="#installing-hashtopolis-in-docker">Installing Hashtopolis in Docker</a></li>
        <li><a href="#configuring-a-secure-cloudflare-tunnel">Configuring a Secure Cloudflare Tunnel</a></li>
        <li><a href="#customizing-the-hashtopolis-agent-for-secure-headers">Customizing the Hashtopolis Agent for Secure Headers</a></li>
        <li><a href="#publishing-a-custom-docker-image">Publishing a Custom Docker Image</a></li>
        <li><a href="#deploying-scalable-agents-on-vastai">Deploying Scalable Agents on Vast.ai</a></li>
        <li><a href="#starting-the-crack">Starting the crack</a></li>
      </ul>
    </li>
    <li><a href="#conclusion">Conclusion</a></li>
  </ul>
</nav>
    
  </div>
</div>


            
<footer class="flex justify-between items-center gap-2 max-w-[65ch] mx-auto px-4 md:px-0 py-12">

  <div>
  
  <p>
    © 2018 - 2025 Bruno Blog
  </p>
  

  
  <p class="text-sm">
    🌱
    <span class="text-base-content/60">
      Powered by <a class="hover:underline" href="https://gohugo.io/" target="_blank">Hugo</a> with theme
      <a class="hover:underline" href="https://github.com/g1eny0ung/hugo-theme-dream" target="_blank">Dream</a>.</span
    >
  </p>
  
</div>

  <div
  x-data="{ icons: [
    { name: 'sunny', status: 'n' },
    { name: 'moon', status: 'y' },
    { name: 'desktop', status: 'auto' }
  ] }"
  class="flex items-center gap-2 h-[32px] px-2 bg-base-100 border border-base-content/30 rounded-full"
>
  <template x-for="icon in icons">
    <div
      role="button"
      tabindex="0"
      :aria-label="'Select ' + icon.name + ' mode'"
      class="group inline-flex justify-center items-center p-1 rounded-full cursor-pointer hover:bg-primary"
      :class="$store.darkMode.icon() === icon.name && 'bg-primary'"
      @click="$store.darkMode.toggle(icon.status)"
    >
      <ion-icon
        :name="`${icon.name}-outline`"
        class="group-hover:text-primary-content"
        :class="$store.darkMode.icon() === icon.name && 'text-primary-content'"
      >
      </ion-icon>
    </div>
  </template>
</div>

</footer>

          </div>
        </div>
        <div class="back">
          <div class="container">
            
            <div class="max-w-[65ch] mt-8 mx-auto px-4">
  
  
  
  <div>
    <div class="mb-4 text-lg font-medium"></div>

    <div class="prose dark:prose-invert">
      <h1 id="about-me">About me</h1>
<p><em>My name is Bruno Teixeira and I am an Offensive Cyber Security Analyst. Focused on learning Information Security and Systems Administration. Always doing some side projects to improve my coding skills and learn new technologies on the way.</em></p>
<h2 id="work-experience">Work Experience</h2>
<ul>
<li>Pentester @ <a href="https://www.pt.logicalis.com/pt-pt" target="_blank">Logicalis PT</a>
 (Current)</li>
<li>Pentester @ <a href="https://www.layer8.pt" target="_blank">Layer8</a>
</li>
<li>Offensive Cyber Security Analyst @ <a href="https://artresilia.com/" target="_blank">ArtResilia</a>
</li>
<li>Technical Support / Service Desk @ <a href="https://www.cgi.com/en" target="_blank">CGI</a>
</li>
<li>Military @ <a href="https://www.exercito.pt/pt" target="_blank">Exército Português</a>
</li>
</ul>
<h2 id="education">Education</h2>
<ul>
<li>BsC Computer Engineering @ <a href="https://www.isec.pt" target="_blank">ISEC Coimbra</a>
</li>
<li>CET Network and Systems @ <a href="https://www.cinel.pt" target="_blank">CINEL Porto</a>
</li>
<li>IT &amp; Programming @ <a href="https://eisnt.com/" target="_blank">EISnt, High School</a>
</li>
</ul>
<h2 id="work-experience-as-a-trainee">Work Experience as a Trainee</h2>
<ul>
<li>IT and Network department @ <a href="https://www.islagaia.pt/pt/" target="_blank">ISLA Gaia</a>
</li>
<li>Hardware &amp; Software Maintenance @ <a href="http://assistencia35.com/" target="_blank">Assistência 35 LDA</a>
</li>
<li>Hardware Maintenance @ <a href="https://www.lojasehorarios.com.pt/dotcenter-informatica-soc-unip-lda/porto/c-58637a1332cff589d8187aa3" target="_blank">DOTcenter</a>
</li>
</ul>

    </div>
  </div>
  <div class="divider divider-vertical"></div>
  
  

  
  
  <div class="pb-4">
  
    <div class="mb-4 text-lg font-medium">Social Links</div>

    <ul class="menu menu-horizontal flex-wrap w-full px-0 [&_ion-icon]:text-lg">
  
  <li>
    <a href="mailto:brunoalexandre3@hotmail.com" title="Email">
      <ion-icon name="mail"></ion-icon>
    </a>
  </li>
  

  
  <li>
    <a href="https://github.com/BrunoTeixeira1996" target="_blank" title="GitHub">
      <ion-icon name="logo-github"></ion-icon>
    </a>
  </li>
  
  <li>
    <a href="https://x.com/zebisnaga3" target="_blank" title="X">
      <ion-icon name="logo-x"></ion-icon>
    </a>
  </li>
  
  <li>
    <a href="https://www.linkedin.com/in/bruno-teixeira-1553b4a1/" target="_blank" title="Linkedin">
      <ion-icon name="logo-linkedin"></ion-icon>
    </a>
  </li>
  
</ul>

  </div>
  

  
</div>

            

            
<footer class="flex justify-between items-center gap-2 max-w-[65ch] mx-auto px-4 md:px-0 py-12">

  <div>
  
  <p>
    © 2018 - 2025 Bruno Blog
  </p>
  

  
  <p class="text-sm">
    🌱
    <span class="text-base-content/60">
      Powered by <a class="hover:underline" href="https://gohugo.io/" target="_blank">Hugo</a> with theme
      <a class="hover:underline" href="https://github.com/g1eny0ung/hugo-theme-dream" target="_blank">Dream</a>.</span
    >
  </p>
  
</div>

  <div
  x-data="{ icons: [
    { name: 'sunny', status: 'n' },
    { name: 'moon', status: 'y' },
    { name: 'desktop', status: 'auto' }
  ] }"
  class="flex items-center gap-2 h-[32px] px-2 bg-base-100 border border-base-content/30 rounded-full"
>
  <template x-for="icon in icons">
    <div
      role="button"
      tabindex="0"
      :aria-label="'Select ' + icon.name + ' mode'"
      class="group inline-flex justify-center items-center p-1 rounded-full cursor-pointer hover:bg-primary"
      :class="$store.darkMode.icon() === icon.name && 'bg-primary'"
      @click="$store.darkMode.toggle(icon.status)"
    >
      <ion-icon
        :name="`${icon.name}-outline`"
        class="group-hover:text-primary-content"
        :class="$store.darkMode.icon() === icon.name && 'text-primary-content'"
      >
      </ion-icon>
    </div>
  </template>
</div>

</footer>

          </div>
        </div>
      </div>
    </div>

    <script>
  window.lightTheme = "emerald"
  window.darkTheme = "forest"
</script>





<script src="/js/main.js"></script>

    







<script src="/js/toc.js"></script>


  
    <script type="module">
      import mediumZoom from 'https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/+esm';
      mediumZoom('#dream-single-post-content img', {
        background: 'oklch(var(--b1))',
        margin: 24,
      })
    </script>
  






    

    

    

    

    <script type="module" src="https://cdn.jsdelivr.net/npm/ionicons@7.4.0/dist/ionicons/ionicons.esm.js" integrity="sha256-/IFmi82bIhdYWctu0UddSlJqpnzWm7Vh2C4CM32wF/k=" crossorigin="anonymous"></script>
    <script nomodule src="https://cdn.jsdelivr.net/npm/ionicons@7.4.0/dist/ionicons/ionicons.js" integrity="sha256-mr7eJMX3VC3F7G32mk4oWp1C6a2tlMYxUdptfT7uKI8=" crossorigin="anonymous"></script>
  </body>
</html>
